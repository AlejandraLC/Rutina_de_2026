<!DOCTYPE html>
<html lang="es" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rutina 2026 | Alejandra</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Tu asistente personal para rutinas fÃ­sicas, mentales y espirituales">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Rutina 2026">
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/svg+xml" href="./icon-192.svg">
    <link rel="apple-touch-icon" href="./icon-192.svg">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            hover: '#334155'
                        },
                        level: {
                            physical: '#22c55e', // Green
                            mental: '#3b82f6',   // Blue
                            spiritual: '#a855f7' // Purple
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        /* Glassmorphism utilities */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-card {
            background: linear-gradient(145deg, #1e293b, #111827);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
</head>

<body class="min-h-screen text-slate-200 pb-20 override-scroll">

    <!-- Top Bar: Date & Currency -->
    <header class="fixed top-0 w-full z-50 glass border-b border-slate-800/50">
        <div class="max-w-md mx-auto px-4 h-16 flex items-center justify-between">
            <!-- Date Picker -->
            <div class="relative group cursor-pointer" id="date-display-container">
                <div class="flex flex-col">
                    <span class="text-xs text-slate-400 font-medium uppercase tracking-wider"
                        id="current-year">2026</span>
                    <div class="flex items-center gap-2">
                        <h1 class="text-lg font-bold text-slate-100" id="current-date-text">Cargando...</h1>
                        <i data-lucide="chevron-down"
                            class="w-4 h-4 text-slate-500 group-hover:text-slate-300 transition-colors"></i>
                    </div>
                </div>
                <!-- Native Date Picker (Hidden but triggers) -->
                <input type="date" id="native-date-picker"
                    class="absolute inset-0 opacity-0 cursor-pointer w-full h-full">
            </div>

            <!-- Currency Counters -->
            <div class="flex items-center gap-2">
                <!-- XP -->
                <div
                    class="flex items-center gap-1.5 bg-slate-800/50 px-3 py-1.5 rounded-full border border-slate-700/50">
                    <i data-lucide="zap" class="w-4 h-4 text-yellow-500 fill-yellow-500"></i>
                    <span class="text-sm font-bold text-yellow-400" id="xp-counter">0</span>
                    <span class="text-xs text-slate-500 font-medium">XP</span>
                </div>
                <!-- Coins -->
                <div
                    class="flex items-center gap-1.5 bg-slate-800/50 px-3 py-1.5 rounded-full border border-slate-700/50">
                    <i data-lucide="coins" class="w-4 h-4 text-amber-500 fill-amber-500"></i>
                    <span class="text-sm font-bold text-amber-400" id="savings-counter">â‚¡0</span>
                </div>
                <!-- Backup Button -->
                <button onclick="Store.exportData()" title="Exportar backup"
                    class="p-2 bg-slate-800/50 rounded-full border border-slate-700/50 hover:bg-slate-700/50 transition-colors">
                    <i data-lucide="download" class="w-4 h-4 text-blue-400"></i>
                </button>
                <!-- Restore Button -->
                <button onclick="Store.importData()" title="Importar backup"
                    class="p-2 bg-slate-800/50 rounded-full border border-slate-700/50 hover:bg-slate-700/50 transition-colors">
                    <i data-lucide="upload" class="w-4 h-4 text-green-400"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Container -->
    <main id="app-container" class="max-w-6xl mx-auto pt-20 px-4 space-y-6">
        <!-- Dynamic Content Injected Here -->
    </main>

    <!-- Bottom Navigation (Optional/Contextual) or Floating Action Button?
         User asked for "Dashboard" as center control. Let's keep it simple.
         We might add a permanent "Home" button if we navigate deep. -->
    <nav class="fixed bottom-6 right-6 z-40 flex flex-col gap-3">
        <button onclick="App.renderView('dashboard')"
            class="bg-indigo-600 hover:bg-indigo-500 text-white p-4 rounded-full shadow-lg shadow-indigo-500/30 transition-all hover:scale-105 active:scale-95 flex items-center justify-center">
            <i data-lucide="layout-dashboard" class="w-6 h-6"></i>
        </button>
    </nav>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- UTILS ---
        const Utils = {
            generateId: () => Math.random().toString(36).substr(2, 9),
            formatDateFriends: (dateStr) => {
                const date = new Date(dateStr + 'T00:00:00'); // Fix Timezone issues
                const options = { weekday: 'long', day: 'numeric', month: 'long' };
                return date.toLocaleDateString('es-ES', options).replace(/^\w/, c => c.toUpperCase());
            },
            getTodayISO: () => {
                const now = new Date();
                const offset = now.getTimezoneOffset();
                const local = new Date(now.getTime() - (offset * 60 * 1000));
                return local.toISOString().split('T')[0];
            }
        };

        // --- STATE MANAGEMENT ---
        const Store = {
            data: {
                user: { xp: 0, coins: 0 },
                settings: { lastReset: null },
                levels: [
                    { id: 'l_phy', name: 'FÃ­sico', color: 'green', icon: 'dumbbell', goals: [] },
                    { id: 'l_men', name: 'Mental', color: 'blue', icon: 'brain', goals: [] },
                    { id: 'l_spi', name: 'Espiritual', color: 'purple', icon: 'sparkles', goals: [] }
                ],
                modules: {
                    savings: { balance: 0, logs: [] },
                    shop: {
                        items: [
                            { id: 1, name: 'CafÃ©', cost: 1500, xpRequired: 100, tier: 'bronze', icon: 'coffee' },
                            { id: 2, name: 'Almuerzo Especial', cost: 5000, xpRequired: 500, tier: 'silver', icon: 'star' },
                            { id: 3, name: 'DÃ­a Libre', cost: 10000, xpRequired: 1000, tier: 'gold', icon: 'crown' },
                        ]
                    },
                    journal: {} // 'YYYY-MM-DD': "text"
                },
                activityLog: {} // 'YYYY-MM-DD': { goalId_activityId: true }
            },

            init() {
                const saved = localStorage.getItem('rutina2026_db');
                if (saved) {
                    this.data = JSON.parse(saved);

                    // Migration: Add xpRequired to shop items if missing
                    if (this.data.modules?.shop?.items) {
                        this.data.modules.shop.items = this.data.modules.shop.items.map(item => {
                            if (!item.xpRequired) {
                                // Set default XP based on cost
                                if (item.cost <= 2000) item.xpRequired = 100;
                                else if (item.cost <= 6000) item.xpRequired = 500;
                                else item.xpRequired = 1000;
                            }
                            return item;
                        });
                        this.save();
                    }
                } else {
                    this.save();
                }
            },

            save() {
                localStorage.setItem('rutina2026_db', JSON.stringify(this.data));
                App.updateHeader();
            },

            exportData() {
                // Create JSON file with all data
                const dataStr = JSON.stringify(this.data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });

                // Create download link
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `rutina_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                alert('âœ… Backup descargado exitosamente!');
            },

            importData() {
                // Create file input
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/json';

                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const importedData = JSON.parse(event.target.result);

                            // Validate data structure
                            if (!importedData.levels || !importedData.user) {
                                alert('âŒ Archivo invÃ¡lido. No contiene la estructura correcta.');
                                return;
                            }

                            // Confirm before overwriting
                            if (confirm('âš ï¸ Esto reemplazarÃ¡ TODOS tus datos actuales. Â¿Continuar?')) {
                                this.data = importedData;
                                this.save();
                                alert('âœ… Datos importados exitosamente!');
                                location.reload();
                            }
                        } catch (error) {
                            alert('âŒ Error al leer el archivo: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                };

                input.click();
            },

            // --- LEVEL MANAGEMENT ---
            createLevel(name, color, icon) {
                const newLevel = {
                    id: 'l_' + Utils.generateId(),
                    name: name,
                    color: color,
                    icon: icon,
                    goals: []
                };
                this.data.levels.push(newLevel);
                this.save();
                return newLevel.id;
            },

            updateLevel(levelId, name, color, icon) {
                const level = this.data.levels.find(l => l.id === levelId);
                if (level) {
                    level.name = name;
                    level.color = color;
                    level.icon = icon;
                    this.save();
                }
            },

            deleteLevel(levelId) {
                this.data.levels = this.data.levels.filter(l => l.id !== levelId);
                this.save();
            },

            // --- HELPERS ---
            reset() {
                if (confirm('Â¿EstÃ¡s segura de querer borrar TODO el progreso?')) {
                    localStorage.removeItem('rutina2026_db');
                    location.reload();
                }
            },

            getDayCompletionPercentage(date) {
                // Calculate what % of activities were completed on a given date
                let totalActivities = 0;
                let completedActivities = 0;

                const dateObj = new Date(date + 'T00:00:00');
                const dayOfWeek = dateObj.getDay();

                this.data.levels.forEach(level => {
                    level.goals.forEach(goal => {
                        const phaseKey = this.getPhaseKey(date, goal.phaseType || 'monthly');
                        const phase = goal.phases?.[phaseKey];
                        if (!phase) return;

                        let dailyActs = [];
                        if (phase.routine && phase.routine[dayOfWeek]) {
                            dailyActs = phase.routine[dayOfWeek];
                        } else if (phase.activities) {
                            dailyActs = phase.activities;
                        }

                        dailyActs.forEach((act, idx) => {
                            totalActivities++;
                            const key = `${goal.id}_${idx}`;
                            if (this.data.activityLog[date]?.[key]) {
                                completedActivities++;
                            }
                        });
                    });
                });

                return totalActivities === 0 ? 0 : (completedActivities / totalActivities) * 100;
            },

            checkStreakBonuses(date) {
                // Check for perfect week (7 consecutive days at 100%)
                // Check for perfect month (all days in month at 100%)
                const dateObj = new Date(date + 'T00:00:00');

                // Perfect Week Check (last 7 days including today)
                let perfectWeek = true;
                for (let i = 0; i < 7; i++) {
                    const checkDate = new Date(dateObj);
                    checkDate.setDate(checkDate.getDate() - i);
                    const checkDateStr = checkDate.toISOString().split('T')[0];
                    const completion = this.getDayCompletionPercentage(checkDateStr);
                    if (completion < 100) {
                        perfectWeek = false;
                        break;
                    }
                }

                // Award perfect week bonus (only once per week)
                const weekKey = `week_${date}`;
                if (perfectWeek && !this.data.activityLog[date]?.[weekKey]) {
                    this.addXP(500);
                    this.updateSavings(2000);
                    if (!this.data.activityLog[date]) this.data.activityLog[date] = {};
                    this.data.activityLog[date][weekKey] = true;
                    this.showCelebration('Â¡SEMANA PERFECTA! ðŸŽ‰', '+500 XP y â‚¡2,000');
                }

                // Perfect Month Check
                const year = dateObj.getFullYear();
                const month = dateObj.getMonth();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                let perfectMonth = true;
                for (let day = 1; day <= daysInMonth; day++) {
                    const checkDate = new Date(year, month, day);
                    const checkDateStr = checkDate.toISOString().split('T')[0];
                    const completion = this.getDayCompletionPercentage(checkDateStr);
                    if (completion < 100) {
                        perfectMonth = false;
                        break;
                    }
                }

                // Award perfect month bonus (only once per month)
                const monthKey = `month_${year}-${String(month + 1).padStart(2, '0')}`;
                if (perfectMonth && !this.data.activityLog[date]?.[monthKey]) {
                    this.addXP(2000);
                    this.updateSavings(5000);
                    if (!this.data.activityLog[date]) this.data.activityLog[date] = {};
                    this.data.activityLog[date][monthKey] = true;
                    this.showCelebration('Â¡MES PERFECTO! ðŸŽ†', '+2000 XP y â‚¡5,000');
                }
            },

            showCelebration(title, subtitle) {
                // Create celebration overlay
                const overlay = document.createElement('div');
                overlay.className = 'fixed inset-0 bg-black/80 flex items-center justify-center z-50 animate-fade-in';
                overlay.innerHTML = `
                    <div class="text-center animate-bounce">
                        <h1 class="text-6xl font-bold text-yellow-400 mb-4">${title}</h1>
                        <p class="text-3xl text-cyan-400">${subtitle}</p>
                    </div>
                `;
                document.body.appendChild(overlay);

                // Auto-remove after 3 seconds
                setTimeout(() => {
                    overlay.remove();
                }, 3000);
            },

            // --- ACTIONS ---
            addXP(amount) {
                this.data.user.xp += amount;
                // Coins decoupled as requested
                this.save();
            },

            toggleActivity(date, goalId, activityId) {
                if (!this.data.activityLog[date]) this.data.activityLog[date] = {};

                const key = `${goalId}_${activityId}`;
                const output = !this.data.activityLog[date][key];

                this.data.activityLog[date][key] = output;

                // Rewards
                if (output) {
                    this.addXP(10);
                } else {
                    this.addXP(-10); // Penalty for unchecking
                }

                // Check Level Daily Bonus (User asked: "Logro de todas las actividades diarias de una meta = 15 XP")
                // This logic requires checking ALL activities for that goal.
                // We'll calculate this dynamically or on-check.
                // For simplicity/performance: check "isGoalComplete" now
                this.checkGoalBonus(date, goalId);

                // Check for streak bonuses (perfect week/month)
                this.checkStreakBonuses(date);

                this.save();

                // Manually update UI without re-rendering to avoid scroll jump
                const checkbox = document.querySelector(`input[type="checkbox"][onclick*="'${goalId}', '${activityId}'"]`);
                if (checkbox) {
                    checkbox.checked = output;
                    // The span is a sibling within the same li element
                    const parentLi = checkbox.closest('li');
                    if (parentLi) {
                        const label = parentLi.querySelector('span');
                        if (label) {
                            if (output) {
                                label.classList.add('text-slate-500', 'line-through');
                                label.classList.remove('text-slate-300');
                            } else {
                                label.classList.remove('text-slate-500', 'line-through');
                                label.classList.add('text-slate-300');
                            }
                        }
                    }
                }

                // Update XP/Coins display
                const xpDisplay = document.getElementById('xp-display');
                const coinsDisplay = document.getElementById('coins-display');
                if (xpDisplay) xpDisplay.textContent = this.data.xp;
                if (coinsDisplay) coinsDisplay.textContent = this.data.coins;

                // Update progress indicator for the current date
                this.updateProgressIndicator();
            },

            updateProgressIndicator() {
                // Save current scroll position
                const scrollY = window.scrollY;

                // Re-render dashboard to update progress indicators
                App.renderView('dashboard');

                // Restore scroll position after a brief delay
                setTimeout(() => {
                    window.scrollTo(0, scrollY);
                }, 10);
            },

            getLevelIdByGoalId(goalId) {
                for (const l of this.data.levels) {
                    if (l.goals.find(g => g.id === goalId)) return l.id;
                }
                return null;
            },

            getGoalById(id) {
                for (const l of this.data.levels) {
                    const g = l.goals.find(g => g.id === id);
                    if (g) return g;
                }
                return null;
            },

            updatePhaseActivity(goalId, phaseKey, actIdx, value) {
                const goal = this.getGoalById(goalId);
                if (goal && goal.phases[phaseKey]) {
                    goal.phases[phaseKey].activities[actIdx].name = value;
                    this.save();
                }
            },

            removePhaseActivity(goalId, phaseKey, actIdx) {
                const goal = this.getGoalById(goalId);
                if (goal && goal.phases[phaseKey]) {
                    goal.phases[phaseKey].activities.splice(actIdx, 1);
                    this.save();
                }
            },

            updateRoutineActivity(goalId, phaseKey, dayIdx, actIdx, value) {
                const goal = this.getGoalById(goalId);
                // Ensure structure
                if (goal.phases[phaseKey] && !goal.phases[phaseKey].routine) {
                    goal.phases[phaseKey].routine = { 0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [] };
                }
                const routine = goal.phases[phaseKey].routine;
                if (routine[dayIdx] && routine[dayIdx][actIdx]) {
                    routine[dayIdx][actIdx].name = value;
                    this.save();
                }
            },

            updateDayObjective(goalId, phaseKey, dayIdx, objective) {
                const goal = this.getGoalById(goalId);
                if (!goal || !goal.phases[phaseKey]) return;

                if (!goal.phases[phaseKey].dayObjectives) {
                    goal.phases[phaseKey].dayObjectives = {};
                }

                goal.phases[phaseKey].dayObjectives[dayIdx] = objective;
                this.save();
            },

            addRoutineActivity(goalId, phaseKey, dayIdx) {
                const goal = this.getGoalById(goalId);
                if (goal.phases[phaseKey] && !goal.phases[phaseKey].routine) {
                    goal.phases[phaseKey].routine = { 0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [] };
                }
                goal.phases[phaseKey].routine[dayIdx].push({ name: '', completed: false });
                this.save();
            },

            removeRoutineActivity(goalId, phaseKey, dayIdx, actIdx) {
                const goal = this.getGoalById(goalId);
                if (goal.phases[phaseKey] && goal.phases[phaseKey].routine) {
                    goal.phases[phaseKey].routine[dayIdx].splice(actIdx, 1);
                    this.save();
                }
            },

            copyWeeklyRoutine(goalId, phaseKey, sourceDayIdx) {
                const goal = this.getGoalById(goalId);
                const routine = goal.phases[phaseKey]?.routine;
                if (!routine) return;

                const source = routine[sourceDayIdx]; // Array of acts
                // Copy to all other days
                for (let i = 0; i <= 6; i++) {
                    if (i == sourceDayIdx) continue;
                    // Deep copy items
                    routine[i] = source.map(a => ({ ...a }));
                }
                this.save();
            },

            getPhaseKey(dateStr, type = 'monthly') {
                const date = new Date(dateStr + 'T00:00:00');
                const m = date.getMonth(); // 0-11
                const y = date.getFullYear();

                if (type === 'semiannual') {
                    return `${y}-S${m < 6 ? 1 : 2}`;
                } else if (type === 'quarterly') {
                    return `${y}-Q${Math.floor(m / 3) + 1}`;
                } else if (type === 'bimonthly') {
                    return `${y}-B${Math.floor(m / 2) + 1}`;
                } else {
                    // Monthly default
                    return `${y}-${String(m + 1).padStart(2, '0')}`;
                }
            },

            checkGoalBonus(date, goalId) {
                // Award 15 XP bonus if ALL activities for this goal on this date are completed
                const goal = this.getGoalById(goalId);
                if (!goal) return;

                // Get the phase and day's activities
                const phaseKey = this.getPhaseKey(date, goal.phaseType || 'monthly');
                const phase = goal.phases?.[phaseKey];
                if (!phase) return;

                // Determine day of week
                const dateObj = new Date(date + 'T00:00:00');
                const dayOfWeek = dateObj.getDay();

                // Get activities for this day
                let dailyActivities = [];
                if (phase.routine && phase.routine[dayOfWeek]) {
                    dailyActivities = phase.routine[dayOfWeek];
                } else if (phase.activities) {
                    dailyActivities = phase.activities; // Legacy fallback
                }

                if (dailyActivities.length === 0) return; // No activities to check

                // Check if ALL activities are completed
                const allCompleted = dailyActivities.every((act, idx) => {
                    const key = `${goalId}_${idx}`;
                    return this.data.activityLog[date]?.[key] === true;
                });

                // Award bonus if all complete and not already awarded today
                const bonusKey = `${goalId}_bonus`;
                const bonusAlreadyAwarded = this.data.activityLog[date]?.[bonusKey];

                if (allCompleted && !bonusAlreadyAwarded) {
                    this.addXP(15);
                    this.data.activityLog[date][bonusKey] = true;
                    // console.log(`ðŸŽ‰ Bonus! +15 XP por completar todas las actividades de ${goal.name}`); // Removed for production
                } else if (!allCompleted && bonusAlreadyAwarded) {
                    // Remove bonus if user unchecks an activity
                    this.addXP(-15);
                    delete this.data.activityLog[date][bonusKey];
                }
            },

            updateSavings(amount) {
                this.data.modules.savings.balance += Number(amount);
                this.data.modules.savings.logs.push({ date: new Date().toISOString(), amount: Number(amount) });
                this.save();
                App.renderView('savings'); // Re-render
            },

            saveJournal(date, text) {
                this.data.modules.journal[date] = text;
                this.save();
            }
        };

        // --- APP CONTROLLER ---
        const App = {
            state: {
                view: 'dashboard',
                currentDate: Utils.getTodayISO(),
                activeLevelId: null,
                activeGoalId: null
            },

            init() {
                // Disable browser's automatic scroll restoration
                if ('scrollRestoration' in history) {
                    history.scrollRestoration = 'manual';
                }

                // Force scroll to top
                window.scrollTo(0, 0);

                Store.init();
                this.setupHeaderActions();
                this.renderView('dashboard');
                lucide.createIcons();
            },

            setupHeaderActions() {
                const datePicker = document.getElementById('native-date-picker');
                const dateText = document.getElementById('current-date-text');

                // Initial set
                datePicker.value = this.state.currentDate;
                this.updateDateDisplay();

                // On Change
                datePicker.addEventListener('change', (e) => {
                    this.state.currentDate = e.target.value;
                    this.updateDateDisplay();
                    this.renderView('dashboard'); // Refresh dashboard for new date
                });
            },

            updateDateDisplay() {
                const dateText = document.getElementById('current-date-text');
                dateText.textContent = Utils.formatDateFriends(this.state.currentDate);
                this.updateHeader();
            },

            updateHeader() {
                document.getElementById('xp-counter').textContent = Store.data.user.xp;
                const balance = Store.data.modules.savings.balance;
                document.getElementById('savings-counter').textContent = 'â‚¡' + balance.toLocaleString('es-CR');
            },

            renderView(viewName, params = {}) {
                const container = document.getElementById('app-container');
                container.innerHTML = ''; // Clear current
                this.state.view = viewName;

                switch (viewName) {
                    case 'dashboard':
                        container.appendChild(this.Views.Dashboard());
                        break;
                    case 'level_details': // Show goals for a level
                        container.appendChild(this.Views.LevelDetails(params.levelId));
                        break;
                    case 'savings':
                        container.appendChild(this.Views.Savings());
                        break;
                    case 'shop':
                        container.appendChild(this.Views.Shop());
                        break;
                    case 'journal':
                        container.appendChild(this.Views.Journal());
                        break;
                    case 'goal_editor':
                        container.appendChild(this.Views.GoalEditor(params.goalId));
                        break;
                    case 'phase_editor':
                        container.appendChild(this.Views.PhaseEditor(params.goalId, params.monthKey, params.monthName));
                        break;
                    case 'level_creator':
                        container.appendChild(this.Views.LevelCreator());
                        break;
                    case 'level_editor':
                        container.appendChild(this.Views.LevelEditor(params.levelId));
                        break;
                    // Add other views...
                    default:
                        container.innerHTML = '<p class="text-center text-slate-500">Vista no encontrada</p>';
                }

                lucide.createIcons();

                // Scroll to top after content is fully rendered
                setTimeout(() => window.scrollTo(0, 0), 10);
            },

            // --- VIEW COMPONENTS ---
            Views: {
                Dashboard() {
                    const div = document.createElement('div');
                    div.className = 'space-y-8 animate-fade-in';

                    // 1. Levels Navigation
                    const levelsGrid = document.createElement('div');
                    levelsGrid.className = 'grid gap-3';
                    levelsGrid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(120px, 1fr))';

                    Store.data.levels.forEach(level => {
                        const btn = document.createElement('button');
                        // Dynamic Color mapping for Tailwind classes (simplified for inline styles or specific mappings)
                        const colorMap = {
                            'green': 'bg-green-500/10 border-green-500/20 text-green-400 hover:bg-green-500/20',
                            'blue': 'bg-blue-500/10 border-blue-500/20 text-blue-400 hover:bg-blue-500/20',
                            'purple': 'bg-purple-500/10 border-purple-500/20 text-purple-400 hover:bg-purple-500/20',
                            'red': 'bg-red-500/10 border-red-500/20 text-red-400 hover:bg-red-500/20',
                            'yellow': 'bg-yellow-500/10 border-yellow-500/20 text-yellow-400 hover:bg-yellow-500/20',
                            'cyan': 'bg-cyan-500/10 border-cyan-500/20 text-cyan-400 hover:bg-cyan-500/20',
                            'pink': 'bg-pink-500/10 border-pink-500/20 text-pink-400 hover:bg-pink-500/20',
                            'orange': 'bg-orange-500/10 border-orange-500/20 text-orange-400 hover:bg-orange-500/20'
                        };
                        btn.className = `relative p-4 rounded-xl border transition-all ${colorMap[level.color] || colorMap['green']}`;
                        btn.innerHTML = `
                            <div class="flex items-center justify-between mb-2">
                                <i data-lucide="${level.icon}" class="w-6 h-6"></i>
                                <button onclick="event.stopPropagation(); App.renderView('level_editor', { levelId: '${level.id}' })" class="p-1 hover:bg-slate-700/50 rounded transition-colors" title="Editar nivel">
                                    <i data-lucide="settings" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <div class="text-sm font-bold">${level.name}</div>
                            <div class="text-xs opacity-70 mt-1">${level.goals.length} meta${level.goals.length !== 1 ? 's' : ''}</div>
                        `;
                        btn.onclick = () => App.renderView('level_details', { levelId: level.id });
                        levelsGrid.appendChild(btn);
                    });
                    div.appendChild(levelsGrid);

                    // Add New Level Button
                    const addLevelBtn = document.createElement('button');
                    addLevelBtn.className = 'w-full py-3 rounded-xl border-2 border-dashed border-slate-600 text-slate-400 flex items-center justify-center gap-2 hover:bg-slate-800/50 hover:border-slate-500 transition-all mt-3';
                    addLevelBtn.innerHTML = `<i data-lucide="plus-circle" class="w-4 h-4"></i> Nuevo Nivel`;
                    addLevelBtn.onclick = () => App.renderView('level_creator');
                    div.appendChild(addLevelBtn);

                    // 2. Special Modules Grid
                    const modulesDiv = document.createElement('div');
                    modulesDiv.className = 'grid grid-cols-3 gap-3';

                    // Button Helper
                    const createModuleBtn = (label, icon, view, color) => {
                        const btn = document.createElement('button');
                        btn.className = `flex flex-col items-center justify-center p-3 rounded-xl bg-slate-800/50 border border-slate-700/50 hover:bg-slate-800 transition-colors`;
                        btn.onclick = () => App.renderView(view);
                        btn.innerHTML = `
                            <i data-lucide="${icon}" class="w-5 h-5 ${color} mb-1.5"></i>
                            <span class="text-[10px] text-slate-400 font-medium uppercase">${label}</span>
                        `;
                        return btn;
                    };

                    modulesDiv.appendChild(createModuleBtn('BÃ³veda', 'wallet', 'savings', 'text-cyan-400'));
                    modulesDiv.appendChild(createModuleBtn('Tienda', 'shopping-bag', 'shop', 'text-amber-400'));
                    modulesDiv.appendChild(createModuleBtn('Diario', 'book', 'journal', 'text-pink-400'));

                    div.appendChild(modulesDiv);

                    // 3. Rachas por Meta (Horizontal Streaks)
                    const streaksSection = document.createElement('div');
                    streaksSection.className = 'space-y-3';

                    const streaksHeader = document.createElement('div');
                    streaksHeader.className = 'flex items-center gap-2 mb-3';
                    streaksHeader.innerHTML = `
                        <i data-lucide="flame" class="w-5 h-5 text-orange-400"></i>
                        <h3 class="text-lg font-bold text-slate-200">Rachas y Constancia</h3>
                    `;
                    streaksSection.appendChild(streaksHeader);

                    // Generate streak row for each goal
                    Store.data.levels.forEach(level => {
                        level.goals.forEach(goal => {
                            const streakCard = document.createElement('div');
                            streakCard.className = 'glass-card p-3 rounded-xl';

                            // Header with goal name
                            const goalHeader = document.createElement('div');
                            goalHeader.className = 'flex items-center justify-between mb-2';

                            const colorMap = {
                                'green': 'text-green-400',
                                'blue': 'text-blue-400',
                                'purple': 'text-purple-400',
                                'red': 'text-red-400',
                                'yellow': 'text-yellow-400',
                                'cyan': 'text-cyan-400',
                                'pink': 'text-pink-400',
                                'orange': 'text-orange-400'
                            };

                            goalHeader.innerHTML = `
                                <div class="flex items-center gap-2">
                                    <i data-lucide="${level.icon}" class="w-4 h-4 ${colorMap[level.color] || 'text-slate-400'}"></i>
                                    <span class="text-sm font-medium text-slate-300">${goal.name}</span>
                                </div>
                                <span class="text-xs text-slate-500">Este mes</span>
                            `;
                            streakCard.appendChild(goalHeader);

                            // Horizontal streak grid (current month)
                            const streakGrid = document.createElement('div');
                            streakGrid.className = 'flex gap-1 overflow-x-auto pb-1';

                            const today = new Date(App.state.currentDate + 'T00:00:00');
                            const year = today.getFullYear();
                            const month = today.getMonth();
                            const daysInMonth = new Date(year, month + 1, 0).getDate();

                            for (let day = 1; day <= daysInMonth; day++) {
                                const date = new Date(year, month, day);
                                const dateStr = date.toISOString().split('T')[0];
                                const isToday = dateStr === App.state.currentDate;

                                // Calculate completion for this specific goal
                                const phaseKey = Store.getPhaseKey(dateStr, goal.phaseType || 'monthly');
                                const phase = goal.phases?.[phaseKey];

                                let completion = 0;
                                if (phase) {
                                    const dateObj = new Date(dateStr + 'T00:00:00');
                                    const dayOfWeek = dateObj.getDay();

                                    let dailyActs = [];
                                    if (phase.routine && phase.routine[dayOfWeek]) {
                                        dailyActs = phase.routine[dayOfWeek];
                                    } else if (phase.activities) {
                                        dailyActs = phase.activities;
                                    }

                                    if (dailyActs.length > 0) {
                                        let completed = 0;
                                        dailyActs.forEach((act, idx) => {
                                            const key = `${goal.id}_${idx}`;
                                            if (Store.data.activityLog[dateStr]?.[key]) {
                                                completed++;
                                            }
                                        });
                                        completion = (completed / dailyActs.length) * 100;
                                    }
                                }

                                const cell = document.createElement('div');
                                cell.className = 'w-2 h-2 rounded-sm transition-all hover:scale-125 cursor-pointer flex-shrink-0';

                                // Color based on completion
                                let bgColor = 'bg-slate-800/30'; // 0%
                                if (completion > 0 && completion < 100) {
                                    const opacity = Math.floor((completion / 100) * 50) + 20;
                                    bgColor = `bg-${level.color}-500/${opacity}`; // Partial with level color
                                } else if (completion === 100) {
                                    bgColor = `bg-${level.color}-400 shadow-lg shadow-${level.color}-500/50`; // Perfect - neon
                                }

                                if (isToday) {
                                    cell.classList.add('ring-1', 'ring-yellow-400');
                                }

                                cell.className += ` ${bgColor}`;
                                cell.title = `DÃ­a ${day}: ${completion.toFixed(0)}%`;

                                streakGrid.appendChild(cell);
                            }

                            streakCard.appendChild(streakGrid);
                            streaksSection.appendChild(streakCard);
                        });
                    });

                    div.appendChild(streaksSection);

                    // 4. Daily Checklist (Grouped by Level->Goal)
                    const checklistSection = document.createElement('section');
                    checklistSection.className = 'space-y-4';

                    const title = document.createElement('h2');
                    title.className = 'text-lg font-bold text-slate-100 flex items-center gap-2';
                    title.innerHTML = `<i data-lucide="check-square" class="w-5 h-5 text-indigo-400"></i> Actividades de Hoy`;
                    checklistSection.appendChild(title);

                    const tasksContainer = document.createElement('div');
                    tasksContainer.className = 'space-y-4';

                    let hasTasks = false;

                    Store.data.levels.forEach(level => {
                        // Find active goals/phases for this date
                        level.goals.forEach(goal => {
                            // Get phase key and phase object first
                            const phaseKey = Store.getPhaseKey(App.state.currentDate, goal.phaseType || 'monthly');
                            const phase = goal.phases?.[phaseKey];

                            // Determine Day of Week (0-6)
                            const dateObj = new Date(App.state.currentDate + 'T00:00:00');
                            const dayOfWeek = dateObj.getDay(); // 0=Sun, 1=Mon...

                            // Fetch Routine for this Day
                            let dailyActs = [];
                            if (phase?.routine && phase.routine[dayOfWeek]) {
                                dailyActs = phase.routine[dayOfWeek];
                            } else if (phase?.activities) {
                                // Fallback for legacy data
                                dailyActs = phase.activities;
                            }

                            if (dailyActs.length === 0) return; // Skip if no activities

                            hasTasks = true;

                            // Render Goal Group
                            const goalCard = document.createElement('div');
                            goalCard.className = 'glass-card rounded-xl p-4 border-l-4';
                            goalCard.style.borderLeftColor = level.color === 'green' ? '#22c55e' : level.color === 'blue' ? '#3b82f6' : '#a855f7';

                            const goalHeader = document.createElement('div');
                            goalHeader.className = 'flex justify-between items-start mb-3';
                            goalHeader.innerHTML = `<h3 class="font-bold text-slate-200">${goal.name}</h3>`;
                            goalCard.appendChild(goalHeader);

                            hasTasks = true;

                            const list = document.createElement('ul');
                            list.className = 'space-y-2';

                            dailyActs.forEach((act, idx) => {
                                const li = document.createElement('li');

                                const isChecked = Store.data.activityLog[App.state.currentDate]?.[`${goal.id}_${idx}`];

                                li.className = `flex items-center gap-3 p-2 rounded-lg transition-colors cursor-pointer ${isChecked ? 'bg-slate-700/30' : 'hover:bg-slate-800/50'}`;
                                li.onclick = (e) => {
                                    // Prevent double toggle if clicking Checkbox directly vs row
                                    if (e.target.type !== 'checkbox') {
                                        Store.toggleActivity(App.state.currentDate, goal.id, idx);
                                    }
                                };

                                li.innerHTML = `
                                    <div class="relative flex items-center justify-center w-5 h-5">
                                        <input type="checkbox"
                                            class="peer appearance-none w-5 h-5 border-2 border-slate-500 rounded checked:bg-indigo-500 checked:border-indigo-500 transition-colors cursor-pointer"
                                            ${isChecked ? 'checked' : ''}
                                            onclick="Store.toggleActivity('${App.state.currentDate}', '${goal.id}', '${idx}'); event.stopPropagation();"
                                        >
                                        <i data-lucide="check" class="w-3 h-3 text-white absolute opacity-0 peer-checked:opacity-100 pointer-events-none"></i>
                                    </div>
                                    <span class="text-sm ${isChecked ? 'text-slate-500 line-through' : 'text-slate-300'}">${act.name}</span>
                                `;
                                list.appendChild(li);
                            });

                            goalCard.appendChild(list);
                            tasksContainer.appendChild(goalCard);
                        });
                    });

                    if (!hasTasks) {
                        tasksContainer.innerHTML = `
                            <div class="text-center py-10 opacity-50">
                                <i data-lucide="calendar-off" class="w-10 h-10 mx-auto mb-2 text-slate-500"></i>
                                <p class="text-sm">No hay actividades programadas para hoy.</p>
                                <p class="text-xs mt-1">AÃ±ade metas en los niveles.</p>
                            </div>
                        `;
                    }

                    checklistSection.appendChild(tasksContainer);
                    div.appendChild(checklistSection);

                    // Reset Button (Bottom)
                    const resetBtn = document.createElement('button');
                    resetBtn.className = "w-full py-4 text-xs text-red-500/50 hover:text-red-500 mt-8";
                    resetBtn.innerText = "RESET TOTAL (Developer DB Wipe)";
                    resetBtn.onclick = () => Store.reset();
                    div.appendChild(resetBtn);

                    return div;
                },

                LevelDetails(levelId) {
                    const level = Store.data.levels.find(l => l.id === levelId);
                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in';

                    // Header
                    div.innerHTML = `
                        <div class="flex items-center gap-4 mb-6">
                            <button onclick="App.renderView('dashboard')" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                            </button>
                            <div>
                                <h2 class="text-2xl font-bold text-${level.color}-400">${level.name}</h2>
                                <p class="text-sm text-slate-500">GestiÃ³n de Metas</p>
                            </div>
                        </div>
                    `;

                    // Goals List
                    const goalsList = document.createElement('div');
                    goalsList.className = 'space-y-4';

                    if (level.goals.length === 0) {
                        goalsList.innerHTML = `<p class="text-center text-slate-500 py-4">Sin metas definidas.</p>`;
                    } else {
                        level.goals.forEach(goal => {
                            const card = document.createElement('div');
                            card.className = 'glass-card p-4 rounded-xl flex items-center justify-between group';
                            card.innerHTML = `
                                <div>
                                    <h3 class="font-bold text-slate-200">${goal.name}</h3>
                                    <p class="text-xs text-slate-500">Plazo: ${goal.deadline || 'Indefinido'}</p>
                                </div>
                                <button class="p-2 text-slate-500 hover:text-indigo-400">
                                    <i data-lucide="edit-2" class="w-4 h-4"></i>
                                </button>
                            `;
                            // Edit Click
                            card.onclick = () => App.renderView('goal_editor', { goalId: goal.id });
                            goalsList.appendChild(card);
                        });
                    }
                    div.appendChild(goalsList);

                    // Add Button
                    const addBtn = document.createElement('button');
                    addBtn.className = 'w-full py-3 rounded-xl border border-dashed border-slate-600 text-slate-400 flex items-center justify-center gap-2 hover:bg-slate-800/50 hover:border-slate-500 transition-all';
                    addBtn.innerHTML = `<i data-lucide="plus" class="w-4 h-4"></i> Nueva Meta`;
                    addBtn.onclick = () => {
                        // Use Prompt for MVP speed, build full UI later
                        const name = prompt("Nombre de la meta:");
                        if (name) {
                            level.goals.push({
                                id: Utils.generateId(),
                                name: name,
                                deadline: '2026-12-31',
                                activities: [ // Default mockup activity
                                    { name: 'Actividad de ejemplo (Editarme)', frequency: 'daily' }
                                ]
                            });
                            Store.save();
                            App.renderView('level_details', { levelId });
                        }
                    };
                    div.appendChild(addBtn);

                    return div;
                },

                GoalEditor(goalId) {
                    const goal = Store.getGoalById(goalId);
                    if (!goal) return App.renderView('dashboard');

                    // Get Level Info for Theming
                    const levelId = Store.getLevelIdByGoalId(goalId);
                    const level = Store.data.levels.find(l => l.id === levelId);

                    // Button Color Mapping
                    const btnColors = {
                        green: 'bg-green-600 hover:bg-green-500 shadow-green-600/30',
                        blue: 'bg-blue-600 hover:bg-blue-500 shadow-blue-600/30',
                        purple: 'bg-purple-600 hover:bg-purple-500 shadow-purple-600/30'
                    }[level.color] || 'bg-indigo-600 hover:bg-indigo-500 shadow-indigo-600/30';

                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in pb-20';

                    div.innerHTML = `
                        <div class="flex items-center gap-4 mb-2">
                            <button onclick="App.renderView('level_details', { levelId: '${Store.getLevelIdByGoalId(goalId)}' })" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                            </button>
                            <div>
                                <h2 class="text-xl font-bold text-slate-200">${goal.name}</h2>
                                <p class="text-xs text-slate-500">Calendario Maestro 2026</p>
                            </div>
                        </div>
                    `;

                    // Phase Configuration
                    const phaseType = goal.phaseType || 'monthly';
                    let gridItems = [];

                    if (phaseType === 'monthly') {
                        gridItems = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'].map((n, i) => ({ name: n, key: `2026-${String(i + 1).padStart(2, '0')}` }));
                    } else if (phaseType === 'bimonthly') {
                        gridItems = ['Bim 1', 'Bim 2', 'Bim 3', 'Bim 4', 'Bim 5', 'Bim 6'].map((n, i) => ({ name: n, key: `2026-B${i + 1}` }));
                    } else if (phaseType === 'quarterly') {
                        gridItems = ['Tri 1', 'Tri 2', 'Tri 3', 'Tri 4'].map((n, i) => ({ name: n, key: `2026-Q${i + 1}` }));
                    } else if (phaseType === 'semiannual') {
                        gridItems = ['Sem 1', 'Sem 2'].map((n, i) => ({ name: n, key: `2026-S${i + 1}` }));
                    }

                    const currentPhaseKey = Store.getPhaseKey(App.state.currentDate, phaseType);

                    // Calendar Grid
                    const grid = document.createElement('div');
                    grid.className = `grid gap-3 ${phaseType === 'monthly' ? 'grid-cols-3' : 'grid-cols-2'}`;

                    gridItems.forEach((item) => {
                        const phaseData = goal.phases?.[item.key];
                        const hasData = phaseData && (phaseData.objective || phaseData.activities?.length > 0 || phaseData.routine);
                        const isCurrent = item.key === currentPhaseKey;

                        const btn = document.createElement('button');
                        btn.className = `relative p-3 rounded-xl border flex flex-col items-center justify-center min-h-[80px] transition-all hover:scale-105 active:scale-95
                             ${isCurrent ? 'bg-slate-800/80 border-amber-500/50 shadow-[0_0_15px_-3px_rgba(245,158,11,0.3)]' : 'bg-slate-800/30 border-slate-700/50 hover:bg-slate-800'}`;

                        btn.onclick = () => App.renderView('phase_editor', { goalId, monthKey: item.key, monthName: item.name });

                        // Get level color for indicator
                        const levelColorClass = {
                            'green': 'bg-green-500',
                            'blue': 'bg-blue-500',
                            'purple': 'bg-purple-500',
                            'red': 'bg-red-500',
                            'yellow': 'bg-yellow-500',
                            'cyan': 'bg-cyan-500',
                            'pink': 'bg-pink-500',
                            'orange': 'bg-orange-500'
                        }[level.color] || 'bg-indigo-500';

                        btn.innerHTML = `
                            <span class="text-xs font-bold uppercase mb-1 ${isCurrent ? 'text-amber-400' : 'text-slate-400'}">${item.name}</span>
                            <div class="flex gap-1">
                                ${hasData ? `<div class="w-1.5 h-1.5 rounded-full ${levelColorClass}"></div>` : ''}
                                ${isCurrent ? '<div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div>' : ''}
                            </div>
                        `;

                        grid.appendChild(btn);
                    });

                    div.appendChild(grid);

                    // Render Lucide icons
                    setTimeout(() => lucide.createIcons(), 0);

                    // Full Edit Settings
                    const settingsDiv = document.createElement('div');
                    settingsDiv.className = "mt-6 p-4 glass-card rounded-xl space-y-4";

                    settingsDiv.innerHTML = `
                        <h3 class="text-sm font-bold text-slate-300">ConfiguraciÃ³n de la Meta</h3>
                        <div>
                            <label class="block text-xs text-slate-500 mb-1">Nombre</label>
                            <input id="edit-name" type="text" value="${goal.name}" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-white text-sm focus:border-indigo-500 outline-none">
                        </div>
                         <div>
                            <label class="block text-xs text-slate-500 mb-1">Tipo de Fases</label>
                            <select id="edit-phasetype" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-white text-sm focus:border-indigo-500 outline-none appearance-none">
                                <option value="monthly" ${phaseType === 'monthly' ? 'selected' : ''}>Mensual (12 Meses)</option>
                                <option value="bimonthly" ${phaseType === 'bimonthly' ? 'selected' : ''}>Bimensual (6 Fases)</option>
                                <option value="quarterly" ${phaseType === 'quarterly' ? 'selected' : ''}>Trimestral (4 Fases)</option>
                                <option value="semiannual" ${phaseType === 'semiannual' ? 'selected' : ''}>Semestral (2 Fases)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs text-slate-500 mb-1">Fecha LÃ­mite</label>
                            <input id="edit-deadline" type="date" value="${goal.deadline || ''}" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-white text-sm focus:border-indigo-500 outline-none">
                        </div>
                        <div class="flex gap-2 pt-2">
                             <button id="save-settings" class="flex-1 ${btnColors} text-white py-2.5 rounded-lg text-sm font-medium transition-colors shadow-lg">Guardar Cambios</button>
                             <button id="delete-goal" class="px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 rounded-lg"><i data-lucide="trash-2" class="w-5 h-5"></i></button>
                        </div>
                    `;

                    div.appendChild(settingsDiv);

                    // Bind Actions
                    setTimeout(() => {
                        div.querySelector('#save-settings').onclick = () => {
                            goal.name = document.getElementById('edit-name').value;
                            goal.deadline = document.getElementById('edit-deadline').value;
                            goal.phaseType = document.getElementById('edit-phasetype').value;
                            Store.save();
                            alert('ConfiguraciÃ³n actualizada');
                            App.renderView('goal_editor', { goalId }); // Refresh to show new grid
                        };

                        div.querySelector('#delete-goal').onclick = () => {
                            if (confirm(`Â¿EstÃ¡s SEGURA de eliminar la meta "${goal.name}" y todo su progreso?`)) {
                                const levelId = Store.getLevelIdByGoalId(goalId);
                                const level = Store.data.levels.find(l => l.id === levelId);
                                level.goals = level.goals.filter(g => g.id !== goalId);
                                Store.save();
                                App.renderView('level_details', { levelId });
                            }
                        };
                    }, 0);

                    return div;
                },

                PhaseEditor(goalId, monthKey, monthName) {
                    const goal = Store.getGoalById(goalId);
                    if (!goal) return App.renderView('dashboard');

                    // Get Level Info for Theming
                    const levelId = Store.getLevelIdByGoalId(goalId);
                    const level = Store.data.levels.find(l => l.id === levelId);

                    // Theme Colors
                    const theme = {
                        green: 'text-green-400 border-green-500',
                        blue: 'text-blue-400 border-blue-500',
                        purple: 'text-purple-400 border-purple-500'
                    }[level.color] || 'text-indigo-400 border-indigo-500';
                    const titleColor = theme.split(' ')[0];

                    // Init phases
                    if (!goal.phases) goal.phases = {};
                    if (!goal.phases[monthKey]) goal.phases[monthKey] = { objective: '', activities: [] }; // Legacy init

                    const phase = goal.phases[monthKey];

                    // Migrate/Init Routine if missing
                    if (!phase.routine) {
                        phase.routine = { 0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [] };
                    }

                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in pb-20';

                    div.innerHTML = `
                         <div class="flex items-center gap-4 mb-4">
                             <button onclick="App.renderView('goal_editor', { goalId: '${goalId}' })" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                            </button>
                            <div class="flex-1">
                                <h2 class="text-2xl font-bold ${titleColor}">${monthName}</h2>
                                <p class="text-sm text-slate-400 font-medium">${goal.name} <span class="text-slate-600 mx-2">|</span> ${level.name}</p>
                            </div>
                            <button id="copy-month-btn" class="px-4 py-2 bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-500/30 rounded-lg text-indigo-400 flex items-center gap-2 transition-colors" title="Copiar al siguiente mes">
                                <i data-lucide="copy" class="w-4 h-4"></i>
                                <span class="text-sm font-medium">Copiar mes</span>
                            </button>
                        </div>

                        <!-- Objective Input -->
                        <div class="glass-card p-4 rounded-xl border-l-4 ${theme.split(' ')[1]}">
                            <label class="block text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider">Objetivo de la Fase</label>
                            <input id="phase-obj" type="text" value="${phase.objective || ''}" placeholder="Define tu objetivo principal para este periodo..." class="w-full bg-transparent text-lg text-slate-200 placeholder-slate-600 focus:outline-none font-medium mb-3">

                            <label class="block text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider">Notas y Detalles</label>
                            <textarea id="phase-notes" placeholder="AÃ±ade informaciÃ³n adicional: conceptos clave, vocabulario, habilidades, recursos, etc..." class="w-full bg-slate-900/30 border border-slate-700/50 rounded-lg p-3 text-sm text-slate-300 placeholder-slate-600 focus:border-indigo-500 focus:bg-slate-900/50 outline-none resize-none transition-colors" rows="4">${phase.notes || ''}</textarea>
                        </div>
                        `;

                    // Weekly Grid Layout (Monday, Tuesday ... Sunday)
                    const days = [
                        { i: 1, n: 'Lunes' }, { i: 2, n: 'Martes' }, { i: 3, n: 'MiÃ©rcoles' }, { i: 4, n: 'Jueves' }, { i: 5, n: 'Viernes' }, { i: 6, n: 'SÃ¡bado' }, { i: 0, n: 'Domingo' }
                    ];

                    const gridContainer = document.createElement('div');
                    gridContainer.className = "grid grid-cols-1 md:grid-cols-4 lg:grid-cols-7 gap-4 items-start";

                    days.forEach((day) => {
                        const dayCol = document.createElement('div');
                        dayCol.className = "bg-slate-900/50 border border-slate-700/50 rounded-xl overflow-hidden flex flex-col h-full min-h-[300px]";

                        const btnHoverColor = {
                            green: 'hover:text-green-400 hover:bg-green-900/20',
                            blue: 'hover:text-blue-400 hover:bg-blue-900/20',
                            purple: 'hover:text-purple-400 hover:bg-purple-900/20'
                        }[level.color] || 'hover:text-indigo-400 hover:bg-indigo-900/20';

                        // Get current day objective
                        const dayObjective = phase.dayObjectives?.[day.i] || '';

                        // Header
                        dayCol.innerHTML = `
                            <div class="bg-slate-800/80 p-3 border-b border-slate-700/50">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-bold text-slate-300 text-sm">${day.n}</span>
                                    <div class="flex gap-1">
                                        <button class="p-1 hover:bg-slate-700 rounded text-slate-500 ${btnHoverColor} transition-colors" title="Agregar Actividad" onclick="Store.addRoutineActivity('${goalId}', '${monthKey}', ${day.i}); App.renderView('phase_editor', { goalId: '${goalId}', monthKey: '${monthKey}', monthName: '${monthName}' })">
                                            <i data-lucide="plus" class="w-3.5 h-3.5"></i>
                                        </button>
                                         <button class="p-1 hover:bg-slate-700 rounded text-slate-500 ${btnHoverColor} transition-colors" title="Copiar a todos los dÃ­as" onclick="if(confirm('Â¿Copiar ${day.n} a toda la semana?')) { Store.copyWeeklyRoutine('${goalId}', '${monthKey}', ${day.i}); App.renderView('phase_editor', { goalId: '${goalId}', monthKey: '${monthKey}', monthName: '${monthName}' }); }">
                                            <i data-lucide="copy" class="w-3.5 h-3.5"></i>
                                        </button>
                                    </div>
                                </div>
                                <input
                                    type="text"
                                    class="w-full bg-slate-900/50 border border-slate-700/50 rounded px-2 py-1 text-xs text-slate-400 placeholder-slate-600 focus:border-indigo-500 focus:text-slate-300 outline-none transition-colors"
                                    placeholder="Objetivo del dÃ­a (opcional)..."
                                    value="${dayObjective}"
                                    onchange="Store.updateDayObjective('${goalId}', '${monthKey}', ${day.i}, this.value)"
                                />
                            </div>
            `;

                        // Activities List
                        const list = document.createElement('div');
                        list.className = "p-2 space-y-2 flex-1";

                        const acts = phase.routine[day.i] || [];
                        acts.forEach((act, actIdx) => {
                            const row = document.createElement('div');
                            row.className = "group relative";
                            row.innerHTML = `
            <textarea class="w-full bg-slate-800 border border-slate-700 rounded-lg p-2 text-xs text-slate-200 focus:border-indigo-500 outline-none resize-none leading-tight" rows = "2" placeholder = "Actividad..." onchange = "Store.updateRoutineActivity('${goalId}', '${monthKey}', ${day.i}, ${actIdx}, this.value)" > ${act.name}</textarea >
                <button class="absolute top-1 right-1 p-1 text-slate-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity" onclick="Store.removeRoutineActivity('${goalId}', '${monthKey}', ${day.i}, ${actIdx}); App.renderView('phase_editor', { goalId: '${goalId}', monthKey: '${monthKey}', monthName: '${monthName}' })">
                    <i data-lucide="x" class="w-3 h-3"></i>
                </button>
        `;
                            list.appendChild(row);
                        });

                        dayCol.appendChild(list);
                        gridContainer.appendChild(dayCol);
                    });

                    div.appendChild(gridContainer);

                    // Bind event after DOM is ready
                    setTimeout(() => {
                        const objInput = document.getElementById('phase-obj');
                        if (objInput) {
                            objInput.onchange = (e) => {
                                phase.objective = e.target.value;
                                Store.save();
                            };
                        }

                        const notesInput = document.getElementById('phase-notes');
                        if (notesInput) {
                            notesInput.onchange = (e) => {
                                phase.notes = e.target.value;
                                Store.save();
                            };
                        }

                        // Copy month button handler
                        const copyBtn = document.getElementById('copy-month-btn');
                        if (copyBtn) {
                            copyBtn.onclick = () => {
                                // Calculate next month
                                const [year, month] = monthKey.split('-');
                                const nextMonth = parseInt(month) === 12 ? 1 : parseInt(month) + 1;
                                const nextYear = parseInt(month) === 12 ? parseInt(year) + 1 : parseInt(year);
                                const nextKey = `${nextYear}-${String(nextMonth).padStart(2, '0')}`;

                                const monthNames = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
                                const nextMonthName = monthNames[nextMonth - 1];

                                if (confirm(`Â¿Copiar toda la rutina de ${monthName} a ${nextMonthName}?`)) {
                                    goal.phases[nextKey] = JSON.parse(JSON.stringify(phase));
                                    Store.save();
                                    alert('âœ… Rutina copiada exitosamente');
                                    App.renderView('goal_editor', { goalId });
                                }
                            };
                        }
                    }, 100);

                    return div;
                },

                Savings() {
                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in';

                    const savings = Store.data.modules.savings;
                    // Format currency
                    const fmtCash = (n) => "â‚¡" + n.toLocaleString('es-CR');

                    // Header
                    div.innerHTML = `
            <div class="flex items-center gap-4 mb-6" >
                            <button onclick="App.renderView('dashboard')" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                            </button>
                            <h2 class="text-2xl font-bold text-cyan-400">BÃ³veda de Ahorro</h2>
                        </div >
            `;

                    // Card with Progress
                    // Gradient: "azul oscuro a cian neÃ³n" -> from-slate-900 to-cyan-500? or pure gradient
                    const card = document.createElement('div');
                    card.className = 'relative overflow-hidden rounded-2xl p-6 bg-gradient-to-br from-slate-900 via-cyan-950 to-cyan-900 border border-cyan-500/30 shadow-lg shadow-cyan-500/10';

                    card.innerHTML = `
            <div class="relative z-10 text-center" >
                            <p class="text-cyan-200/70 text-sm uppercase tracking-widest font-medium mb-1">Saldo Total</p>
                            <h3 class="text-4xl font-bold text-white mb-4 drop-shadow-md">${fmtCash(savings.balance)}</h3>

                            <!--Fake Goal Progress(Mockup goal 1M ?)-- >
                            <div class="w-full bg-slate-900/50 rounded-full h-3 mb-2 overflow-hidden border border-white/5">
                                <div class="h-full bg-gradient-to-r from-blue-600 to-cyan-400" style="width: ${Math.min((savings.balance / 1000000) * 100, 100)}%"></div>
                            </div>
                            <p class="text-xs text-cyan-300/50 flex justify-between">
                                <span>Inicio</span>
                                <span>Meta: â‚¡1.000.000</span>
                            </p>
                        </div >
                        < !--decorative glow-- >
            <div class="absolute top-0 right-0 -mt-10 -mr-10 w-32 h-32 bg-cyan-500/20 blur-3xl rounded-full"></div>
        `;
                    div.appendChild(card);

                    // Add Money Input
                    const balanceCard = document.createElement('div');
                    balanceCard.className = 'glass-card p-6 rounded-xl text-center';
                    balanceCard.innerHTML = `
            <div class="text-sm text-slate-400 mb-2" > Balance Total</div >
                <div class="text-4xl font-bold text-cyan-400">â‚¡${savings.balance.toLocaleString('es-CR')}</div>
        `;
                    div.appendChild(balanceCard);

                    // Deposit Section
                    const depositCard = document.createElement('div');
                    depositCard.className = 'glass-card p-6 rounded-xl';
                    depositCard.innerHTML = `
            <h3 class="text-lg font-bold text-slate-200 mb-4 flex items-center gap-2">
                <i data-lucide="plus-circle" class="w-5 h-5 text-green-400"></i>
                            Depositar Dinero
                        </h3>
            <div class="flex gap-2">
                <input id="deposit-amount" type="number" placeholder="Cantidad"
                    class="flex-1 bg-slate-900 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 outline-none">
                    <button id="deposit-btn" class="bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        Depositar
                    </button>
            </div>
        `;
                    div.appendChild(depositCard);

                    // Withdrawal Section
                    const withdrawalCard = document.createElement('div');
                    withdrawalCard.className = 'glass-card p-6 rounded-xl';

                    const shopItems = Store.data.modules.shop.items;
                    const shopOptions = shopItems.map(item =>
                        `<option value="${item.id}">${item.name} - ${item.xpRequired || 0} XP</option>`
                    ).join('');

                    withdrawalCard.innerHTML = `
            <h3 class="text-lg font-bold text-slate-200 mb-4 flex items-center gap-2">
                <i data-lucide="minus-circle" class="w-5 h-5 text-red-400"></i>
                            Retirar para Premio
                        </h3>
            <div class="space-y-3">
                <div>
                    <label class="block text-sm text-slate-400 mb-2">Cantidad a retirar</label>
                    <input id="withdrawal-amount" type="number" placeholder="Â¿CuÃ¡nto quieres retirar?"
                        class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white focus:border-red-500 outline-none">
                </div>
                <div>
                    <label class="block text-sm text-slate-400 mb-2">Â¿Para quÃ© premio?</label>
                    <select id="reward-select" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white focus:border-red-500 outline-none">
                        <option value="">Selecciona un premio...</option>
                        ${shopOptions}
                    </select>
                </div>
                <div id="reward-info" class="hidden bg-slate-800/50 p-3 rounded-lg text-sm">
                    <div class="flex justify-between mb-2">
                        <span class="text-slate-400">XP Requerido:</span>
                        <span id="reward-xp" class="text-yellow-400 font-bold"></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-slate-400">Tu XP:</span>
                        <span id="user-xp" class="text-yellow-400 font-bold">${Store.data.user.xp}</span>
                    </div>
                </div>
                <button id="withdraw-btn" class="w-full bg-red-600 hover:bg-red-500 text-white py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Retirar y Canjear
                </button>
                <div id="withdrawal-error" class="hidden text-red-400 text-sm text-center"></div>
            </div>
        `;
                    div.appendChild(withdrawalCard);

                    // History
                    const history = document.createElement('div');
                    history.className = 'bg-slate-900/50 rounded-xl p-4 border border-slate-800/50';
                    history.innerHTML = `<h4 class="text-xs font-bold text-slate-500 uppercase mb-3">Historial Reciente</h4>`;

                    const list = document.createElement('ul');
                    list.className = 'space-y-2 text-sm';

                    // Show last 5
                    [...savings.logs].reverse().slice(0, 5).forEach(log => {
                        const li = document.createElement('li');
                        li.className = 'flex justify-between text-slate-400';
                        li.innerHTML = `< span > ${new Date(log.date).toLocaleDateString()}</span > <span class="text-cyan-400">+${fmtCash(log.amount)}</span>`;
                        list.appendChild(li);
                    });
                    history.appendChild(list);
                    div.appendChild(history);

                    // Event Handlers
                    setTimeout(() => {
                        // Deposit handler
                        const depositBtn = document.getElementById('deposit-btn');
                        const depositInput = document.getElementById('deposit-amount');

                        depositBtn.onclick = () => {
                            const amount = parseInt(depositInput.value);
                            if (amount > 0) {
                                Store.updateSavings(amount);
                                depositInput.value = '';
                                App.renderView('savings');
                            }
                        };

                        // Reward selection handler
                        const rewardSelect = document.getElementById('reward-select');
                        const withdrawalAmountInput = document.getElementById('withdrawal-amount');
                        const rewardInfo = document.getElementById('reward-info');
                        const withdrawBtn = document.getElementById('withdraw-btn');
                        const withdrawalError = document.getElementById('withdrawal-error');

                        const validateWithdrawal = () => {
                            const itemId = rewardSelect.value;
                            const amount = parseInt(withdrawalAmountInput.value);

                            if (!itemId) {
                                rewardInfo.classList.add('hidden');
                                withdrawBtn.disabled = true;
                                withdrawalError.classList.add('hidden');
                                return;
                            }

                            const item = shopItems.find(i => i.id === itemId);
                            if (!item) return;

                            // Show reward info
                            rewardInfo.classList.remove('hidden');
                            document.getElementById('reward-xp').textContent = item.xpRequired + ' XP';
                            document.getElementById('user-xp').textContent = Store.data.user.xp + ' XP';

                            // Validate requirements
                            const hasEnoughXP = Store.data.user.xp >= item.xpRequired;
                            const hasAmount = amount > 0;
                            const hasEnoughBalance = Store.data.modules.savings.balance >= amount;

                            if (!hasAmount) {
                                withdrawalError.textContent = 'âš ï¸ Ingresa la cantidad a retirar';
                                withdrawalError.classList.remove('hidden');
                                withdrawBtn.disabled = true;
                            } else if (!hasEnoughBalance) {
                                withdrawalError.textContent = 'âŒ No tienes suficiente saldo en la bÃ³veda';
                                withdrawalError.classList.remove('hidden');
                                withdrawBtn.disabled = true;
                            } else if (!hasEnoughXP) {
                                withdrawalError.textContent = `âŒ Necesitas ${item.xpRequired} XP para este premio(tienes ${Store.data.user.xp} XP)`;
                                withdrawalError.classList.remove('hidden');
                                withdrawBtn.disabled = true;
                            } else {
                                withdrawalError.classList.add('hidden');
                                withdrawBtn.disabled = false;
                            }
                        };

                        rewardSelect.onchange = validateWithdrawal;
                        withdrawalAmountInput.oninput = validateWithdrawal;

                        // Withdrawal handler
                        withdrawBtn.onclick = () => {
                            const itemId = rewardSelect.value;
                            const amount = parseInt(withdrawalAmountInput.value);

                            if (!itemId || !amount) return;

                            const item = shopItems.find(i => i.id === itemId);
                            if (!item) return;

                            // Double-check requirements
                            if (Store.data.user.xp < item.xpRequired) {
                                alert('No tienes suficiente XP para este premio');
                                return;
                            }

                            if (Store.data.modules.savings.balance < amount) {
                                alert('No tienes suficiente saldo en la bÃ³veda');
                                return;
                            }

                            if (confirm(`Â¿Confirmas el retiro y canje ?\n\nRetiro: â‚¡${amount.toLocaleString('es-CR')} \nPremio: ${item.name} \n\nSe deducirÃ¡n: \n - â‚¡${amount.toLocaleString('es-CR')} de tu bÃ³veda\n - ${item.xpRequired} XP`)) {
                                // Deduct custom amount and XP
                                Store.updateSavings(-amount);
                                Store.addXP(-item.xpRequired);

                                // Show success message
                                alert(`ðŸŽ‰ Â¡Premio canjeado!\n\nRetiraste â‚¡${amount.toLocaleString('es-CR')} para "${item.name}"\n\nDisfruta tu premio! ðŸŽ`);

                                // Refresh view
                                App.renderView('savings');
                            }
                        };

                        lucide.createIcons();
                    }, 0);

                    return div;
                },

                Shop() {
                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in pb-20';

                    div.innerHTML = `
            <div class="flex items-center gap-4 mb-6">
                            <button onclick="App.renderView('dashboard')" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                            </button>
                            <h2 class="text-2xl font-bold text-amber-400">Tienda de Premios</h2>
                        </div>
            <div class="bg-amber-500/10 border border-amber-500/20 p-4 rounded-xl flex justify-between items-center mb-6">
                <span class="text-amber-200 text-sm font-medium">Tu Saldo Disponible</span>
                <span class="text-2xl font-bold text-amber-400 flex items-center gap-2">
                    <i data-lucide="zap" class="w-5 h-5"></i> ${Store.data.user.xp}
                </span>
            </div>
        `;

                    // Add New Item Button
                    const addBtn = document.createElement('button');
                    addBtn.className = "w-full mb-6 p-3 rounded-xl border border-dashed border-amber-600/50 text-amber-400/70 hover:bg-amber-900/20 hover:text-amber-400 hover:border-amber-500 flex justify-center gap-2 transition-all";
                    addBtn.innerHTML = `<i data-lucide="plus-circle" class="w-5 h-5"></i> Nuevo Premio`;
                    addBtn.onclick = () => {
                        // Create modal for tier selection
                        const modal = document.createElement('div');
                        modal.className = 'fixed inset-0 bg-black/80 flex items-center justify-center z-50 animate-fade-in';

                        const tierConfig = {
                            bronze: { name: 'Bronce', xp: 100, color: 'amber-700', icon: 'coffee' },
                            silver: { name: 'Plata', xp: 500, color: 'slate-300', icon: 'star' },
                            gold: { name: 'Oro', xp: 1000, color: 'yellow-400', icon: 'crown' },
                            diamond: { name: 'Diamante', xp: 2000, color: 'cyan-400', icon: 'gem' }
                        };

                        modal.innerHTML = `
            <div class="glass-card p-6 rounded-2xl max-w-md w-full mx-4 animate-scale-in" >
                                <h3 class="text-xl font-bold text-amber-400 mb-4">Crear Nuevo Premio</h3>

                                <div class="mb-4">
                                    <label class="block text-sm text-slate-400 mb-2">Nombre del premio</label>
                                    <input id="reward-name" type="text" placeholder="Ej: CafÃ©, Pizza, Masaje..."
                                        class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white focus:border-amber-500 outline-none">
                                </div>

                                <div class="mb-6">
                                    <label class="block text-sm text-slate-400 mb-3">Nivel del premio</label>
                                    <div class="grid grid-cols-2 gap-3" id="tier-options">
                                        ${Object.entries(tierConfig).map(([key, tier]) => `
                                            <button class="tier-btn p-4 rounded-xl border-2 border-slate-700 hover:border-${tier.color} transition-all text-center" data-tier="${key}">
                                                <i data-lucide="${tier.icon}" class="w-8 h-8 text-${tier.color} mx-auto mb-2"></i>
                                                <div class="font-bold text-slate-200 text-sm">${tier.name}</div>
                                                <div class="text-xs text-${tier.color} font-bold">${tier.xp} XP</div>
                                            </button>
                                        `).join('')}
                                    </div>
                                </div>

                                <div class="flex gap-2">
                                    <button id="cancel-btn" class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-lg font-medium transition-colors">
                                        Cancelar
                                    </button>
                                    <button id="create-btn" class="flex-1 bg-amber-600 hover:bg-amber-500 text-white py-3 rounded-lg font-medium transition-colors" disabled>
                                        Crear Premio
                                    </button>
                                </div>
                            </div >
            `;

                        document.body.appendChild(modal);

                        let selectedTier = null;

                        // Tier selection
                        modal.querySelectorAll('.tier-btn').forEach(btn => {
                            btn.onclick = () => {
                                modal.querySelectorAll('.tier-btn').forEach(b => b.classList.remove('ring-2', 'ring-amber-500'));
                                btn.classList.add('ring-2', 'ring-amber-500');
                                selectedTier = btn.dataset.tier;
                                modal.querySelector('#create-btn').disabled = !modal.querySelector('#reward-name').value.trim();
                            };
                        });

                        // Name input validation
                        modal.querySelector('#reward-name').oninput = (e) => {
                            modal.querySelector('#create-btn').disabled = !e.target.value.trim() || !selectedTier;
                        };

                        // Cancel
                        modal.querySelector('#cancel-btn').onclick = () => modal.remove();

                        // Create
                        modal.querySelector('#create-btn').onclick = () => {
                            const name = modal.querySelector('#reward-name').value.trim();
                            if (!name || !selectedTier) return;

                            const tier = tierConfig[selectedTier];

                            Store.data.modules.shop.items.push({
                                id: Utils.generateId(),
                                name,
                                cost: tier.xp, // For backward compatibility
                                xpRequired: tier.xp,
                                tier: selectedTier,
                                icon: tier.icon
                            });
                            Store.save();
                            modal.remove();
                            App.renderView('shop');
                        };

                        setTimeout(() => lucide.createIcons(), 0);
                    };
                    div.appendChild(addBtn);

                    const grid = document.createElement('div');
                    grid.className = 'grid grid-cols-2 gap-4';

                    Store.data.modules.shop.items.forEach(item => {
                        const card = document.createElement('div');
                        const isAffordable = Store.data.user.xp >= (item.xpRequired || item.cost);

                        card.className = `glass-card p-4 rounded-xl flex flex-col items-center text-center border-2 transition-all group relative ${isAffordable ? 'border-slate-700 hover:border-amber-500/50 cursor-pointer' : 'border-slate-800 opacity-70 grayscale'}`;

                        // Card content
                        card.innerHTML = `
            <div class="w-16 h-16 rounded-full bg-slate-800 flex items-center justify-center mb-3 shadow-inner">
                <i data-lucide="${item.icon}" class="w-8 h-8 text-${item.tier === 'gold' ? 'yellow-400' : item.tier === 'silver' ? 'slate-300' : item.tier === 'diamond' ? 'cyan-400' : 'amber-700'}"></i>
                            </div>
                            <h3 class="font-bold text-slate-200 text-sm mb-1 line-clamp-2">${item.name}</h3>
                            <div class="px-3 py-1 bg-slate-900 rounded-full text-xs font-bold text-amber-400 mt-auto">
                                ${item.xpRequired || item.cost} XP
                            </div>
        `;

                        // Delete button
                        const deleteBtn = document.createElement('div');
                        deleteBtn.className = "absolute top-2 right-2 flex gap-1 z-10 opacity-0 group-hover:opacity-100 transition-opacity";
                        deleteBtn.innerHTML = `
            <button class="delete-btn p-1.5 bg-slate-900 rounded-full text-red-400 hover:text-red-300 shadow-md">
                <i data-lucide="trash" class="w-3 h-3"></i>
                            </button>
            `;

                        deleteBtn.querySelector('.delete-btn').onclick = (e) => {
                            e.stopPropagation();
                            if (confirm(`Â¿Borrar "${item.name}" ? `)) {
                                Store.data.modules.shop.items = Store.data.modules.shop.items.filter(i => i.id !== item.id);
                                Store.save();
                                App.renderView('shop');
                            }
                        };

                        card.appendChild(deleteBtn);

                        // Buy Action
                        card.onclick = (e) => {
                            if (!e.target.closest('.delete-btn')) {
                                if (isAffordable) {
                                    if (confirm(`Â¿Canjear "${item.name}" por ${item.xpRequired || item.cost} XP ? `)) {
                                        Store.addXP(-(item.xpRequired || item.cost));
                                        alert(`ðŸŽ‰ Â¡Premio canjeado! Disfruta tu ${item.name} `);
                                        App.renderView('shop');
                                    }
                                } else {
                                    alert('Te faltan XP para este premio.');
                                }
                            }
                        };

                        grid.appendChild(card);
                    });

                    div.appendChild(grid);
                    return div;
                },

                LevelCreator(levelId = null) {
                    const isEdit = !!levelId;
                    const level = isEdit ? Store.data.levels.find(l => l.id === levelId) : null;

                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in pb-20';

                    // Available colors and icons
                    const colors = [
                        { name: 'Verde', value: 'green', class: 'bg-green-500' },
                        { name: 'Azul', value: 'blue', class: 'bg-blue-500' },
                        { name: 'Morado', value: 'purple', class: 'bg-purple-500' },
                        { name: 'Rojo', value: 'red', class: 'bg-red-500' },
                        { name: 'Amarillo', value: 'yellow', class: 'bg-yellow-500' },
                        { name: 'Cyan', value: 'cyan', class: 'bg-cyan-500' },
                        { name: 'Rosa', value: 'pink', class: 'bg-pink-500' },
                        { name: 'Naranja', value: 'orange', class: 'bg-orange-500' }
                    ];

                    const icons = [
                        'dumbbell', 'brain', 'sparkles', 'heart', 'book', 'briefcase',
                        'target', 'trophy', 'star', 'flame', 'zap', 'compass',
                        'palette', 'music', 'camera', 'coffee', 'home', 'users'
                    ];

                    div.innerHTML = `
            <div class="flex items-center gap-4 mb-6">
                            <button onclick="App.renderView('dashboard')" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                            </button>
                            <h2 class="text-2xl font-bold text-slate-200">${isEdit ? 'Editar Nivel' : 'Crear Nuevo Nivel'}</h2>
                        </div>

            <div class="glass-card p-6 rounded-xl space-y-6">
                <div>
                    <label class="block text-sm font-bold text-slate-300 mb-2">Nombre del Nivel</label>
                    <input id="level-name" type="text" value="${isEdit ? level.name : ''}" placeholder="Ej: Profesional, Social, Financiero..."
                        class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white focus:border-indigo-500 outline-none">
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-300 mb-3">Color</label>
                    <div id="color-picker" class="grid grid-cols-4 gap-2">
                        ${colors.map(c => `
                                        <button class="color-option p-3 rounded-lg border-2 border-transparent hover:border-slate-500 transition-all flex flex-col items-center gap-2" data-color="${c.value}">
                                            <div class="w-8 h-8 rounded-full ${c.class}"></div>
                                            <span class="text-xs text-slate-400">${c.name}</span>
                                        </button>
                                    `).join('')}
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-300 mb-3">Ãcono</label>
                    <div id="icon-picker" class="grid grid-cols-6 gap-2">
                        ${icons.map(icon => `
                                        <button class="icon-option p-3 rounded-lg border-2 border-transparent hover:border-slate-500 transition-all flex items-center justify-center" data-icon="${icon}">
                                            <i data-lucide="${icon}" class="w-6 h-6 text-slate-400"></i>
                                        </button>
                                    `).join('')}
                    </div>
                </div>

                <div class="flex gap-3 pt-4">
                    <button id="save-level-btn" class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-lg font-medium transition-colors">
                        ${isEdit ? 'Guardar Cambios' : 'Crear Nivel'}
                    </button>
                    ${isEdit ? `<button id="delete-level-btn" class="px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 rounded-lg"><i data-lucide="trash-2" class="w-5 h-5"></i></button>` : ''}
                </div>
            </div>
        `;

                    // State
                    let selectedColor = isEdit ? level.color : 'green';
                    let selectedIcon = isEdit ? level.icon : 'target';

                    // Bind events after render
                    setTimeout(() => {
                        // Color selection
                        div.querySelectorAll('.color-option').forEach(btn => {
                            if (btn.dataset.color === selectedColor) {
                                btn.classList.add('border-indigo-500');
                            }
                            btn.onclick = () => {
                                div.querySelectorAll('.color-option').forEach(b => b.classList.remove('border-indigo-500'));
                                btn.classList.add('border-indigo-500');
                                selectedColor = btn.dataset.color;
                            };
                        });

                        // Icon selection
                        div.querySelectorAll('.icon-option').forEach(btn => {
                            if (btn.dataset.icon === selectedIcon) {
                                btn.classList.add('border-indigo-500');
                            }
                            btn.onclick = () => {
                                div.querySelectorAll('.icon-option').forEach(b => b.classList.remove('border-indigo-500'));
                                btn.classList.add('border-indigo-500');
                                selectedIcon = btn.dataset.icon;
                            };
                        });

                        // Save button
                        div.querySelector('#save-level-btn').onclick = () => {
                            const name = document.getElementById('level-name').value.trim();
                            if (!name) {
                                alert('Por favor ingresa un nombre para el nivel');
                                return;
                            }

                            if (isEdit) {
                                Store.updateLevel(levelId, name, selectedColor, selectedIcon);
                            } else {
                                Store.createLevel(name, selectedColor, selectedIcon);
                            }
                            App.renderView('dashboard');
                        };

                        // Delete button (only in edit mode)
                        if (isEdit) {
                            div.querySelector('#delete-level-btn').onclick = () => {
                                if (confirm(`Â¿EstÃ¡s segura de eliminar el nivel "${level.name}" y todas sus metas ? `)) {
                                    Store.deleteLevel(levelId);
                                    App.renderView('dashboard');
                                }
                            };
                        }

                        lucide.createIcons();
                    }, 0);

                    return div;
                },

                LevelEditor(levelId) {
                    return this.LevelCreator(levelId);
                },

                Journal() {
                    const div = document.createElement('div');
                    div.className = 'space-y-6 animate-fade-in h-[calc(100vh-100px)] flex flex-col pb-20';

                    const dateKey = App.state.currentDate;

                    div.innerHTML = `
            <div class="flex items-center justify-between mb-2 shrink-0" >
                            <div class="flex items-center gap-4">
                                <button onclick="App.renderView('dashboard')" class="p-2 -ml-2 rounded-full hover:bg-slate-800">
                                    <i data-lucide="arrow-left" class="w-6 h-6 text-slate-400"></i>
                                </button>
                                <div>
                                    <h2 class="text-2xl font-bold text-pink-400">Diario</h2>
                                    <p class="text-xs text-slate-500">${Utils.formatDateFriends(dateKey)}</p>
                                </div>
                            </div>
                            <button id="toggle-history" class="text-xs text-pink-400 font-medium flex items-center gap-1 bg-pink-500/10 px-3 py-1.5 rounded-full border border-pink-500/20">
                                <i data-lucide="history" class="w-4 h-4"></i> Historial
                            </button>
                        </div >
            `;

                    // Main Layout: Sidebar (Hidden by default on mobile) + Editor
                    const contentContainer = document.createElement('div');
                    contentContainer.className = "flex-1 flex gap-4 overflow-hidden relative";

                    // History Sidebar overlay
                    const historyPanel = document.createElement('div');
                    historyPanel.className = "absolute inset-0 bg-slate-900 z-20 transform translate-x-full transition-transform duration-300 flex flex-col p-4 border border-slate-700 rounded-xl";
                    historyPanel.id = "journal-history";

                    historyPanel.innerHTML = `
            <div class="flex justify-between items-center mb-4" >
                            <h3 class="text-lg font-bold text-slate-200">Entradas Pasadas</h3>
                            <button id="close-history" class="p-2 hover:bg-slate-800 rounded-full"><i data-lucide="x" class="w-5 h-5"></i></button>
                        </div >
            <div class="overflow-y-auto space-y-2 flex-1">
                ${Object.keys(Store.data.modules.journal).sort().reverse().map(d => `
                                <button class="w-full text-left p-3 rounded-lg hover:bg-slate-800 border border-slate-700/50 flex flex-col group" onclick="App.state.currentDate='${d}'; App.updateDateDisplay(); App.renderView('journal')">
                                    <span class="text-sm font-bold text-slate-300 group-hover:text-white">${Utils.formatDateFriends(d)}</span>
                                    <span class="text-xs text-slate-500 truncate">${Store.data.modules.journal[d].substring(0, 40)}...</span>
                                </button>
                            `).join('')}
                ${Object.keys(Store.data.modules.journal).length === 0 ? '<p class="text-slate-500 text-sm italic">Tu historia comienza hoy...</p>' : ''}
            </div>
        `;
                    contentContainer.appendChild(historyPanel);

                    const textarea = document.createElement('textarea');
                    textarea.className = 'flex-1 w-full bg-slate-800/50 border border-slate-700 rounded-xl p-5 text-slate-300 focus:outline-none focus:border-pink-500/50 resize-none leading-relaxed text-sm';
                    textarea.placeholder = "Escribe tus pensamientos, logros y gratitud de hoy...";
                    textarea.value = Store.data.modules.journal[dateKey] || '';

                    textarea.addEventListener('input', (e) => {
                        Store.saveJournal(dateKey, e.target.value);
                    });

                    contentContainer.appendChild(textarea);
                    div.appendChild(contentContainer);

                    // Toggle Logic
                    setTimeout(() => {
                        const toggle = div.querySelector('#toggle-history');
                        const close = historyPanel.querySelector('#close-history');
                        const panel = historyPanel;

                        toggle.onclick = () => panel.classList.remove('translate-x-full');
                        close.onclick = () => panel.classList.add('translate-x-full');
                    }, 0);

                    return div;
                }
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            try {
                App.init();
            } catch (e) {
                document.body.innerHTML = `<div class="p-10 text-red-500"><h1>Error CrÃ­tico</h1><pre>${e.stack}</pre><button onclick="localStorage.clear(); location.reload()">Reset DB</button></div>`;
                console.error(e);
            }
        });

        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then((registration) => {
                        console.log('âœ… Service Worker registrado:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('âŒ Error al registrar Service Worker:', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('ðŸ’¡ App lista para instalar');

            // Mostrar botÃ³n de instalaciÃ³n (opcional)
            // Puedes agregar un botÃ³n en la UI para instalar la app
        });

        window.addEventListener('appinstalled', () => {
            console.log('âœ… PWA instalada exitosamente');
            deferredPrompt = null;
        });

    </script>

    <script>
        // Auto-ejecutar rutinas al cargar la pÃ¡gina (solo si no existen)
        (function () {
            console.log('ðŸš€ Inicializando rutinas...');

            // Esperar a que Store estÃ© disponible
            if (typeof Store === 'undefined') {
                console.error('âŒ Store no disponible');
                return;
            }

            // Verificar si las rutinas ya estÃ¡n cargadas
            const data = Store.data;
            const spiritualLevel = data.levels.find(l => l.name.toLowerCase().includes('espiritual'));
            const physicalLevel = data.levels.find(l => l.name.toLowerCase().includes('fÃ­sico'));
            const mentalLevel = data.levels.find(l => l.name.toLowerCase().includes('mental'));

            let rutinasAgregadas = false;

            // Agregar GeÃ³metra MÃ­stico si no existe
            if (spiritualLevel && !spiritualLevel.goals.find(g => g.id === 'goal_geometra_mistico')) {
                console.log('âž• Agregando GeÃ³metra MÃ­stico...');
                // Script para agregar la rutina "GeÃ³metra MÃ­stico" al nivel Espiritual
                // Ejecutar en la consola del navegador mientras index.html estÃ¡ abierto
                // VERSIÃ“N COMPLETA CON ACTIVIDADES ESPECÃFICAS POR MES


                console.log('ðŸ”® Agregando rutina GeÃ³metra MÃ­stico (VersiÃ³n Completa)...\n');

                const data = Store.data;

                if (!data.levels || data.levels.length === 0) {
                    console.error('âŒ No hay niveles. Abre la app primero.');
                    return;
                }

                // Buscar nivel Espiritual
                const spiritualLevel = data.levels.find(l => l.name.toLowerCase().includes('espiritual'));

                if (!spiritualLevel) {
                    console.error('âŒ Nivel Espiritual no encontrado.');
                    console.log('ðŸ’¡ Crea un nivel llamado "Espiritual" primero en la app.');
                    return;
                }

                console.log(`âœ… Nivel Espiritual encontrado: "${spiritualLevel.name}"`);

                // Eliminar rutina si ya existe
                if (spiritualLevel.goals) {
                    const existing = spiritualLevel.goals.find(g => g.id === 'goal_geometra_mistico_2026');
                    if (existing) {
                        console.log('âš ï¸ Rutina ya existe. Actualizando...');
                        spiritualLevel.goals = spiritualLevel.goals.filter(g => g.id !== 'goal_geometra_mistico_2026');
                    }
                } else {
                    spiritualLevel.goals = [];
                }

                // Crear meta
                const geometraGoal = {
                    id: "goal_geometra_mistico_2026",
                    name: "GeÃ³metra MÃ­stico",
                    color: spiritualLevel.color || "purple",
                    phaseType: "monthly",
                    phases: {}
                };

                // ==================== MES 1: SEMILLA DE LA VIDA ====================
                geometraGoal.phases["2026-02"] = {
                    objective: "Trimestre 1: La Estructura y el OrÃ¡culo - Aprendiz de SÃ­mbolos",
                    notes: `ðŸ“ **GEOMETRÃA SAGRADA: LA SEMILLA DE LA VIDA**

ðŸŽ¯ **OBJETIVO DEL MES**
Dominar herramientas bÃ¡sicas y desarrollar la conexiÃ³n mano-ojo a travÃ©s de la prÃ¡ctica diaria del dibujo geomÃ©trico sagrado.

âœ¨ **SIGNIFICADO ESPIRITUAL**
La Semilla de la Vida representa el blueprint de la creaciÃ³n. Sus 7 cÃ­rculos interconectados simbolizan los 7 dÃ­as de la creaciÃ³n y contienen la base de toda geometrÃ­a sagrada.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ "Sacred Geometry: Philosophy and Practice" - Robert Lawlor
â€¢ Estudiar el Vesica Piscis (intersecciÃ³n de 2 cÃ­rculos)
â€¢ Comprender las proporciones divinas en la naturaleza
â€¢ Investigar la relaciÃ³n entre geometrÃ­a y conciencia

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ CompÃ¡s de precisiÃ³n
â€¢ Regla
â€¢ Papel de dibujo (mÃ­nimo 20x20cm)
â€¢ LÃ¡pices HB y 2B
â€¢ Diario espiritual`,
                    routine: {
                        1: [ // Lunes
                            { name: "MeditaciÃ³n (10min): Visualizar la Semilla de la Vida en tu mente" },
                            { name: "Dibujo tÃ©cnico (30min): Trazar Semilla de Vida con compÃ¡s" },
                            { name: "Estudio teÃ³rico (45min): Leer sobre geometrÃ­a sagrada" },
                            { name: "Limpieza energÃ©tica (5min): Cuenco tibetano antes de dibujar" },
                            { name: "Diario (5min): Registrar sensaciones durante el dibujo" }
                        ],
                        2: [ // Martes
                            { name: "MeditaciÃ³n (10min): Respirar siguiendo el patrÃ³n circular" },
                            { name: "PrÃ¡ctica de precisiÃ³n (30min): Dibujar sin levantar el compÃ¡s" },
                            { name: "Estudio simbÃ³lico (45min): Significado de los 7 cÃ­rculos" },
                            { name: "Limpieza (5min): Limpiar tu espacio de trabajo" },
                            { name: "Diario (5min): Anotar insights sobre el nÃºmero 7" }
                        ],
                        3: [ // MiÃ©rcoles
                            { name: "MeditaciÃ³n (10min): Conectar con la intenciÃ³n de creaciÃ³n" },
                            { name: "Dibujo meditativo (30min): Trazar lentamente, con consciencia" },
                            { name: "Estudio aplicado (45min): Vesica Piscis y su significado" },
                            { name: "Limpieza (5min): Cuarzo para limpiar herramientas" },
                            { name: "Diario (5min): Reflexionar sobre dualidad y uniÃ³n" }
                        ],
                        4: [ // Jueves
                            { name: "MeditaciÃ³n (10min): Visualizar energÃ­a fluyendo en los cÃ­rculos" },
                            { name: "PrÃ¡ctica avanzada (30min): Dibujar con ojos cerrados parcialmente" },
                            { name: "Estudio comparativo (45min): Semilla de Vida en culturas antiguas" },
                            { name: "Limpieza (5min): Incienso de sÃ¡ndalo" },
                            { name: "Diario (5min): Conexiones con otras tradiciones" }
                        ],
                        5: [ // Viernes
                            { name: "MeditaciÃ³n (10min): Gratitud por el aprendizaje semanal" },
                            { name: "Dibujo perfeccionado (30min): Tu mejor Semilla de la Vida" },
                            { name: "Estudio de proporciones (45min): Phi y proporciones divinas" },
                            { name: "Limpieza (5min): Cuenco tibetano - cierre semanal" },
                            { name: "Diario (5min): IntegraciÃ³n de la semana" }
                        ],
                        6: [ // SÃ¡bado
                            { name: "PrÃ¡ctica extendida (1h): Crear Semilla de Vida grande (40x40cm) con color" },
                            { name: "MeditaciÃ³n profunda (20min): Contemplar tu creaciÃ³n" }
                        ],
                        0: [ // Domingo
                            { name: "RevisiÃ³n semanal (30min): Comparar tus 5 dibujos de la semana" },
                            { name: "PreparaciÃ³n (30min): Leer sobre el Tarot para prÃ³ximo mes" }
                        ]
                    },
                    dayObjectives: {
                        1: "Establecer precisiÃ³n tÃ©cnica",
                        2: "Profundizar en el simbolismo",
                        3: "Conectar dualidad y uniÃ³n",
                        4: "Expandir perspectiva cultural",
                        5: "Integrar aprendizajes semanales"
                    }
                };

                // ==================== MES 2: TAROT Y ARQUETIPOS ====================
                geometraGoal.phases["2026-03"] = {
                    objective: "Tarot y Arquetipos: Descubrir la GeometrÃ­a Oculta",
                    notes: `ðŸƒ **TAROT Y ARQUETIPOS**

ðŸŽ¯ **OBJETIVO DEL MES**
Estudiar los 22 Arcanos Mayores no solo como cartas adivinatorias, sino como mapas geomÃ©tricos y arquetipos universales.

âœ¨ **EL VIAJE DEL LOCO**
Los Arcanos Mayores narran "El Viaje del Loco" - un camino de evoluciÃ³n espiritual desde la inocencia (El Loco) hasta la completitud (El Mundo).

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ "The Tarot: A Key to the Wisdom of the Ages" - Paul Foster Case
â€¢ Estudiar simbolismo en cada carta
â€¢ GeometrÃ­a oculta: cÃ­rculos, triÃ¡ngulos, cuadrados
â€¢ Correspondencias con CÃ¡bala y astrologÃ­a

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ Mazo de Tarot (Rider-Waite recomendado)
â€¢ Lupa para detalles
â€¢ Papel para dibujar geometrÃ­a encontrada
â€¢ Diario de Tarot`,
                    routine: {
                        1: [
                            { name: "Carta del dÃ­a (10min): Sacar 1 Arcano Mayor, meditar en Ã©l" },
                            { name: "AnÃ¡lisis geomÃ©trico (30min): Identificar formas en la carta" },
                            { name: "Estudio profundo (45min): Leer sobre el Arcano del dÃ­a" },
                            { name: "Dibujo (15min): Trazar la geometrÃ­a encontrada" },
                            { name: "Diario (5min): Registrar sÃ­mbolos y significados" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n con carta (10min): Visualizar entrando en la carta" },
                            { name: "BÃºsqueda de patrones (30min): Comparar con cartas anteriores" },
                            { name: "Estudio de arquetipos (45min): Jung y los arquetipos" },
                            { name: "Dibujo comparativo (15min): GeometrÃ­as similares" },
                            { name: "Diario (5min): Conexiones arquetÃ­picas" }
                        ],
                        3: [
                            { name: "Carta + pregunta (10min): Hacer pregunta personal" },
                            { name: "InterpretaciÃ³n intuitiva (30min): Sin consultar libro" },
                            { name: "Estudio del Viaje del Loco (45min): Etapas del viaje" },
                            { name: "Mapa visual (15min): Dibujar tu posiciÃ³n en el viaje" },
                            { name: "Diario (5min): ReflexiÃ³n personal" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n guiada (10min): El Arcano como maestro" },
                            { name: "AnÃ¡lisis de color (30min): Significado de colores en carta" },
                            { name: "Estudio cabalÃ­stico (45min): Ãrbol de la Vida y Tarot" },
                            { name: "Dibujo simbÃ³lico (15min): Crear tu versiÃ³n del Arcano" },
                            { name: "Diario (5min): Insights cabalÃ­sticos" }
                        ],
                        5: [
                            { name: "RevisiÃ³n semanal (10min): Repasar 5 Arcanos estudiados" },
                            { name: "Spread de 3 cartas (30min): Pasado-Presente-Futuro" },
                            { name: "Estudio de numerologÃ­a (45min): NÃºmeros en los Arcanos" },
                            { name: "SÃ­ntesis visual (15min): Mapa de la semana" },
                            { name: "Diario (5min): IntegraciÃ³n semanal" }
                        ],
                        6: [
                            { name: "Estudio profundo (1h): Elegir 3 Arcanos favoritos y estudiarlos a fondo" },
                            { name: "CreaciÃ³n artÃ­stica (30min): Dibujar tu interpretaciÃ³n de uno" }
                        ],
                        0: [
                            { name: "Lectura completa (45min): Hacer lectura de 10 cartas (Cruz Celta)" },
                            { name: "PreparaciÃ³n (15min): Leer sobre limpieza vibracional" }
                        ]
                    },
                    dayObjectives: {
                        1: "Observar sin juzgar",
                        2: "Encontrar patrones ocultos",
                        3: "Confiar en la intuiciÃ³n",
                        4: "Expandir conocimiento esotÃ©rico",
                        5: "Integrar la semana"
                    }
                };

                // ==================== MES 3: LIMPIEZA VIBRACIONAL ====================
                geometraGoal.phases["2026-04"] = {
                    objective: "Limpieza Vibracional: Preparar el Espacio Sagrado",
                    notes: `ðŸ”” **LIMPIEZA VIBRACIONAL**

ðŸŽ¯ **OBJETIVO DEL MES**
Dominar tÃ©cnicas de limpieza energÃ©tica usando cuenco tibetano y cuarzos para preparar tu espacio sagrado de estudio.

âœ¨ **FUNDAMENTO VIBRACIONAL**
Todo es vibraciÃ³n. El sonido del cuenco tibetano (110-900 Hz) puede limpiar energÃ­as estancadas y elevar la frecuencia de un espacio.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ Frecuencias Solfeggio (396, 417, 528, 639, 741, 852 Hz)
â€¢ Propiedades de cristales (Cuarzo claro, Selenita, Amatista)
â€¢ TeorÃ­a de resonancia y armonizaciÃ³n
â€¢ Chakras y frecuencias correspondientes

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ Cuenco tibetano (o cuenco de cuarzo)
â€¢ Mazo para el cuenco
â€¢ Set de cuarzos (mÃ­nimo 3)
â€¢ Incienso o palo santo
â€¢ Sal marina`,
                    routine: {
                        1: [
                            { name: "MeditaciÃ³n (10min): Sentir la energÃ­a actual del espacio" },
                            { name: "PrÃ¡ctica de cuenco (30min): Aprender a tocar correctamente" },
                            { name: "Estudio de frecuencias (45min): Frecuencias Solfeggio" },
                            { name: "Limpieza bÃ¡sica (10min): Cuenco en 4 esquinas" },
                            { name: "Diario (5min): Cambios energÃ©ticos percibidos" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n sonora (10min): Escuchar el cuenco" },
                            { name: "TÃ©cnica de barrido (30min): Mover cuenco por el espacio" },
                            { name: "Estudio de cristales (45min): Propiedades del cuarzo" },
                            { name: "Limpieza de cristales (10min): Cuenco sobre cristales" },
                            { name: "Diario (5min): Observaciones sobre cristales" }
                        ],
                        3: [
                            { name: "MeditaciÃ³n con cristal (10min): Sostener cuarzo mientras meditas" },
                            { name: "PrÃ¡ctica combinada (30min): Cuenco + incienso" },
                            { name: "Estudio de chakras (45min): Frecuencias por chakra" },
                            { name: "Limpieza de chakras (10min): Cuenco en cada chakra" },
                            { name: "Diario (5min): Sensaciones en chakras" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n de anclaje (10min): Conectar con la tierra" },
                            { name: "TÃ©cnica avanzada (30min): Patrones de sonido" },
                            { name: "Estudio de geometrÃ­a sonora (45min): Cymatics" },
                            { name: "Experimento (10min): Sal + cuenco (ver patrones)" },
                            { name: "Diario (5min): GeometrÃ­a del sonido" }
                        ],
                        5: [
                            { name: "MeditaciÃ³n de gratitud (10min): Agradecer al espacio" },
                            { name: "Ritual completo (30min): Limpieza total del espacio" },
                            { name: "Estudio de mantenimiento (45min): Frecuencia de limpieza" },
                            { name: "Sellado energÃ©tico (10min): ProtecciÃ³n del espacio" },
                            { name: "Diario (5min): Plan de mantenimiento" }
                        ],
                        6: [
                            { name: "Ritual extendido (1h): Limpieza profunda de toda la casa" },
                            { name: "ProgramaciÃ³n de cristales (30min): Cargar cristales con intenciÃ³n" }
                        ],
                        0: [
                            { name: "RevisiÃ³n (30min): Evaluar cambios en el espacio" },
                            { name: "PreparaciÃ³n (30min): Leer sobre pÃ©ndulo y radiestesia" }
                        ]
                    },
                    dayObjectives: {
                        1: "Dominar tÃ©cnica bÃ¡sica",
                        2: "Integrar herramientas",
                        3: "Trabajar con chakras",
                        4: "Comprender geometrÃ­a sonora",
                        5: "Crear ritual personal"
                    }
                };

                // ==================== MES 4: PÃ‰NDULO Y RADIESTESIA ====================
                geometraGoal.phases["2026-05"] = {
                    objective: "Trimestre 2: La EnergÃ­a y el PÃ©ndulo - Radiestesia PrÃ¡ctica",
                    notes: `ðŸ”® **EL PÃ‰NDULO Y LA INTENCIÃ“N**

ðŸŽ¯ **OBJETIVO DEL MES**
Aprender a medir lo invisible usando el pÃ©ndulo y crear tableros de radiestesia con geometrÃ­a sagrada.

âœ¨ **FUNDAMENTO DE RADIESTESIA**
La radiestesia es la capacidad de detectar energÃ­as sutiles. El pÃ©ndulo amplifica los micro-movimientos musculares guiados por tu intuiciÃ³n.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ "The Pendulum Book" - Sig Lonegren
â€¢ Tableros radiestÃ©sicos y su diseÃ±o
â€¢ GeometrÃ­a sagrada en tableros
â€¢ CalibraciÃ³n y limpieza del pÃ©ndulo

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ PÃ©ndulo (cristal, metal o madera)
â€¢ Papel y compÃ¡s para crear tableros
â€¢ Regla y transportador
â€¢ Cuarzo para calibraciÃ³n`,
                    routine: {
                        1: [
                            { name: "MeditaciÃ³n (10min): Conectar con tu pÃ©ndulo" },
                            { name: "CalibraciÃ³n (30min): Establecer SÃ/NO/TAL VEZ" },
                            { name: "Estudio teÃ³rico (45min): Historia de la radiestesia" },
                            { name: "PrÃ¡ctica bÃ¡sica (15min): Preguntas simples" },
                            { name: "Diario (5min): Registrar respuestas" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n de claridad (10min): Mente clara para preguntar" },
                            { name: "PrÃ¡ctica con objetos (30min): Encontrar objetos escondidos" },
                            { name: "Estudio de tableros (45min): Tipos de tableros" },
                            { name: "DiseÃ±o inicial (15min): Boceto de tu tablero" },
                            { name: "Diario (5min): Ideas para tablero personal" }
                        ],
                        3: [
                            { name: "MeditaciÃ³n con geometrÃ­a (10min): Visualizar cÃ­rculos perfectos" },
                            { name: "CreaciÃ³n de tablero (30min): Dibujar tablero bÃ¡sico" },
                            { name: "Estudio de geometrÃ­a (45min): CÃ­rculos y radianes" },
                            { name: "PrÃ¡ctica con tablero (15min): Usar tu tablero" },
                            { name: "Diario (5min): Efectividad del tablero" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n de intenciÃ³n (10min): Clarificar preguntas" },
                            { name: "Tablero avanzado (30min): Agregar sÃ­mbolos sagrados" },
                            { name: "Estudio de sÃ­mbolos (45min): SÃ­mbolos en radiestesia" },
                            { name: "PrÃ¡ctica compleja (15min): Preguntas de mÃºltiples opciones" },
                            { name: "Diario (5min): PrecisiÃ³n de respuestas" }
                        ],
                        5: [
                            { name: "MeditaciÃ³n de gratitud (10min): Agradecer la guÃ­a" },
                            { name: "Perfeccionamiento (30min): Finalizar tablero maestro" },
                            { name: "Estudio de Ã©tica (45min): Ã‰tica en radiestesia" },
                            { name: "PrÃ¡ctica de verificaciÃ³n (15min): Confirmar respuestas" },
                            { name: "Diario (5min): ReflexiÃ³n sobre responsabilidad" }
                        ],
                        6: [
                            { name: "CreaciÃ³n final (1h30min): Tablero personal definitivo con geometrÃ­a sagrada" }
                        ],
                        0: [
                            { name: "PrÃ¡ctica libre (45min): SesiÃ³n de preguntas personales" },
                            { name: "PreparaciÃ³n (15min): Leer sobre programaciÃ³n de cristales" }
                        ]
                    },
                    dayObjectives: {
                        1: "Establecer conexiÃ³n con pÃ©ndulo",
                        2: "Desarrollar sensibilidad",
                        3: "Crear herramientas personales",
                        4: "Profundizar en simbolismo",
                        5: "Integrar Ã©tica y responsabilidad"
                    }
                };

                // ContinÃºa en el siguiente bloque...

                // ==================== MES 5: PROGRAMACIÃ“N DE CUARZOS ====================
                geometraGoal.phases["2026-06"] = {
                    objective: "ProgramaciÃ³n de Cuarzos: Cargar Cristales con Frecuencias",
                    notes: `ðŸ’Ž **PROGRAMACIÃ“N DE CUARZOS**

ðŸŽ¯ **OBJETIVO DEL MES**
Aprender a cargar cristales con frecuencias especÃ­ficas usando el cuenco tibetano y tu intenciÃ³n.

âœ¨ **FUNDAMENTO CRISTALINO**
Los cuarzos tienen estructura cristalina que puede almacenar y amplificar energÃ­a. La programaciÃ³n implica imbuir el cristal con una intenciÃ³n especÃ­fica.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ Propiedades piezoelÃ©ctricas del cuarzo
â€¢ Frecuencias especÃ­ficas para diferentes intenciones
â€¢ MÃ©todos de limpieza antes de programar
â€¢ Mantenimiento de cristales programados

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ Cuarzos variados (claro, rosa, amatista, citrino)
â€¢ Cuenco tibetano
â€¢ Agua de luna (opcional)
â€¢ Selenita para limpieza`,
                    routine: {
                        1: [
                            { name: "MeditaciÃ³n (10min): Conectar con tus cristales" },
                            { name: "Limpieza profunda (30min): Limpiar todos los cristales" },
                            { name: "Estudio de propiedades (45min): Cada tipo de cuarzo" },
                            { name: "SelecciÃ³n (10min): Elegir cristal para programar" },
                            { name: "Diario (5min): IntenciÃ³n para cada cristal" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n de claridad (10min): Clarificar intenciÃ³n" },
                            { name: "ProgramaciÃ³n bÃ¡sica (30min): Primer cristal con intenciÃ³n" },
                            { name: "Estudio de frecuencias (45min): 432 Hz, 528 Hz, etc." },
                            { name: "Carga con cuenco (10min): Cuenco sobre cristal programado" },
                            { name: "Diario (5min): Sensaciones durante programaciÃ³n" }
                        ],
                        3: [
                            { name: "MeditaciÃ³n con cristal (10min): Sostener cristal programado" },
                            { name: "ProgramaciÃ³n avanzada (30min): MÃºltiples intenciones" },
                            { name: "Estudio de geometrÃ­a (45min): Estructura cristalina" },
                            { name: "VerificaciÃ³n (10min): PÃ©ndulo para verificar carga" },
                            { name: "Diario (5min): Efectividad de la programaciÃ³n" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n de red (10min): Visualizar red cristalina" },
                            { name: "Grid de cristales (30min): Crear grid geomÃ©trico" },
                            { name: "Estudio de grids (45min): GeometrÃ­a en grids" },
                            { name: "ActivaciÃ³n de grid (10min): Cuenco para activar" },
                            { name: "Diario (5min): EnergÃ­a del grid" }
                        ],
                        5: [
                            { name: "MeditaciÃ³n de gratitud (10min): Agradecer a los cristales" },
                            { name: "Cuarzo maestro (30min): Programar cuarzo personal" },
                            { name: "Estudio de mantenimiento (45min): Cuidado a largo plazo" },
                            { name: "Ritual de sellado (10min): Sellar programaciÃ³n" },
                            { name: "Diario (5min): Plan de mantenimiento" }
                        ],
                        6: [
                            { name: "Proyecto especial (1h30min): Programar cuarzo maestro personal con mÃºltiples frecuencias" }
                        ],
                        0: [
                            { name: "RevisiÃ³n (30min): Evaluar todos los cristales programados" },
                            { name: "PreparaciÃ³n (30min): Leer sobre sigilos y magia simbÃ³lica" }
                        ]
                    },
                    dayObjectives: {
                        1: "Preparar cristales correctamente",
                        2: "Dominar programaciÃ³n bÃ¡sica",
                        3: "Verificar efectividad",
                        4: "Crear sistemas de cristales",
                        5: "Establecer prÃ¡ctica sostenible"
                    }
                };

                // ContinÃºa con los meses restantes...
                // Por brevedad, incluyo estructura similar para meses 6-12

                // MES 6: SIGILO PERSONAL
                geometraGoal.phases["2026-07"] = {
                    objective: "El Sello Personal: DiseÃ±ar tu Sigilo MÃ¡gico",
                    notes: `ðŸŒŸ **EL SELLO PERSONAL (SIGILO)**

ðŸŽ¯ **OBJETIVO DEL MES**
DiseÃ±ar un sÃ­mbolo mÃ¡gico personal usando cÃ­rculos y proporciones geomÃ©tricas que represente tu intenciÃ³n mÃ¡s profunda.

âœ¨ **FUNDAMENTO DE SIGILOS**
Un sigilo es un sÃ­mbolo cargado con intenciÃ³n que actÃºa como puente entre tu consciente y subconsciente. La geometrÃ­a sagrada amplifica su poder.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ "Practical Sigil Magic" - Frater U.D.
â€¢ Chaos Magic y creaciÃ³n de sigilos
â€¢ GeometrÃ­a sagrada como contenedor
â€¢ MÃ©todos de activaciÃ³n y carga

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ CompÃ¡s y regla
â€¢ Papel de calidad
â€¢ Tinta permanente
â€¢ Cristales para cargar el sigilo`,
                    routine: {
                        1: [
                            { name: "MeditaciÃ³n (15min): Clarificar tu intenciÃ³n mÃ¡s profunda" },
                            { name: "DeclaraciÃ³n de intenciÃ³n (30min): Escribir y refinar" },
                            { name: "Estudio de sigilos (45min): Historia y mÃ©todos" },
                            { name: "Boceto inicial (15min): Primeras ideas visuales" },
                            { name: "Diario (5min): ReflexiÃ³n sobre intenciÃ³n" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n con geometrÃ­a (15min): Visualizar formas sagradas" },
                            { name: "MÃ©todo de letras (30min): Eliminar vocales y repetidas" },
                            { name: "Estudio de geometrÃ­a (45min): CÃ­rculos y proporciones" },
                            { name: "IntegraciÃ³n (15min): Combinar letras con geometrÃ­a" },
                            { name: "Diario (5min): EvoluciÃ³n del diseÃ±o" }
                        ],
                        3: [
                            { name: "MeditaciÃ³n creativa (15min): Dejar fluir la intuiciÃ³n" },
                            { name: "DiseÃ±o geomÃ©trico (30min): Crear base geomÃ©trica" },
                            { name: "Estudio de sÃ­mbolos (45min): SÃ­mbolos universales" },
                            { name: "Refinamiento (15min): Simplificar el diseÃ±o" },
                            { name: "Diario (5min): Significado de cada elemento" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n de poder (15min): Cargar tu intenciÃ³n" },
                            { name: "VersiÃ³n final (30min): Dibujar sigilo definitivo" },
                            { name: "Estudio de activaciÃ³n (45min): MÃ©todos de carga" },
                            { name: "PreparaciÃ³n (15min): Preparar ritual de activaciÃ³n" },
                            { name: "Diario (5min): Plan de activaciÃ³n" }
                        ],
                        5: [
                            { name: "MeditaciÃ³n profunda (15min): Entrar en trance ligero" },
                            { name: "Trazado final (30min): Tinta permanente" },
                            { name: "Estudio de mantenimiento (45min): Cuidado del sigilo" },
                            { name: "Pre-activaciÃ³n (15min): Cuenco sobre sigilo" },
                            { name: "Diario (5min): PreparaciÃ³n para ritual" }
                        ],
                        6: [
                            { name: "Ritual de activaciÃ³n (1h30min): Activar y cargar tu sigilo con todos los elementos" }
                        ],
                        0: [
                            { name: "IntegraciÃ³n (45min): Meditar con sigilo activado" },
                            { name: "PreparaciÃ³n (15min): Leer sobre scrying" }
                        ]
                    },
                    dayObjectives: {
                        1: "Clarificar intenciÃ³n profunda",
                        2: "Transformar palabras en sÃ­mbolos",
                        3: "Integrar geometrÃ­a sagrada",
                        4: "Perfeccionar el diseÃ±o",
                        5: "Preparar activaciÃ³n ritual"
                    }
                };

                // MES 7: SCRYING
                geometraGoal.phases["2026-08"] = {
                    objective: "Trimestre 3: El Espejo y la Sombra - Alquimia Interior",
                    notes: `ðŸªž **SCRYING (VISIÃ“N EN EL ESPEJO)**

ðŸŽ¯ **OBJETIVO DEL MES**
Usar el espejo de obsidiana para calmar la mente analÃ­tica y acceder a visiones intuitivas.

âœ¨ **FUNDAMENTO DE SCRYING**
El scrying es una tÃ©cnica ancestral de visiÃ³n que usa superficies reflectantes para acceder al subconsciente y recibir mensajes simbÃ³licos.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ Historia del scrying (Aztecas, Mayas, Dr. John Dee)
â€¢ TÃ©cnicas de mirada desenfocada
â€¢ InterpretaciÃ³n de sÃ­mbolos
â€¢ Estado de trance ligero

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ Espejo de obsidiana
â€¢ Vela (opcional)
â€¢ Espacio oscuro
â€¢ Diario para registrar visiones`,
                    routine: {
                        1: [
                            { name: "PreparaciÃ³n del espacio (10min): Oscurecer, limpiar energÃ­a" },
                            { name: "PrÃ¡ctica de mirada (15min): 5min mirando sin parpadear" },
                            { name: "Estudio teÃ³rico (45min): Historia del scrying" },
                            { name: "Limpieza del espejo (10min): Cuenco sobre obsidiana" },
                            { name: "Diario (5min): Primeras impresiones" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n de anclaje (10min): ProtecciÃ³n energÃ©tica" },
                            { name: "SesiÃ³n de scrying (20min): 10min de mirada" },
                            { name: "Estudio de tÃ©cnicas (45min): Mirada desenfocada" },
                            { name: "Registro (10min): Dibujar lo que viste" },
                            { name: "Diario (5min): SÃ­mbolos observados" }
                        ],
                        3: [
                            { name: "MeditaciÃ³n profunda (15min): Entrar en calma" },
                            { name: "Scrying con vela (20min): Vela detrÃ¡s del espejo" },
                            { name: "Estudio de sÃ­mbolos (45min): Diccionario de sÃ­mbolos" },
                            { name: "InterpretaciÃ³n (10min): Analizar visiones" },
                            { name: "Diario (5min): Significados posibles" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n con pregunta (15min): Formular pregunta clara" },
                            { name: "Scrying dirigido (20min): Buscar respuesta" },
                            { name: "Estudio de interpretaciÃ³n (45min): MÃ©todos de anÃ¡lisis" },
                            { name: "ReflexiÃ³n (10min): Conectar con la pregunta" },
                            { name: "Diario (5min): Respuestas recibidas" }
                        ],
                        5: [
                            { name: "MeditaciÃ³n de cierre (15min): Agradecer las visiones" },
                            { name: "SesiÃ³n extendida (20min): 15min de scrying" },
                            { name: "Estudio de integraciÃ³n (45min): Aplicar insights" },
                            { name: "SÃ­ntesis (10min): Revisar semana de visiones" },
                            { name: "Diario (5min): Patrones observados" }
                        ],
                        6: [
                            { name: "SesiÃ³n profunda (1h): 30min de scrying con registro detallado" },
                            { name: "AnÃ¡lisis (30min): Interpretar todas las visiones" }
                        ],
                        0: [
                            { name: "RevisiÃ³n mensual (45min): Compilar todas las visiones" },
                            { name: "PreparaciÃ³n (15min): Leer sobre Cubo de MetatrÃ³n" }
                        ]
                    },
                    dayObjectives: {
                        1: "Familiarizarse con el espejo",
                        2: "Desarrollar mirada desenfocada",
                        3: "Reconocer sÃ­mbolos",
                        4: "Hacer preguntas especÃ­ficas",
                        5: "Integrar mensajes recibidos"
                    }
                };

                // MES 8: CUBO DE METATRÃ“N
                geometraGoal.phases["2026-09"] = {
                    objective: "El Cubo de MetatrÃ³n: ProtecciÃ³n MÃ¡xima",
                    notes: `ðŸ”· **EL CUBO DE METATRÃ“N**

ðŸŽ¯ **OBJETIVO DEL MES**
Dibujar el Cubo de MetatrÃ³n, la figura que contiene todos los sÃ³lidos platÃ³nicos y representa la protecciÃ³n mÃ¡xima.

âœ¨ **FUNDAMENTO DEL CUBO**
El Cubo de MetatrÃ³n contiene los 5 sÃ³lidos platÃ³nicos (bloques de construcciÃ³n del universo) y representa el blueprint de toda la creaciÃ³n.

ðŸ“š **RECURSOS DE ESTUDIO**
â€¢ Los 5 sÃ³lidos platÃ³nicos
â€¢ La Flor de la Vida y el Cubo
â€¢ MetatrÃ³n como arcÃ¡ngel de la geometrÃ­a
â€¢ Usos de protecciÃ³n y meditaciÃ³n

ðŸ› ï¸ **HERRAMIENTAS NECESARIAS**
â€¢ CompÃ¡s de precisiÃ³n
â€¢ Regla larga
â€¢ Papel grande (40x40cm mÃ­nimo)
â€¢ LÃ¡pices de colores`,
                    routine: {
                        1: [
                            { name: "MeditaciÃ³n (15min): Visualizar el Cubo de MetatrÃ³n" },
                            { name: "Estudio de la Flor (30min): Dibujar Flor de la Vida" },
                            { name: "TeorÃ­a (45min): Historia del Cubo de MetatrÃ³n" },
                            { name: "Boceto inicial (15min): 13 cÃ­rculos base" },
                            { name: "Diario (5min): Complejidad observada" }
                        ],
                        2: [
                            { name: "MeditaciÃ³n geomÃ©trica (15min): CÃ­rculos perfectos" },
                            { name: "PrÃ¡ctica (30min): Conectar centros de cÃ­rculos" },
                            { name: "Estudio de sÃ³lidos (45min): Los 5 platÃ³nicos" },
                            { name: "IdentificaciÃ³n (15min): Encontrar sÃ³lidos en el Cubo" },
                            { name: "Diario (5min): SÃ³lidos encontrados" }
                        ],
                        3: [
                            { name: "MeditaciÃ³n de precisiÃ³n (15min): Enfoque total" },
                            { name: "Dibujo tÃ©cnico (30min): LÃ­neas perfectas" },
                            { name: "Estudio de proporciones (45min): Phi en el Cubo" },
                            { name: "VerificaciÃ³n (15min): Medir proporciones" },
                            { name: "Diario (5min): PrecisiÃ³n alcanzada" }
                        ],
                        4: [
                            { name: "MeditaciÃ³n con color (15min): Visualizar colores" },
                            { name: "AplicaciÃ³n de color (30min): Colorear sÃ³lidos" },
                            { name: "Estudio de chakras (45min): Colores y chakras" },
                            { name: "Correspondencias (15min): Asignar colores" },
                            { name: "Diario (5min): Significado de colores" }
                        ],
                        5: [
                            { name: "MeditaciÃ³n de protecciÃ³n (15min): Activar el Cubo" },
                            { name: "VersiÃ³n final (30min): Cubo maestro" },
                            { name: "Estudio de usos (45min): MeditaciÃ³n y protecciÃ³n" },
                            { name: "ActivaciÃ³n (15min): Cuenco sobre el Cubo" },
                            { name: "Diario (5min): SensaciÃ³n de protecciÃ³n" }
                        ],
                        6: [
                            { name: "Obra maestra (2h): Cubo de MetatrÃ³n grande con color y detalles" }
                        ],
                        0: [
                            { name: "MeditaciÃ³n profunda (1h): Meditar dentro del Cubo" },
                            { name: "PreparaciÃ³n: Leer sobre trabajo con la sombra" }
                        ]
                    },
                    dayObjectives: {
                        1: "Comprender la estructura base",
                        2: "Identificar sÃ³lidos platÃ³nicos",
                        3: "Lograr precisiÃ³n tÃ©cnica",
                        4: "Integrar color y significado",
                        5: "Activar para protecciÃ³n"
                    }
                };

                // MES 9-12: Estructura similar con contenido especÃ­fico
                // (Por brevedad del cÃ³digo, incluyo solo los objetivos)

                geometraGoal.phases["2026-10"] = {
                    objective: "InterpretaciÃ³n de Sombras: Integrar Scrying y Tarot",
                    notes: "Usar tarot para interpretar visiones del espejo de obsidiana...",
                    routine: { /* Similar estructura */ },
                    dayObjectives: { /* EspecÃ­ficos del mes */ }
                };

                geometraGoal.phases["2026-11"] = {
                    objective: "Trimestre 4: La MaestrÃ­a del VacÃ­o - El GeÃ³metra Sagrado",
                    notes: "SÃ³lidos PlatÃ³nicos y Elementos: Un sÃ³lido diferente cada semana...",
                    routine: { /* Similar estructura */ },
                    dayObjectives: { /* EspecÃ­ficos del mes */ }
                };

                geometraGoal.phases["2026-12"] = {
                    objective: "GeometrÃ­a en el Espejo: VisualizaciÃ³n Avanzada",
                    notes: "Proyectar figuras sagradas sobre la obsidiana...",
                    routine: { /* Similar estructura */ },
                    dayObjectives: { /* EspecÃ­ficos del mes */ }
                };

                geometraGoal.phases["2027-01"] = {
                    objective: "CreaciÃ³n del Mandala Maestro: IntegraciÃ³n Total",
                    notes: "Tu obra maestra que integra todo el aÃ±o de aprendizaje...",
                    routine: { /* Similar estructura */ },
                    dayObjectives: { /* EspecÃ­ficos del mes */ }
                };

                // Agregar al nivel Espiritual
                spiritualLevel.goals.push(geometraGoal);

                // Guardar
                Store.save();

                console.log('\nâœ… Â¡Rutina GeÃ³metra MÃ­stico agregada exitosamente!');
                console.log('ðŸ“Š Resumen:');
                console.log('   - Meta: GeÃ³metra MÃ­stico');
                console.log('   - Fases: 12 meses (Feb 2026 - Ene 2027)');
                console.log('   - Actividades: EspecÃ­ficas por mes y objetivo');
                console.log('   - ProgresiÃ³n: 4 trimestres de evoluciÃ³n espiritual');
                console.log('\nâœ… Rutina agregada exitosamente!');


                rutinasAgregadas = true;
            }

            // Agregar Ancestros y GuÃ­as si no existe
            if (spiritualLevel && !spiritualLevel.goals.find(g => g.id === 'goal_ancestros_guias')) {
                console.log('âž• Agregando Ancestros y GuÃ­as...');
                // Script para agregar la rutina "Ancestros y GuÃ­as" al nivel Espiritual
                // Ejecutar en la consola del navegador mientras index.html estÃ¡ abierto
                // VERSIÃ“N COMPLETA CON ACTIVIDADES PROFUNDAS Y ESPECÃFICAS


                console.log('ðŸ•¯ï¸ Agregando rutina Ancestros y GuÃ­as...\n');

                const data = Store.data;

                if (!data.levels || data.levels.length === 0) {
                    console.error('âŒ No hay niveles. Abre la app primero.');
                    return;
                }

                // Buscar nivel Espiritual
                const spiritualLevel = data.levels.find(l => l.name.toLowerCase().includes('espiritual'));

                if (!spiritualLevel) {
                    console.error('âŒ Nivel Espiritual no encontrado.');
                    console.log('ðŸ’¡ Crea un nivel llamado "Espiritual" primero en la app.');
                    return;
                }

                console.log(`âœ… Nivel Espiritual encontrado: "${spiritualLevel.name}"`);

                // Eliminar rutina si ya existe
                if (spiritualLevel.goals) {
                    const existing = spiritualLevel.goals.find(g => g.id === 'goal_ancestros_guias_2026');
                    if (existing) {
                        console.log('âš ï¸ Rutina ya existe. Actualizando...');
                        spiritualLevel.goals = spiritualLevel.goals.filter(g => g.id !== 'goal_ancestros_guias_2026');
                    }
                } else {
                    spiritualLevel.goals = [];
                }

                // Crear meta
                const ancestrosGoal = {
                    id: "goal_ancestros_guias_2026",
                    name: "Ancestros y GuÃ­as",
                    color: spiritualLevel.color || "purple",
                    phaseType: "monthly",
                    phases: {}
                };

                // Objetivos diarios base (se usan en todos los meses)
                const baseObjectives = {
                    1: "Abrir el canal con respeto",
                    2: "Escuchar sin juzgar",
                    3: "Registrar con claridad",
                    4: "Agradecer profundamente",
                    5: "Integrar en lo cotidiano"
                };

                // ==================== MES 1: ENRAIZAMIENTO Y PERMISO ====================
                ancestrosGoal.phases["2026-01"] = {
                    objective: "Enraizamiento y Permiso: Presentarte ante tu Linaje",
                    notes: `ðŸ•¯ï¸ **ENRAIZAMIENTO Y PERMISO**

ðŸŽ¯ **OBJETIVO DEL MES**
Que tu sistema nervioso y energÃ©tico se sienta seguro. AquÃ­ no "contactas", te presentas.

âœ¨ **FUNDAMENTO**
Antes de abrir canales espirituales, necesitas sentirte enraizado y seguro. Este mes es sobre crear las bases de confianza.

**ðŸ”¥ RITUAL MENSUAL: RITUAL DE PERMISO**
Una vez este mes (elige un dÃ­a especial):
â€¢ Vela blanca + agua + tierra (sal o tierra real)
â€¢ Di en voz alta: "Reconozco mi origen y me reconozco a mÃ­"
â€¢ Permanece en silencio 10 minutos sintiendo tu conexiÃ³n

ðŸ“š **RECURSOS**
â€¢ Crear tu espacio sagrado (altar)
â€¢ Fotos de ancestros si las tienes
â€¢ Elementos naturales (agua, tierra, fuego, aire)

ðŸ› ï¸ **HERRAMIENTAS**
â€¢ Vela blanca
â€¢ Agua en recipiente
â€¢ Sal o tierra
â€¢ Cuaderno exclusivo para este trabajo
â€¢ Incienso (opcional)`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): RespiraciÃ³n lenta + 'Me presento ante mi linaje'" },
                            { name: "MeditaciÃ³n de enraizamiento (15min): Visualizar raÃ­ces profundas" },
                            { name: "Preparar altar (10min): Limpiar espacio, colocar elementos" },
                            { name: "Registro (5min): Sensaciones en el cuerpo" },
                            { name: "Cierre (2min): 'Gracias. Todo queda en su lugar'" }
                        ],
                        2: [
                            { name: "Apertura (3min): RespiraciÃ³n + 'Pido permiso para acercarme'" },
                            { name: "PrÃ¡ctica de presencia (15min): Sentarte frente al altar en silencio" },
                            { name: "AÃ±adir al altar (10min): Agua fresca, una flor" },
                            { name: "Registro (5min): Emociones que surgen" },
                            { name: "Cierre (2min): Agradecer la presencia" }
                        ],
                        3: [
                            { name: "Apertura (3min): RespiraciÃ³n + 'Estoy aquÃ­, presente'" },
                            { name: "MeditaciÃ³n de seguridad (15min): Sentir protecciÃ³n ancestral" },
                            { name: "Encender vela (10min): Observar la llama en silencio" },
                            { name: "Registro (5min): ImÃ¡genes o palabras que llegan" },
                            { name: "Cierre (2min): Apagar vela con gratitud" }
                        ],
                        4: [
                            { name: "Apertura (3min): RespiraciÃ³n + 'Mi sistema estÃ¡ seguro'" },
                            { name: "PrÃ¡ctica corporal (15min): Sentir dÃ³nde vive el linaje en ti" },
                            { name: "Ofrenda simple (10min): Colocar algo significativo" },
                            { name: "Registro (5min): Sensaciones fÃ­sicas" },
                            { name: "Cierre (2min): Cerrar el espacio con amor" }
                        ],
                        5: [
                            { name: "Apertura (3min): RespiraciÃ³n + 'ConfÃ­o en este proceso'" },
                            { name: "MeditaciÃ³n de integraciÃ³n (15min): Sentir tu lugar en el linaje" },
                            { name: "Revisar altar (10min): Observar quÃ© ha cambiado" },
                            { name: "Registro (5min): SÃ­ntesis de la semana" },
                            { name: "Cierre (2min): Gratitud profunda" }
                        ],
                        6: [
                            { name: "PrÃ¡ctica extendida (45min): Crear o perfeccionar tu altar personal" },
                            { name: "MeditaciÃ³n profunda (15min): Presentarte formalmente" }
                        ],
                        0: [
                            { name: "RevisiÃ³n semanal (30min): Leer todos tus registros" },
                            { name: "PreparaciÃ³n (30min): Investigar sobre tu linaje familiar" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                // ==================== MES 2: RECONOCER EL LINAJE ====================
                ancestrosGoal.phases["2026-02"] = {
                    objective: "Reconocer el Linaje: Sentir de DÃ³nde Vienes",
                    notes: `ðŸ§¬ **RECONOCER EL LINAJE**

ðŸŽ¯ **OBJETIVO DEL MES**
Sentir de dÃ³nde vienes mÃ¡s allÃ¡ de la mente. No sanar aÃºn. Solo mirar.

âœ¨ **FUNDAMENTO**
Conocer tu linaje no es solo nombres y fechas. Es sentir las historias, los patrones, las fortalezas heredadas.

**ðŸ”¥ RITUAL MENSUAL: ÃRBOL GENEALÃ“GICO ENERGÃ‰TICO**
â€¢ Dibuja tu Ã¡rbol genealÃ³gico (hasta donde sepas)
â€¢ Medita con cada nombre
â€¢ Siente quÃ© emociones trae cada uno
â€¢ No juzgues, solo observa

ðŸ“š **RECURSOS**
â€¢ Historias familiares
â€¢ Fotos antiguas
â€¢ Objetos heredados
â€¢ Conversaciones con familiares mayores

ðŸ› ï¸ **HERRAMIENTAS**
â€¢ Papel grande para Ã¡rbol genealÃ³gico
â€¢ Fotos de ancestros
â€¢ Velas de colores
â€¢ Tu cuaderno sagrado`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Honro a quienes vinieron antes'" },
                            { name: "MeditaciÃ³n con foto (15min): Elegir un ancestro, mirarlo" },
                            { name: "InvestigaciÃ³n (10min): Escribir lo que sabes de esa persona" },
                            { name: "Registro (5min): QuÃ© sientes al pensar en Ã©l/ella" },
                            { name: "Cierre (2min): Agradecer su vida" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Recibo las historias con amor'" },
                            { name: "VisualizaciÃ³n de linaje (15min): Ver la cadena de ancestros" },
                            { name: "Escribir historias (10min): Una anÃ©cdota familiar" },
                            { name: "Registro (5min): Patrones que observas" },
                            { name: "Cierre (2min): Honrar las historias" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Soy parte de algo mÃ¡s grande'" },
                            { name: "MeditaciÃ³n de linaje materno (15min): LÃ­nea de mujeres" },
                            { name: "Ofrenda (10min): Algo que honre lo femenino" },
                            { name: "Registro (5min): Fortalezas heredadas" },
                            { name: "Cierre (2min): Gratitud a las madres" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Honro la fuerza de mis ancestros'" },
                            { name: "MeditaciÃ³n de linaje paterno (15min): LÃ­nea de hombres" },
                            { name: "Ofrenda (10min): Algo que honre lo masculino" },
                            { name: "Registro (5min): Dones recibidos" },
                            { name: "Cierre (2min): Gratitud a los padres" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Integro ambas lÃ­neas en mÃ­'" },
                            { name: "MeditaciÃ³n de uniÃ³n (15min): Ambos linajes en ti" },
                            { name: "SÃ­ntesis (10min): Dibujar tu lugar en el Ã¡rbol" },
                            { name: "Registro (5min): CÃ³mo te sientes siendo tÃº" },
                            { name: "Cierre (2min): Celebrar tu existencia" }
                        ],
                        6: [
                            { name: "Proyecto especial (1h): Crear Ã¡rbol genealÃ³gico energÃ©tico completo" }
                        ],
                        0: [
                            { name: "RevisiÃ³n (45min): Contemplar todo lo descubierto" },
                            { name: "PreparaciÃ³n: Leer sobre altares vivos" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                // ==================== MES 3: ALTAR VIVO ====================
                ancestrosGoal.phases["2026-03"] = {
                    objective: "Altar Vivo: RelaciÃ³n Cotidiana, No Ritualizada",
                    notes: `ðŸŒ¿ **ALTAR VIVO**

ðŸŽ¯ **OBJETIVO DEL MES**
Que la relaciÃ³n sea cotidiana, no ritualizada en exceso. El altar se vuelve parte de tu vida diaria.

âœ¨ **FUNDAMENTO**
Un altar vivo cambia, respira, evoluciona contigo. No es un museo, es un espacio de diÃ¡logo constante.

**ðŸ”¥ RITUAL MENSUAL: RENOVACIÃ“N DEL ALTAR**
â€¢ Limpia completamente tu altar
â€¢ Cambia todos los elementos
â€¢ AÃ±ade algo nuevo que represente quiÃ©n eres HOY
â€¢ Pasa 30min en contemplaciÃ³n

ðŸ“š **RECURSOS**
â€¢ Elementos naturales frescos
â€¢ Objetos personales significativos
â€¢ Agua, flores, frutas
â€¢ Incienso o hierbas

ðŸ› ï¸ **HERRAMIENTAS**
â€¢ Elementos cambiantes (flores frescas semanales)
â€¢ Agua que renuevas diariamente
â€¢ Velas de diferentes colores
â€¢ Objetos rotativos`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Buenos dÃ­as, ancestros'" },
                            { name: "PrÃ¡ctica matutina (10min): Saludar al altar al despertar" },
                            { name: "Cambiar agua (5min): Agua fresca con intenciÃ³n" },
                            { name: "ConversaciÃ³n simple (10min): Contar tu dÃ­a" },
                            { name: "Registro (5min): Respuestas sutiles" },
                            { name: "Cierre (2min): 'Gracias por escuchar'" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Los invito a mi dÃ­a'" },
                            { name: "Ofrenda cotidiana (15min): CafÃ©, tÃ© o comida" },
                            { name: "Momento de escucha (10min): Silencio receptivo" },
                            { name: "Registro (5min): Sensaciones, no palabras" },
                            { name: "Cierre (2min): Compartir la ofrenda (comerla/beberla)" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Camino con ustedes'" },
                            { name: "PrÃ¡ctica de presencia (15min): Estar sin pedir nada" },
                            { name: "AÃ±adir elemento (10min): Algo de la naturaleza" },
                            { name: "Registro (5min): Cambios en el altar" },
                            { name: "Cierre (2min): Observar quÃ© se transforma" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Gracias por estar'" },
                            { name: "Limpieza consciente (15min): Limpiar altar con amor" },
                            { name: "Reorganizar (10min): Cambiar disposiciÃ³n intuitivamente" },
                            { name: "Registro (5min): Por quÃ© moviste cada cosa" },
                            { name: "Cierre (2min): Apreciar el nuevo orden" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Celebro esta conexiÃ³n'" },
                            { name: "PrÃ¡ctica de gratitud (15min): Agradecer cada elemento" },
                            { name: "Ofrenda especial (10min): Algo hecho por ti" },
                            { name: "Registro (5min): CÃ³mo ha cambiado tu relaciÃ³n" },
                            { name: "Cierre (2min): Compromiso de continuidad" }
                        ],
                        6: [
                            { name: "RenovaciÃ³n completa (1h30min): Transformar completamente el altar" }
                        ],
                        0: [
                            { name: "ContemplaciÃ³n (1h): Meditar frente al altar renovado" },
                            { name: "PreparaciÃ³n: Leer sobre sanaciÃ³n de linaje" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                // ==================== MES 4: SANACIÃ“N SUAVE DEL LINAJE ====================
                ancestrosGoal.phases["2026-04"] = {
                    objective: "SanaciÃ³n Suave del Linaje: Soltar Cargas Heredadas",
                    notes: `ðŸ’§ **SANACIÃ“N SUAVE DEL LINAJE**

ðŸŽ¯ **OBJETIVO DEL MES**
Empezar a soltar cargas que no son tuyas. Con suavidad, sin forzar.

âœ¨ **FUNDAMENTO**
Heredamos no solo genes, sino tambiÃ©n traumas, miedos, patrones. Puedes honrar a tus ancestros Y soltar lo que no te sirve.

**ðŸ”¥ RITUAL MENSUAL: RITUAL DE DEVOLUCIÃ“N**
â€¢ Escribe en papel lo que cargas que no es tuyo
â€¢ Lee cada cosa en voz alta
â€¢ Di: "Esto no es mÃ­o. Lo devuelvo con amor"
â€¢ Quema el papel o entrÃ©galo al agua corriente

ðŸ“š **RECURSOS**
â€¢ ComprensiÃ³n de trauma generacional
â€¢ TÃ©cnicas de liberaciÃ³n emocional
â€¢ PerdÃ³n consciente
â€¢ CompasiÃ³n hacia el linaje

ðŸ› ï¸ **HERRAMIENTAS**
â€¢ Papel y pluma
â€¢ Agua corriente o fuego seguro
â€¢ Vela blanca
â€¢ Sal para limpiar energÃ­a`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Libero con amor'" },
                            { name: "IdentificaciÃ³n (15min): QuÃ© cargas que no es tuyo" },
                            { name: "Escritura (10min): Lista de cargas heredadas" },
                            { name: "Registro (5min): CÃ³mo se siente en el cuerpo" },
                            { name: "Cierre (2min): 'Hoy libero lo que no me pertenece'" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Honro el dolor de mis ancestros'" },
                            { name: "MeditaciÃ³n de compasiÃ³n (15min): Hacia quienes sufrieron" },
                            { name: "PerdÃ³n (10min): Perdonar sin olvidar" },
                            { name: "Registro (5min): Emociones que surgen" },
                            { name: "Cierre (2min): 'Rompo el ciclo con amor'" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Elijo mi propio camino'" },
                            { name: "VisualizaciÃ³n (15min): Cortar cordones energÃ©ticos" },
                            { name: "AfirmaciÃ³n (10min): 'Soy libre de elegir'" },
                            { name: "Registro (5min): SensaciÃ³n de liberaciÃ³n" },
                            { name: "Cierre (2min): Agradecer la libertad" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Transformo el dolor en sabidurÃ­a'" },
                            { name: "Alquimia emocional (15min): TransmutaciÃ³n consciente" },
                            { name: "Ofrenda de sanaciÃ³n (10min): Por los que sufrieron" },
                            { name: "Registro (5min): QuÃ© ha cambiado" },
                            { name: "Cierre (2min): 'El ciclo se sana en mÃ­'" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Soy el cambio en mi linaje'" },
                            { name: "IntegraciÃ³n (15min): Sentir la nueva ligereza" },
                            { name: "Gratitud profunda (10min): A quienes hicieron posible tu vida" },
                            { name: "Registro (5min): SÃ­ntesis de liberaciÃ³n" },
                            { name: "Cierre (2min): Celebrar tu valentÃ­a" }
                        ],
                        6: [
                            { name: "Ritual de devoluciÃ³n (2h): Ceremonia completa de liberaciÃ³n" }
                        ],
                        0: [
                            { name: "Descanso (1h): IntegraciÃ³n suave, sin forzar" },
                            { name: "PreparaciÃ³n: Leer sobre mensajes del cuerpo" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                // ContinÃºa con los meses restantes (5-12)...
                // Por claridad, incluyo estructura completa

                // ==================== MES 5: MENSAJES DEL CUERPO ====================
                ancestrosGoal.phases["2026-05"] = {
                    objective: "Mensajes del Cuerpo: CÃ³mo te Hablan tus Ancestros",
                    notes: `ðŸª¶ **MENSAJES DEL CUERPO**

ðŸŽ¯ **OBJETIVO DEL MES**
Aprender cÃ³mo te hablan tus ancestros: sensaciones, no voces.

âœ¨ **FUNDAMENTO**
Los ancestros hablan a travÃ©s del cuerpo: escalofrÃ­os, calor, presiÃ³n, expansiÃ³n. Aprende su lenguaje.

**ðŸ”¥ RITUAL MENSUAL: MAPEO CORPORAL**
â€¢ AcuÃ©state cÃ³modamente
â€¢ Escanea todo tu cuerpo
â€¢ Marca en un dibujo dÃ³nde sientes a tus ancestros
â€¢ Cada zona tiene un mensaje

ðŸ“š **RECURSOS**
â€¢ SomÃ¡tica y espiritualidad
â€¢ Escucha corporal profunda
â€¢ InterpretaciÃ³n de sensaciones
â€¢ Diario corporal

ðŸ› ï¸ **HERRAMIENTAS**
â€¢ Dibujo del cuerpo humano
â€¢ Colores para marcar zonas
â€¢ Espacio cÃ³modo para acostarte
â€¢ Silencio profundo`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Mi cuerpo es un templo sagrado'" },
                            { name: "Escaneo corporal (15min): De pies a cabeza" },
                            { name: "Identificar sensaciones (10min): DÃ³nde sientes presencia" },
                            { name: "Registro (5min): Mapa de sensaciones" },
                            { name: "Cierre (2min): Agradecer al cuerpo" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Escucho lo que mi cuerpo dice'" },
                            { name: "PrÃ¡ctica de sensibilidad (15min): Afinar percepciÃ³n" },
                            { name: "DiÃ¡logo corporal (10min): Preguntar al cuerpo" },
                            { name: "Registro (5min): Respuestas recibidas" },
                            { name: "Cierre (2min): Honrar la sabidurÃ­a corporal" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Mi cuerpo conoce el camino'" },
                            { name: "Movimiento intuitivo (15min): Dejar que el cuerpo se mueva" },
                            { name: "ObservaciÃ³n (10min): QuÃ© movimientos surgen" },
                            { name: "Registro (5min): Mensajes en el movimiento" },
                            { name: "Cierre (2min): Integrar el movimiento" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'ConfÃ­o en las seÃ±ales'" },
                            { name: "PrÃ¡ctica de discernimiento (15min): Diferenciar sensaciones" },
                            { name: "InterpretaciÃ³n (10min): QuÃ© significa cada sensaciÃ³n" },
                            { name: "Registro (5min): Diccionario personal de seÃ±ales" },
                            { name: "Cierre (2min): Gratitud por la claridad" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Soy un canal claro'" },
                            { name: "IntegraciÃ³n (15min): Unir mente-cuerpo-espÃ­ritu" },
                            { name: "SÃ­ntesis (10min): Revisar todos los mapas" },
                            { name: "Registro (5min): Patrones descubiertos" },
                            { name: "Cierre (2min): Celebrar la conexiÃ³n" }
                        ],
                        6: [
                            { name: "Mapeo completo (2h): Crear mapa corporal detallado de conexiÃ³n ancestral" }
                        ],
                        0: [
                            { name: "RevisiÃ³n (1h): Estudiar tu mapa y sus mensajes" },
                            { name: "PreparaciÃ³n: Leer sobre guÃ­as espirituales" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                // MES 6-12: Estructura completa
                // (Incluyo versiÃ³n resumida para mantener el archivo manejable)

                ancestrosGoal.phases["2026-06"] = {
                    objective: "Encuentro con GuÃ­as: Diferenciar Ancestros vs GuÃ­as",
                    notes: `ðŸ”¥ **ENCUENTRO CON GUÃAS**

ðŸŽ¯ **OBJETIVO**: Diferenciar ancestros (tu linaje) de guÃ­as espirituales (seres de luz que te acompaÃ±an).

**ðŸ”¥ RITUAL MENSUAL: INVOCACIÃ“N DE GUÃAS**
â€¢ MeditaciÃ³n profunda
â€¢ Pregunta: "Â¿QuiÃ©n me guÃ­a?"
â€¢ Escucha sin expectativas
â€¢ Registra nombres, sensaciones, sÃ­mbolos`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Invito a mis guÃ­as'" },
                            { name: "MeditaciÃ³n de apertura (15min): Crear espacio para guÃ­as" },
                            { name: "Escucha (10min): Silencio receptivo" },
                            { name: "Registro (5min): Primeras impresiones" },
                            { name: "Cierre (2min): Agradecer la presencia" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Â¿QuiÃ©n camina conmigo?'" },
                            { name: "VisualizaciÃ³n (15min): Ver a tus guÃ­as" },
                            { name: "DiÃ¡logo (10min): Hacer preguntas" },
                            { name: "Registro (5min): Respuestas recibidas" },
                            { name: "Cierre (2min): Gratitud" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Reconozco tu luz'" },
                            { name: "PrÃ¡ctica de discernimiento (15min): Ancestros vs guÃ­as" },
                            { name: "ClarificaciÃ³n (10min): QuiÃ©n es quiÃ©n" },
                            { name: "Registro (5min): Diferencias notadas" },
                            { name: "Cierre (2min): Honrar a ambos" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Pido guÃ­a clara'" },
                            { name: "MeditaciÃ³n con guÃ­a (15min): Conectar con uno especÃ­fico" },
                            { name: "Recibir mensaje (10min): Escuchar su sabidurÃ­a" },
                            { name: "Registro (5min): Mensaje recibido" },
                            { name: "Cierre (2min): Aplicar la guÃ­a" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Integro ambas presencias'" },
                            { name: "SÃ­ntesis (15min): Ancestros Y guÃ­as juntos" },
                            { name: "Gratitud doble (10min): A linaje y a guÃ­as" },
                            { name: "Registro (5min): CÃ³mo trabajan juntos" },
                            { name: "Cierre (2min): Celebrar el equipo" }
                        ],
                        6: [{ name: "Ritual de invocaciÃ³n (2h): Ceremonia formal con guÃ­as" }],
                        0: [
                            { name: "RevisiÃ³n (1h): Conocer a cada guÃ­a" },
                            { name: "PreparaciÃ³n: Leer sobre sueÃ±os lÃºcidos" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                ancestrosGoal.phases["2026-07"] = {
                    objective: "SueÃ±os y Viaje Interior: Abrir el Canal OnÃ­rico",
                    notes: `ðŸŒ™ **SUEÃ‘OS Y VIAJE INTERIOR**

ðŸŽ¯ **OBJETIVO**: Recibir mensajes a travÃ©s de los sueÃ±os.

**ðŸ”¥ RITUAL MENSUAL: RITUAL DE SUEÃ‘OS**
â€¢ Antes de dormir: "MuÃ©strenme solo lo que puedo comprender"
â€¢ Vaso de agua junto a la cama
â€¢ Diario de sueÃ±os al despertar`,
                    routine: {
                        1: [
                            { name: "PreparaciÃ³n nocturna (5min): Limpiar energÃ­a antes de dormir" },
                            { name: "InvocaciÃ³n (3min): Pedir sueÃ±os claros" },
                            { name: "Registro matutino (20min): Escribir sueÃ±os al despertar" },
                            { name: "InterpretaciÃ³n (10min): SÃ­mbolos y mensajes" },
                            { name: "Cierre (2min): Agradecer los sueÃ±os" }
                        ],
                        2: [
                            { name: "PreparaciÃ³n (5min): Vaso de agua + intenciÃ³n" },
                            { name: "MeditaciÃ³n pre-sueÃ±o (10min): RelajaciÃ³n profunda" },
                            { name: "Registro matutino (20min): Detalles de sueÃ±os" },
                            { name: "AnÃ¡lisis (10min): Patrones recurrentes" },
                            { name: "Cierre (2min): Integrar mensajes" }
                        ],
                        3: [
                            { name: "PreparaciÃ³n (5min): Limpiar espacio de dormir" },
                            { name: "Pregunta especÃ­fica (5min): Pedir guÃ­a sobre algo" },
                            { name: "Registro matutino (20min): Respuestas en sueÃ±os" },
                            { name: "ConexiÃ³n (10min): Relacionar con vida diurna" },
                            { name: "Cierre (2min): Aplicar la guÃ­a" }
                        ],
                        4: [
                            { name: "PreparaciÃ³n (5min): Incienso o hierbas" },
                            { name: "InvocaciÃ³n a ancestros (5min): Pedirles que visiten" },
                            { name: "Registro matutino (20min): Visitas nocturnas" },
                            { name: "Gratitud (10min): A quienes vinieron" },
                            { name: "Cierre (2min): Honrar el encuentro" }
                        ],
                        5: [
                            { name: "PreparaciÃ³n (5min): Ritual completo pre-sueÃ±o" },
                            { name: "Apertura total (5min): Recibir lo que venga" },
                            { name: "Registro matutino (20min): SÃ­ntesis semanal" },
                            { name: "InterpretaciÃ³n profunda (10min): Mensajes clave" },
                            { name: "Cierre (2min): Integrar sabidurÃ­a onÃ­rica" }
                        ],
                        6: [{ name: "Noche especial (toda la noche): Ritual de sueÃ±os + registro extenso" }],
                        0: [
                            { name: "RevisiÃ³n (1h): Leer todos los sueÃ±os del mes" },
                            { name: "PreparaciÃ³n: Leer sobre sincronicidades" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                ancestrosGoal.phases["2026-08"] = {
                    objective: "SeÃ±ales y SincronÃ­as: Lenguaje SimbÃ³lico Cotidiano",
                    notes: `ðŸŒ¬ï¸ **SEÃ‘ALES Y SINCRONÃAS**

ðŸŽ¯ **OBJETIVO**: Reconocer el lenguaje simbÃ³lico en lo cotidiano.

**ðŸ”¥ RITUAL MENSUAL: DIARIO DE SEÃ‘ALES**
â€¢ Registra TODAS las sincronicidades del mes
â€¢ Al final, busca patrones
â€¢ Agradece cada seÃ±al`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Estoy atenta a las seÃ±ales'" },
                            { name: "ObservaciÃ³n consciente (15min): Caminar con atenciÃ³n" },
                            { name: "Registro de seÃ±ales (10min): QuÃ© notaste hoy" },
                            { name: "InterpretaciÃ³n (5min): Posibles significados" },
                            { name: "Cierre (2min): Agradecer la guÃ­a" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Todo tiene significado'" },
                            { name: "PrÃ¡ctica de sincronicidad (15min): Buscar patrones" },
                            { name: "DocumentaciÃ³n (10min): NÃºmeros, animales, palabras" },
                            { name: "ConexiÃ³n (5min): CÃ³mo se relaciona contigo" },
                            { name: "Cierre (2min): Confiar en el universo" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Recibo los mensajes'" },
                            { name: "MeditaciÃ³n de apertura (15min): Pedir seÃ±ales claras" },
                            { name: "ObservaciÃ³n activa (10min): Salir y observar" },
                            { name: "Registro inmediato (5min): Anotar al momento" },
                            { name: "Cierre (2min): Validar las seÃ±ales" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'ConfÃ­o en lo sutil'" },
                            { name: "PrÃ¡ctica de discernimiento (15min): SeÃ±al vs coincidencia" },
                            { name: "AnÃ¡lisis (10min): QuÃ© es realmente mensaje" },
                            { name: "Registro (5min): Criterios personales" },
                            { name: "Cierre (2min): Afinar la percepciÃ³n" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Soy parte del tejido'" },
                            { name: "SÃ­ntesis semanal (15min): Todas las seÃ±ales juntas" },
                            { name: "PatrÃ³n general (10min): QuÃ© te estÃ¡n diciendo" },
                            { name: "Registro (5min): Mensaje principal" },
                            { name: "Cierre (2min): Actuar segÃºn la guÃ­a" }
                        ],
                        6: [{ name: "RevisiÃ³n profunda (2h): Analizar todas las seÃ±ales del mes" }],
                        0: [
                            { name: "ContemplaciÃ³n (1h): Agradecer cada sincronicidad" },
                            { name: "PreparaciÃ³n: Leer sobre linaje femenino" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                ancestrosGoal.phases["2026-09"] = {
                    objective: "SabidurÃ­a del Linaje Femenino: Honrar la LÃ­nea Materna",
                    notes: `ðŸŒ€ **SABIDURÃA DEL LINAJE FEMENINO**

ðŸŽ¯ **OBJETIVO**: Conectar profundamente con la lÃ­nea de mujeres de tu familia.

**ðŸ”¥ RITUAL MENSUAL: CÃRCULO DE MUJERES**
â€¢ Medita con todas las mujeres de tu linaje
â€¢ VisualÃ­zalas en cÃ­rculo contigo
â€¢ Recibe su sabidurÃ­a colectiva`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Honro a las madres'" },
                            { name: "MeditaciÃ³n con tu madre (15min): Conectar con ella" },
                            { name: "Gratitud (10min): Por lo que te dio" },
                            { name: "Registro (5min): Dones recibidos" },
                            { name: "Cierre (2min): Bendecir la relaciÃ³n" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Honro a las abuelas'" },
                            { name: "MeditaciÃ³n con abuelas (15min): Ambas lÃ­neas" },
                            { name: "Escucha (10min): Su sabidurÃ­a" },
                            { name: "Registro (5min): Mensajes recibidos" },
                            { name: "Cierre (2min): Agradecer su fuerza" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Honro a las bisabuelas'" },
                            { name: "VisualizaciÃ³n profunda (15min): Retroceder generaciones" },
                            { name: "ConexiÃ³n (10min): Sentir su presencia" },
                            { name: "Registro (5min): Historias que llegan" },
                            { name: "Cierre (2min): Honrar su legado" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Soy hija de todas ellas'" },
                            { name: "CÃ­rculo de mujeres (15min): Todas juntas" },
                            { name: "Recibir sabidurÃ­a (10min): Escuchar al cÃ­rculo" },
                            { name: "Registro (5min): EnseÃ±anzas colectivas" },
                            { name: "Cierre (2min): Integrar la fuerza femenina" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'ContinÃºo el linaje'" },
                            { name: "MeditaciÃ³n de integraciÃ³n (15min): TÃº en la cadena" },
                            { name: "Compromiso (10min): QuÃ© honrarÃ¡s de ellas" },
                            { name: "Registro (5min): Tu legado para las que vienen" },
                            { name: "Cierre (2min): Celebrar la feminidad sagrada" }
                        ],
                        6: [{ name: "Ritual del cÃ­rculo (2h): Ceremonia con todas las mujeres de tu linaje" }],
                        0: [
                            { name: "Ofrenda especial (1h): A todas las madres" },
                            { name: "PreparaciÃ³n: Leer sobre integraciÃ³n prÃ¡ctica" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                ancestrosGoal.phases["2026-10"] = {
                    objective: "IntegraciÃ³n en la Vida Diaria: De lo Espiritual a lo Concreto",
                    notes: `ðŸš **INTEGRACIÃ“N EN LA VIDA DIARIA**

ðŸŽ¯ **OBJETIVO**: Bajar lo espiritual a decisiones concretas.

**ðŸ”¥ RITUAL MENSUAL: CONSEJO ANCESTRAL**
â€¢ Antes de una decisiÃ³n importante
â€¢ Pregunta a tus ancestros y guÃ­as
â€¢ ActÃºa segÃºn la guÃ­a recibida`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Aplico la sabidurÃ­a'" },
                            { name: "DecisiÃ³n del dÃ­a (15min): Consultar antes de decidir" },
                            { name: "AcciÃ³n guiada (10min): Hacer segÃºn la guÃ­a" },
                            { name: "Registro (5min): Resultado de seguir la guÃ­a" },
                            { name: "Cierre (2min): Agradecer la claridad" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Vivo mi espiritualidad'" },
                            { name: "PrÃ¡ctica en lo cotidiano (15min): Llevar altar al trabajo" },
                            { name: "Micro-rituales (10min): PequeÃ±os actos sagrados" },
                            { name: "Registro (5min): CÃ³mo cambia tu dÃ­a" },
                            { name: "Cierre (2min): Integrar lo sagrado" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Soy canal en el mundo'" },
                            { name: "Servicio guiado (15min): Ayudar segÃºn guÃ­a" },
                            { name: "AcciÃ³n compasiva (10min): Hacer el bien" },
                            { name: "Registro (5min): Impacto de tus acciones" },
                            { name: "Cierre (2min): Ser instrumento" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'ConfÃ­o en la guÃ­a'" },
                            { name: "DecisiÃ³n importante (15min): Consulta profunda" },
                            { name: "Claridad (10min): Recibir respuesta clara" },
                            { name: "Registro (5min): QuÃ© harÃ¡s" },
                            { name: "Cierre (2min): Comprometerte a actuar" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Integro todo'" },
                            { name: "SÃ­ntesis (15min): CÃ³mo ha cambiado tu vida" },
                            { name: "Gratitud profunda (10min): Por la transformaciÃ³n" },
                            { name: "Registro (5min): Cambios concretos" },
                            { name: "Cierre (2min): Celebrar la integraciÃ³n" }
                        ],
                        6: [{ name: "PrÃ¡ctica intensiva (2h): DÃ­a completo guiado por ancestros" }],
                        0: [
                            { name: "RevisiÃ³n (1h): Decisiones tomadas con guÃ­a" },
                            { name: "PreparaciÃ³n: Planear ofrenda especial" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                ancestrosGoal.phases["2026-11"] = {
                    objective: "Honra y Ofrenda: Devolver al Linaje lo Recibido",
                    notes: `ðŸ•Šï¸ **HONRA Y OFRENDA**

ðŸŽ¯ **OBJETIVO**: Devolver al linaje lo que has recibido.

**ðŸ”¥ RITUAL MENSUAL: OFRENDA CONSCIENTE**
â€¢ Prepara comida especial
â€¢ Comparte con tu altar
â€¢ Come conscientemente honrando a tus ancestros
â€¢ Dona o comparte con otros`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Devuelvo con amor'" },
                            { name: "Preparar ofrenda (20min): Cocinar o crear algo" },
                            { name: "PresentaciÃ³n (10min): Colocar en altar" },
                            { name: "Registro (5min): IntenciÃ³n de la ofrenda" },
                            { name: "Cierre (2min): Compartir la ofrenda" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Honro con acciones'" },
                            { name: "Servicio en su nombre (20min): Hacer algo por otros" },
                            { name: "DedicaciÃ³n (10min): Ofrecer el acto" },
                            { name: "Registro (5min): CÃ³mo honras su memoria" },
                            { name: "Cierre (2min): Continuar su legado" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Celebro su vida'" },
                            { name: "Ritual de celebraciÃ³n (20min): MÃºsica, danza, alegrÃ­a" },
                            { name: "Gratitud activa (10min): Expresar jÃºbilo" },
                            { name: "Registro (5min): QuÃ© celebras" },
                            { name: "Cierre (2min): Mantener viva la memoria" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Comparto su sabidurÃ­a'" },
                            { name: "EnseÃ±ar (20min): Compartir lo aprendido" },
                            { name: "TransmisiÃ³n (10min): Pasar el conocimiento" },
                            { name: "Registro (5min): A quiÃ©n enseÃ±aste" },
                            { name: "Cierre (2min): Ser puente generacional" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Soy su legado vivo'" },
                            { name: "IntegraciÃ³n total (20min): Vivir sus valores" },
                            { name: "Compromiso (10min): QuÃ© continuarÃ¡s" },
                            { name: "Registro (5min): Tu promesa al linaje" },
                            { name: "Cierre (2min): Sellar el compromiso" }
                        ],
                        6: [{ name: "Ofrenda especial (3h): Ceremonia completa de honra y gratitud" }],
                        0: [
                            { name: "CelebraciÃ³n (2h): DÃ­a de los ancestros personal" },
                            { name: "PreparaciÃ³n: Planear cierre del aÃ±o" }
                        ]
                    },
                    dayObjectives: baseObjectives
                };

                ancestrosGoal.phases["2026-12"] = {
                    objective: "Cierre, AutonomÃ­a y Legado: Encarnar la SabidurÃ­a",
                    notes: `ðŸŒ‘ **CIERRE, AUTONOMÃA Y LEGADO**

ðŸŽ¯ **OBJETIVO**: No depender del ritual, sino encarnarlo. Convertirte en ancestro consciente.

**ðŸ”¥ RITUAL MENSUAL: SÃNTESIS Y OFRENDA DE CIERRE**
â€¢ Revisar todo el aÃ±o
â€¢ Agradecer cada enseÃ±anza
â€¢ Comprometerte con tu propio legado
â€¢ Cerrar el ciclo con ceremonia`,
                    routine: {
                        1: [
                            { name: "Apertura (3min): 'Reviso mi camino'" },
                            { name: "RevisiÃ³n mensual (20min): Leer diario de cada mes" },
                            { name: "SÃ­ntesis (10min): Aprendizajes clave" },
                            { name: "Registro (5min): Transformaciones" },
                            { name: "Cierre (2min): Gratitud por el viaje" }
                        ],
                        2: [
                            { name: "Apertura (3min): 'Integro la sabidurÃ­a'" },
                            { name: "MeditaciÃ³n de integraciÃ³n (20min): Todo el aÃ±o en ti" },
                            { name: "EncarnaciÃ³n (10min): Sentir los cambios" },
                            { name: "Registro (5min): QuiÃ©n eres ahora" },
                            { name: "Cierre (2min): Celebrar tu evoluciÃ³n" }
                        ],
                        3: [
                            { name: "Apertura (3min): 'Soy autÃ³noma'" },
                            { name: "PrÃ¡ctica sin ritual (20min): Conectar sin altar" },
                            { name: "Libertad (10min): Sentir que llevas todo dentro" },
                            { name: "Registro (5min): Nueva forma de conexiÃ³n" },
                            { name: "Cierre (2min): Confiar en tu conexiÃ³n interna" }
                        ],
                        4: [
                            { name: "Apertura (3min): 'Pienso en mi legado'" },
                            { name: "ReflexiÃ³n profunda (20min): QuÃ© dejarÃ¡s" },
                            { name: "Compromiso (10min): CÃ³mo serÃ¡s ancestro" },
                            { name: "Registro (5min): Tu promesa al futuro" },
                            { name: "Cierre (2min): Convertirte en puente" }
                        ],
                        5: [
                            { name: "Apertura (3min): 'Cierro con amor'" },
                            { name: "PreparaciÃ³n de cierre (20min): Planear ceremonia final" },
                            { name: "Gratitud total (10min): A todo y todos" },
                            { name: "Registro (5min): Ãšltima entrada del aÃ±o" },
                            { name: "Cierre (2min): Prepararte para la ceremonia" }
                        ],
                        6: [{ name: "Ceremonia de cierre (3h): Ritual final del aÃ±o completo" }],
                        0: [
                            { name: "Descanso sagrado (todo el dÃ­a): IntegraciÃ³n silenciosa" },
                            { name: "Nuevo comienzo: Planear prÃ³ximo aÃ±o" }
                        ]
                    },
                    dayObjectives: {
                        1: "Revisar con amor",
                        2: "Integrar con gratitud",
                        3: "Ser autÃ³noma",
                        4: "Pensar en tu legado",
                        5: "Cerrar con ceremonia"
                    }
                };

                // Agregar al nivel Espiritual
                spiritualLevel.goals.push(ancestrosGoal);

                // Guardar
                Store.save();

                console.log('\nâœ… Â¡Rutina Ancestros y GuÃ­as agregada exitosamente!');
                console.log('ðŸ“Š Resumen:');
                console.log('   - Meta: Ancestros y GuÃ­as');
                console.log('   - Fases: 12 meses (Ene 2026 - Dic 2026)');
                console.log('   - Actividades: Profundas y especÃ­ficas por mes');
                console.log('   - ProgresiÃ³n: De enraizamiento a autonomÃ­a espiritual');
                console.log('   - Rituales mensuales: Incluidos con negritas en notas');
                console.log('\nâœ… Rutina agregada exitosamente!');


                rutinasAgregadas = true;
            }

            // Agregar ReducciÃ³n Grasa Visceral si no existe
            if (physicalLevel && !physicalLevel.goals.find(g => g.id === 'goal_grasa_visceral')) {
                console.log('âž• Agregando ReducciÃ³n Grasa Visceral...');
                // Script para agregar la rutina "ReducciÃ³n Grasa Visceral" al nivel FÃ­sico
                // Ejecutar en la consola del navegador mientras index.html estÃ¡ abierto
                // PLAN DE 12 MESES CON FASES ESPECÃFICAS


                console.log('ðŸ’ª Agregando rutina ReducciÃ³n Grasa Visceral...\n');

                const data = Store.data;

                if (!data.levels || data.levels.length === 0) {
                    console.error('âŒ No hay niveles. Abre la app primero.');
                    return;
                }

                // Buscar nivel FÃ­sico
                const physicalLevel = data.levels.find(l => l.name.toLowerCase().includes('fÃ­sico') || l.name.toLowerCase().includes('fisico'));

                if (!physicalLevel) {
                    console.error('âŒ Nivel FÃ­sico no encontrado.');
                    console.log('ðŸ’¡ Crea un nivel llamado "FÃ­sico" primero en la app.');
                    return;
                }

                console.log(`âœ… Nivel FÃ­sico encontrado: "${physicalLevel.name}"`);

                // Eliminar rutina si ya existe
                if (physicalLevel.goals) {
                    const existing = physicalLevel.goals.find(g => g.id === 'goal_grasa_visceral_2026');
                    if (existing) {
                        console.log('âš ï¸ Rutina ya existe. Actualizando...');
                        physicalLevel.goals = physicalLevel.goals.filter(g => g.id !== 'goal_grasa_visceral_2026');
                    }
                } else {
                    physicalLevel.goals = [];
                }

                // Crear meta
                const grasaGoal = {
                    id: "goal_grasa_visceral_2026",
                    name: "â†“ Grasa Visceral",
                    color: physicalLevel.color || "red",
                    phaseType: "monthly",
                    phases: {}
                };

                // Objetivos diarios para entrenamiento
                const trainingObjectives = {
                    1: "Ejecutar con tÃ©cnica perfecta",
                    2: "Progresar en carga/reps",
                    3: "Mantener zona 2 en cardio",
                    4: "RecuperaciÃ³n activa consciente",
                    5: "Integrar respiraciÃ³n diafragmÃ¡tica"
                };

                // ==================== FASE 1: MESES 1-3 (FUNDACIÃ“N) ====================
                // Objetivo: Establecer hÃ¡bito + bajar a 30-32% grasa

                // MES 1: ADAPTACIÃ“N Y TÃ‰CNICA
                grasaGoal.phases["2026-02"] = {
                    objective: "Fase 1 - Mes 1: AdaptaciÃ³n y TÃ©cnica Perfecta",
                    notes: `ðŸ’ª **FASE 1: FUNDACIÃ“N (Meses 1-3)**

ðŸŽ¯ **OBJETIVO DE LA FASE**
â€¢ Grasa actual: ~37% â†’ Meta: 30-32%
â€¢ Grasa visceral: 12 â†’ Meta: 9-10
â€¢ PÃ©rdida estimada: 4-5 kg de grasa
â€¢ âš ï¸ SIN sacrificar mÃºsculo

ðŸ“Š **MES 1: ADAPTACIÃ“N**
Enfoque: TÃ©cnica perfecta + crear hÃ¡bito
Carga: 60-70% de tu mÃ¡ximo
Descansos: 60-90 segundos

ðŸ”¥ **ESTRUCTURA SEMANAL**
â€¢ Lunes: Fuerza A (Pierna + Core)
â€¢ Martes: Fuerza B (Torso)
â€¢ MiÃ©rcoles: Bici Zona 2 (30-40min)
â€¢ Jueves: Fuerza C (Pierna Posterior)
â€¢ Viernes: Bici Intervalos (25min)
â€¢ SÃ¡bado: Fuerza D (Torso + MetabÃ³lico)
â€¢ Domingo: Bici Consciente (20-30min)

âš ï¸ **RECUPERACIÃ“N OBLIGATORIA**
â€¢ 10-15min diarios: MeditaciÃ³n + RespiraciÃ³n 4-6
â€¢ Esto NO es opcional con grasa visceral alta

ðŸ“ **MEDICIONES**
â€¢ Peso: Semanal (mismo dÃ­a/hora)
â€¢ Fotos: Cada 2 semanas
â€¢ Medidas: Cintura cada semana`,
                    routine: {
                        1: [ // Lunes - FUERZA A
                            { name: "Calentamiento (5min): Movilidad articular" },
                            { name: "Sentadilla goblet: 4Ã—10 (tÃ©cnica perfecta)" },
                            { name: "Peso muerto rumano: 3Ã—10 (activar glÃºteos)" },
                            { name: "Zancadas caminando: 3Ã—12 c/pierna" },
                            { name: "Puente de glÃºteo: 3Ã—12 (contracciÃ³n pico)" },
                            { name: "Plancha frontal: 3Ã—30-40s (core activado)" },
                            { name: "RespiraciÃ³n diafragmÃ¡tica: 5min (obligatorio)" }
                        ],
                        2: [ // Martes - FUERZA B
                            { name: "Calentamiento (5min): Rotaciones de hombro" },
                            { name: "Remo con mancuerna: 4Ã—10 (espalda fuerte)" },
                            { name: "Press pecho suelo: 3Ã—10 (rango completo)" },
                            { name: "Press hombro mancuerna: 3Ã—10" },
                            { name: "Face pull o pÃ¡jaros: 3Ã—12 (postura)" },
                            { name: "Dead bug: 3Ã—10 (anti-extensiÃ³n)" },
                            { name: "MeditaciÃ³n: 10min (sistema nervioso)" }
                        ],
                        3: [ // MiÃ©rcoles - BICI ZONA 2
                            { name: "Calentamiento (5min): Pedaleo suave" },
                            { name: "Zona 2 (30min): Ritmo conversacional" },
                            { name: "Enfriamiento (5min): Reducir intensidad" },
                            { name: "Objetivo: Quemar grasa visceral" },
                            { name: "RespiraciÃ³n nasal durante todo el ejercicio" },
                            { name: "EscÃ¡ner corporal: 10min post-cardio" }
                        ],
                        4: [ // Jueves - FUERZA C
                            { name: "Calentamiento (5min): ActivaciÃ³n glÃºteo" },
                            { name: "Peso muerto sumo: 4Ã—8 (cadena posterior)" },
                            { name: "Step-ups: 3Ã—10 c/pierna (control)" },
                            { name: "Curl femoral fitball: 3Ã—12 (isquios)" },
                            { name: "Abducciones c/banda: 3Ã—15 (glÃºteo medio)" },
                            { name: "Side plank: 3Ã—30s c/lado" },
                            { name: "RespiraciÃ³n 4-6: 10min (vagal)" }
                        ],
                        5: [ // Viernes - BICI INTERVALOS
                            { name: "Calentamiento (5min): Preparar sistema" },
                            { name: "Intervalos: 8Ã—(30s rÃ¡pido / 90s lento)" },
                            { name: "Enfriamiento (5min): RecuperaciÃ³n activa" },
                            { name: "Total: ~25min" },
                            { name: "HidrataciÃ³n constante" },
                            { name: "MeditaciÃ³n guiada: 15min (recuperaciÃ³n)" }
                        ],
                        6: [ // SÃ¡bado - FUERZA D
                            { name: "Calentamiento (5min): Movilidad completa" },
                            { name: "Remo inclinado: 4Ã—8 (dominante tirÃ³n)" },
                            { name: "Push ups: 3Ã—AMRAP (rodillas si necesario)" },
                            { name: "Curl bÃ­ceps: 3Ã—12" },
                            { name: "ExtensiÃ³n trÃ­ceps: 3Ã—12" },
                            { name: "Finisher - Farmer carry: 4Ã—30s" },
                            { name: "RespiraciÃ³n diafragmÃ¡tica: 10min" }
                        ],
                        0: [ // Domingo - BICI CONSCIENTE
                            { name: "Cardio consciente (20-30min): Ritmo suave" },
                            { name: "RespiraciÃ³n nasal completa" },
                            { name: "MÃºsica 432 Hz (opcional)" },
                            { name: "Enfoque: ConexiÃ³n mente-cuerpo" },
                            { name: "MeditaciÃ³n: 15min post-ejercicio" },
                            { name: "RevisiÃ³n semanal: Progreso y sensaciones" }
                        ]
                    },
                    dayObjectives: trainingObjectives
                };

                // MES 2: INCREMENTO PROGRESIVO
                grasaGoal.phases["2026-03"] = {
                    objective: "Fase 1 - Mes 2: Incremento de Intensidad",
                    notes: `ðŸ’ª **MES 2: INCREMENTO PROGRESIVO**

ðŸ“Š **CAMBIOS ESTE MES**
â€¢ Carga: 70-75% de tu mÃ¡ximo
â€¢ Descansos: 45-60 segundos
â€¢ AÃ±adir 1-2 reps o 2-5% mÃ¡s peso
â€¢ Intervalos mÃ¡s intensos

ðŸŽ¯ **ENFOQUE**
â€¢ Mantener tÃ©cnica perfecta
â€¢ Aumentar volumen gradualmente
â€¢ Monitorear recuperaciÃ³n
â€¢ Ajustar nutriciÃ³n segÃºn progreso

âš ï¸ **SEÃ‘ALES DE ALERTA**
â€¢ Fatiga extrema constante
â€¢ Dolor articular (no muscular)
â€¢ Insomnio persistente
â€¢ Antojos descontrolados
â†’ Reducir volumen 20% y descansar

ðŸ“ **MEDICIONES**
â€¢ Peso: Semanal
â€¢ Cintura: Semanal (debe â†“)
â€¢ Fotos: Cada 2 semanas
â€¢ EnergÃ­a: Diaria (escala 1-10)`,
                    routine: {
                        1: [ // Lunes - FUERZA A (ProgresiÃ³n)
                            { name: "Calentamiento (5min) + Movilidad" },
                            { name: "Sentadilla goblet: 4Ã—12 (â†‘ reps o peso)" },
                            { name: "Peso muerto rumano: 4Ã—10 (â†‘ serie)" },
                            { name: "Zancadas caminando: 3Ã—15 c/pierna (â†‘ reps)" },
                            { name: "Puente glÃºteo 1.5: 3Ã—12 (variante mÃ¡s difÃ­cil)" },
                            { name: "Plancha frontal: 3Ã—45-50s (â†‘ tiempo)" },
                            { name: "RespiraciÃ³n diafragmÃ¡tica: 5min" }
                        ],
                        2: [ // Martes - FUERZA B (ProgresiÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Remo con mancuerna: 4Ã—12 (â†‘ reps)" },
                            { name: "Press pecho suelo: 4Ã—10 (â†‘ serie)" },
                            { name: "Press hombro mancuerna: 3Ã—12 (â†‘ reps)" },
                            { name: "Face pull: 3Ã—15 (â†‘ reps)" },
                            { name: "Dead bug: 3Ã—12 (â†‘ reps)" },
                            { name: "MeditaciÃ³n: 10min" }
                        ],
                        3: [ // MiÃ©rcoles - BICI ZONA 2 (MÃ¡s tiempo)
                            { name: "Calentamiento (5min)" },
                            { name: "Zona 2 (35-40min): Aumentar duraciÃ³n" },
                            { name: "Enfriamiento (5min)" },
                            { name: "Monitorear frecuencia cardÃ­aca" },
                            { name: "RespiraciÃ³n nasal" },
                            { name: "EscÃ¡ner corporal: 10min" }
                        ],
                        4: [ // Jueves - FUERZA C (ProgresiÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Peso muerto sumo: 4Ã—10 (â†‘ reps)" },
                            { name: "Step-ups: 3Ã—12 c/pierna (â†‘ reps)" },
                            { name: "Curl femoral fitball: 4Ã—12 (â†‘ serie)" },
                            { name: "Abducciones c/banda: 3Ã—20 (â†‘ reps)" },
                            { name: "Side plank: 3Ã—40s c/lado (â†‘ tiempo)" },
                            { name: "RespiraciÃ³n 4-6: 10min" }
                        ],
                        5: [ // Viernes - BICI INTERVALOS (MÃ¡s intensos)
                            { name: "Calentamiento (5min)" },
                            { name: "Intervalos: 10Ã—(30s rÃ¡pido / 90s lento)" },
                            { name: "Enfriamiento (5min)" },
                            { name: "Total: ~28min" },
                            { name: "HidrataciÃ³n + electrolitos" },
                            { name: "MeditaciÃ³n guiada: 15min" }
                        ],
                        6: [ // SÃ¡bado - FUERZA D (ProgresiÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Remo inclinado: 4Ã—10 (â†‘ reps)" },
                            { name: "Push ups: 3Ã—AMRAP (intentar completas)" },
                            { name: "Curl bÃ­ceps: 3Ã—15 (â†‘ reps)" },
                            { name: "ExtensiÃ³n trÃ­ceps: 3Ã—15 (â†‘ reps)" },
                            { name: "Finisher - Farmer carry: 5Ã—30s (â†‘ serie)" },
                            { name: "RespiraciÃ³n diafragmÃ¡tica: 10min" }
                        ],
                        0: [ // Domingo - BICI CONSCIENTE
                            { name: "Cardio consciente (25-30min)" },
                            { name: "RespiraciÃ³n nasal" },
                            { name: "MÃºsica 432 Hz" },
                            { name: "ConexiÃ³n mente-cuerpo" },
                            { name: "MeditaciÃ³n: 15min" },
                            { name: "RevisiÃ³n semanal + ajustes" }
                        ]
                    },
                    dayObjectives: trainingObjectives
                };

                // MES 3: CONSOLIDACIÃ“N FASE 1
                grasaGoal.phases["2026-04"] = {
                    objective: "Fase 1 - Mes 3: ConsolidaciÃ³n y EvaluaciÃ³n",
                    notes: `ðŸ’ª **MES 3: CONSOLIDACIÃ“N FASE 1**

ðŸŽ¯ **OBJETIVO**
â€¢ Consolidar hÃ¡bitos
â€¢ Alcanzar 30-32% grasa corporal
â€¢ Grasa visceral: 9-10
â€¢ Preparar para Fase 2

ðŸ“Š **ESTE MES**
â€¢ Mantener intensidad del mes 2
â€¢ Perfeccionar tÃ©cnica
â€¢ Optimizar recuperaciÃ³n
â€¢ Evaluar progreso total

ðŸ” **EVALUACIÃ“N FINAL FASE 1**
Semana 12:
â€¢ MediciÃ³n completa de composiciÃ³n corporal
â€¢ Fotos comparativas (inicio vs ahora)
â€¢ Medidas: cintura, cadera, muslos
â€¢ EvaluaciÃ³n de fuerza (cargas mÃ¡ximas)
â€¢ Nivel de energÃ­a y bienestar

âœ… **INDICADORES DE Ã‰XITO**
â€¢ Grasa corporal: 30-32%
â€¢ Grasa visceral: â‰¤10
â€¢ Cintura: -5 a -8 cm
â€¢ Fuerza: â†‘ en todos los ejercicios
â€¢ EnergÃ­a: Estable y alta
â€¢ SueÃ±o: Mejorado
â€¢ Antojos: Controlados

ðŸ“‹ **PREPARACIÃ“N FASE 2**
Si alcanzaste objetivos:
â†’ Pasar a Fase 2 (meses 4-12)

Si no alcanzaste objetivos:
â†’ Repetir Fase 1 con ajustes nutricionales`,
                    routine: {
                        1: [ // Lunes - FUERZA A (ConsolidaciÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Sentadilla goblet: 4Ã—12 (peso consolidado)" },
                            { name: "Peso muerto rumano: 4Ã—10" },
                            { name: "Zancadas caminando: 3Ã—15 c/pierna" },
                            { name: "Puente glÃºteo 1.5: 3Ã—15" },
                            { name: "Plancha frontal: 3Ã—50-60s" },
                            { name: "RespiraciÃ³n diafragmÃ¡tica: 5min" }
                        ],
                        2: [ // Martes - FUERZA B (ConsolidaciÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Remo con mancuerna: 4Ã—12" },
                            { name: "Press pecho suelo: 4Ã—10" },
                            { name: "Press hombro mancuerna: 3Ã—12" },
                            { name: "Face pull: 3Ã—15" },
                            { name: "Dead bug: 3Ã—15" },
                            { name: "MeditaciÃ³n: 10min" }
                        ],
                        3: [ // MiÃ©rcoles - BICI ZONA 2
                            { name: "Calentamiento (5min)" },
                            { name: "Zona 2 (40min): DuraciÃ³n mÃ¡xima Fase 1" },
                            { name: "Enfriamiento (5min)" },
                            { name: "Mantener zona objetivo" },
                            { name: "RespiraciÃ³n nasal" },
                            { name: "EscÃ¡ner corporal: 10min" }
                        ],
                        4: [ // Jueves - FUERZA C (ConsolidaciÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Peso muerto sumo: 4Ã—10" },
                            { name: "Step-ups: 3Ã—12 c/pierna" },
                            { name: "Curl femoral fitball: 4Ã—12" },
                            { name: "Abducciones c/banda: 3Ã—20" },
                            { name: "Side plank: 3Ã—45s c/lado" },
                            { name: "RespiraciÃ³n 4-6: 10min" }
                        ],
                        5: [ // Viernes - BICI INTERVALOS
                            { name: "Calentamiento (5min)" },
                            { name: "Intervalos: 10Ã—(30s rÃ¡pido / 90s lento)" },
                            { name: "Enfriamiento (5min)" },
                            { name: "Mantener intensidad" },
                            { name: "HidrataciÃ³n Ã³ptima" },
                            { name: "MeditaciÃ³n guiada: 15min" }
                        ],
                        6: [ // SÃ¡bado - FUERZA D (ConsolidaciÃ³n)
                            { name: "Calentamiento (5min)" },
                            { name: "Remo inclinado: 4Ã—10" },
                            { name: "Push ups: 3Ã—AMRAP (mÃ¡ximo esfuerzo)" },
                            { name: "Curl bÃ­ceps: 3Ã—15" },
                            { name: "ExtensiÃ³n trÃ­ceps: 3Ã—15" },
                            { name: "Finisher - Farmer carry: 5Ã—30s" },
                            { name: "RespiraciÃ³n diafragmÃ¡tica: 10min" }
                        ],
                        0: [ // Domingo - BICI CONSCIENTE + EVALUACIÃ“N
                            { name: "Cardio consciente (30min)" },
                            { name: "RespiraciÃ³n nasal" },
                            { name: "MÃºsica 432 Hz" },
                            { name: "MeditaciÃ³n: 15min" },
                            { name: "RevisiÃ³n mensual completa" },
                            { name: "Preparar evaluaciÃ³n Fase 1" }
                        ]
                    },
                    dayObjectives: trainingObjectives
                };

                // ==================== FASE 2: MESES 4-12 (OPTIMIZACIÃ“N) ====================
                // Objetivo: 26-28% grasa corporal

                // MESES 4-12: Estructura similar pero con progresiÃ³n continua
                // Por brevedad, creo estructura base para Fase 2

                const fase2Months = [
                    { key: "2026-05", name: "Mes 4", focus: "Inicio Fase 2 - Nueva intensidad" },
                    { key: "2026-06", name: "Mes 5", focus: "Aumento volumen" },
                    { key: "2026-07", name: "Mes 6", focus: "Pico de intensidad" },
                    { key: "2026-08", name: "Mes 7", focus: "Deload + RecuperaciÃ³n" },
                    { key: "2026-09", name: "Mes 8", focus: "Nuevo ciclo - Fuerza" },
                    { key: "2026-10", name: "Mes 9", focus: "Hipertrofia metabÃ³lica" },
                    { key: "2026-11", name: "Mes 10", focus: "Refinamiento" },
                    { key: "2026-12", name: "Mes 11", focus: "ConsolidaciÃ³n" },
                    { key: "2027-01", name: "Mes 12", focus: "EvaluaciÃ³n final + Mantenimiento" }
                ];

                fase2Months.forEach((month, index) => {
                    grasaGoal.phases[month.key] = {
                        objective: `Fase 2 - ${month.name}: ${month.focus}`,
                        notes: `ðŸ’ª **FASE 2: OPTIMIZACIÃ“N (Meses 4-12)**

ðŸŽ¯ **OBJETIVO FASE 2**
â€¢ Grasa actual: 30-32% â†’ Meta final: 26-28%
â€¢ Grasa visceral: 9-10 â†’ Meta: 7-8
â€¢ Enfoque: RecomposiciÃ³n corporal
â€¢ Mantener/aumentar masa muscular

ðŸ“Š **${month.name.toUpperCase()}: ${month.focus.toUpperCase()}**

${index < 3 ? `
ðŸ”¥ **INTENSIDAD AUMENTADA**
â€¢ Carga: 75-80% de tu mÃ¡ximo
â€¢ Descansos: 45 segundos
â€¢ Volumen: 4-5 series por ejercicio
â€¢ Cardio: 40-45min Zona 2
` : index < 6 ? `
ðŸ”¥ **CICLO DE FUERZA**
â€¢ Carga: 80-85% de tu mÃ¡ximo
â€¢ Reps: 6-8 (fuerza)
â€¢ Descansos: 90 segundos
â€¢ Enfoque: Construir mÃºsculo
` : `
ðŸ”¥ **REFINAMIENTO FINAL**
â€¢ Carga: 75-80% de tu mÃ¡ximo
â€¢ Reps: 10-12 (definiciÃ³n)
â€¢ Descansos: 30-45 segundos
â€¢ Cardio: Mantener Zona 2
`}

âš ï¸ **RECUPERACIÃ“N CRÃTICA**
â€¢ MeditaciÃ³n: 15min diarios
â€¢ SueÃ±o: 7-8 horas
â€¢ HidrataciÃ³n: 2-3L agua
â€¢ Manejo estrÃ©s: Obligatorio

ðŸ“ **MEDICIONES MENSUALES**
â€¢ ComposiciÃ³n corporal completa
â€¢ Fotos progreso
â€¢ Medidas corporales
â€¢ Test de fuerza`,
                        routine: {
                            1: [
                                { name: "Calentamiento (5-7min): Movilidad completa" },
                                { name: "Sentadilla: 4-5Ã—8-12 (segÃºn fase)" },
                                { name: "Peso muerto rumano: 4Ã—8-10" },
                                { name: "Zancadas: 3Ã—12-15 c/pierna" },
                                { name: "Puente glÃºteo: 3Ã—12-15" },
                                { name: "Core: Plancha + variantes 3Ã—45-60s" },
                                { name: "RespiraciÃ³n: 5-10min" }
                            ],
                            2: [
                                { name: "Calentamiento (5-7min)" },
                                { name: "Remo: 4-5Ã—8-12" },
                                { name: "Press pecho: 4Ã—8-10" },
                                { name: "Press hombro: 3Ã—10-12" },
                                { name: "TirÃ³n posterior: 3Ã—12-15" },
                                { name: "Core anti-rotaciÃ³n: 3Ã—10-12" },
                                { name: "MeditaciÃ³n: 15min" }
                            ],
                            3: [
                                { name: "Calentamiento (5min)" },
                                { name: "Zona 2 (40-45min): Grasa visceral" },
                                { name: "Enfriamiento (5min)" },
                                { name: "RespiraciÃ³n nasal completa" },
                                { name: "HidrataciÃ³n constante" },
                                { name: "EscÃ¡ner corporal: 10-15min" }
                            ],
                            4: [
                                { name: "Calentamiento (5-7min)" },
                                { name: "Peso muerto sumo: 4-5Ã—6-10" },
                                { name: "Step-ups: 3Ã—10-12 c/pierna" },
                                { name: "Curl femoral: 4Ã—10-12" },
                                { name: "Abducciones: 3Ã—15-20" },
                                { name: "Side plank: 3Ã—45-60s" },
                                { name: "RespiraciÃ³n 4-6: 10-15min" }
                            ],
                            5: [
                                { name: "Calentamiento (5min)" },
                                { name: "Intervalos: 10-12Ã—(30s / 90s)" },
                                { name: "Enfriamiento (5min)" },
                                { name: "ProgresiÃ³n gradual" },
                                { name: "RecuperaciÃ³n activa" },
                                { name: "MeditaciÃ³n: 15min" }
                            ],
                            6: [
                                { name: "Calentamiento (5-7min)" },
                                { name: "Remo inclinado: 4-5Ã—8-10" },
                                { name: "Push ups: 3-4Ã—AMRAP" },
                                { name: "Curl bÃ­ceps: 3Ã—12-15" },
                                { name: "ExtensiÃ³n trÃ­ceps: 3Ã—12-15" },
                                { name: "Finisher metabÃ³lico: 5-6 rondas" },
                                { name: "RespiraciÃ³n: 10-15min" }
                            ],
                            0: [
                                { name: "Cardio consciente (30-40min)" },
                                { name: "RespiraciÃ³n nasal" },
                                { name: "MÃºsica 432 Hz" },
                                { name: "MeditaciÃ³n profunda: 20min" },
                                { name: "RevisiÃ³n semanal completa" },
                                { name: "PlanificaciÃ³n prÃ³xima semana" }
                            ]
                        },
                        dayObjectives: trainingObjectives
                    };
                });

                // Agregar al nivel FÃ­sico
                physicalLevel.goals.push(grasaGoal);

                // Guardar
                Store.save();

                console.log('\nâœ… Â¡Rutina ReducciÃ³n Grasa Visceral agregada exitosamente!');
                console.log('ðŸ“Š Resumen:');
                console.log('   - Meta: â†“ Grasa Visceral');
                console.log('   - Fases: 12 meses (Feb 2026 - Ene 2027)');
                console.log('   - Fase 1 (3 meses): 37% â†’ 30-32% grasa');
                console.log('   - Fase 2 (9 meses): 30-32% â†’ 26-28% grasa');
                console.log('   - Estructura: 4 dÃ­as fuerza + 3 dÃ­as bici');
                console.log('   - RecuperaciÃ³n: MeditaciÃ³n diaria obligatoria');
                console.log('\nâœ… Rutina agregada exitosamente!');


                rutinasAgregadas = true;
            }

            // Agregar English Practice si no existe
            if (mentalLevel && !mentalLevel.goals.find(g => g.id === 'goal_english_2026')) {
                console.log('âž• Agregando English Practice...');
                // INSTRUCCIONES: Copia TODO este cÃ³digo y pÃ©galo en la consola del navegador
                // mientras tienes abierto index.html


                console.log('ðŸš€ Iniciando agregado de rutina de inglÃ©s...\n');

                // Obtener datos actuales
                const data = Store.data;

                if (!data.levels || data.levels.length === 0) {
                    console.error('âŒ No hay niveles. Abre la app primero.');
                    return;
                }

                console.log(`âœ… Encontrados ${data.levels.length} niveles`);
                console.log('ðŸ“‹ Niveles disponibles:');
                data.levels.forEach(l => {
                    console.log(`   - "${l.name}" (${l.goals?.length || 0} metas)`);
                });

                // Buscar nivel Mental (case-insensitive)
                const mentalLevel = data.levels.find(l => l.name.toLowerCase().includes('mental'));

                if (!mentalLevel) {
                    console.error('âŒ Nivel Mental no encontrado.');
                    console.log('ðŸ’¡ Crea un nivel llamado "Mental" primero en la app.');
                    return;
                }

                console.log(`âœ… Nivel Mental encontrado: "${mentalLevel.name}"`);

                // Eliminar rutina de inglÃ©s si ya existe
                if (mentalLevel.goals) {
                    const existing = mentalLevel.goals.find(g => g.id === 'goal_english_2026');
                    if (existing) {
                        console.log('âš ï¸ Rutina de inglÃ©s ya existe. Actualizando...');
                        mentalLevel.goals = mentalLevel.goals.filter(g => g.id !== 'goal_english_2026');
                    }
                } else {
                    mentalLevel.goals = [];
                }

                // Crear meta de inglÃ©s
                const englishGoal = {
                    id: "goal_english_2026",
                    name: "InglÃ©s A1â†’B2",
                    color: mentalLevel.color || "blue",
                    phaseType: "monthly",
                    phases: {}
                };

                // Funciones helper
                const weekday = (grammar) => [
                    { name: "Warm-up (5min): Pregunta simple oral" },
                    { name: `GramÃ¡tica (15min): ${grammar}` },
                    { name: "Listening (10min): Video/audio sin subtÃ­tulos" },
                    { name: "Speaking (10min): Responder + mini monÃ³logo" },
                    { name: "Writing (5min): 3-5 frases del tema" }
                ];

                const weekend = () => [
                    { name: "Descanso activo: Serie/pelÃ­cula en inglÃ©s" },
                    { name: "MÃºsica con letra" },
                    { name: "Videos de YouTube" }
                ];

                const objectives = {
                    1: "Hablar en voz alta siempre",
                    2: "Pensar en inglÃ©s cosas simples",
                    3: "No traducir palabra por palabra",
                    4: "Aceptar errores sin castigarte",
                    5: "EnfÃ³cate en comunicar, no en perfecciÃ³n"
                };

                // Definir meses
                const months = [
                    { key: "2026-02", obj: "Consolidar A1 - Base sÃ³lida", notes: "ðŸ“š GRAMÃTICA: Presente simple, Verb to be, There is/are\n\nðŸ—£ï¸ VOCABULARIO: Rutina diaria, Familia, Comida, Lugares\n\nðŸŽ¯ HABILIDADES: Entender frases lentas, Responder preguntas cortas\n\nâœ”ï¸ META: Sentirte segura, sin traducir todo", gram: "Presente simple / Verb to be" },
                    { key: "2026-03", obj: "Consolidar A1 (cont.)", notes: "ðŸ“š GRAMÃTICA: There is/are, Preguntas y negaciones, Preposiciones\n\nðŸ—£ï¸ VOCABULARIO: Rutina diaria, Familia, Comida, Lugares\n\nðŸŽ¯ HABILIDADES: Entender frases lentas, Responder preguntas cortas\n\nâœ”ï¸ RESULTADO: A1 fuerte, listo para subir", gram: "There is/are / Preguntas" },
                    { key: "2026-04", obj: "A2 inicial - Pasado y futuro", notes: "ðŸ“š GRAMÃTICA: Pasado simple, Futuro con going to, Comparativos\n\nðŸ—£ï¸ VOCABULARIO: Viajes, Trabajo, Salud, Tiempo libre\n\nðŸŽ¯ HABILIDADES: Contar experiencias pasadas, Mini conversaciones\n\nâœ”ï¸ META: Comunicar ideas del pasado y futuro", gram: "Pasado simple" },
                    { key: "2026-05", obj: "A2 inicial (cont.)", notes: "ðŸ“š GRAMÃTICA: Going to, Comparativos, Countable/uncountable\n\nðŸ—£ï¸ VOCABULARIO: Viajes, Trabajo, Salud, Tiempo libre\n\nðŸŽ¯ HABILIDADES: Experiencias pasadas, Conversaciones 2-3 min\n\nâœ”ï¸ RESULTADO: A2 funcional", gram: "Going to / Comparativos" },
                    { key: "2026-06", obj: "A2 alto - Hablar sin bloquearte", notes: "ðŸ“š GRAMÃTICA: Presente continuo vs simple, Pasado continuo, Modales\n\nðŸ—£ï¸ VOCABULARIO: Opiniones, Problemas cotidianos, Relaciones\n\nðŸŽ¯ HABILIDADES: Expresar opiniones, Describir situaciones\n\nâœ”ï¸ META: Hablar sin bloquearte", gram: "Presente continuo vs simple" },
                    { key: "2026-07", obj: "A2 alto (cont.)", notes: "ðŸ“š GRAMÃTICA: Pasado continuo, Modales, Conectores (because, but, so)\n\nðŸ—£ï¸ VOCABULARIO: Opiniones, Problemas, Relaciones, EducaciÃ³n\n\nðŸŽ¯ HABILIDADES: Expresar opiniones, Conectar ideas\n\nâœ”ï¸ RESULTADO: TransiciÃ³n clara hacia B1", gram: "Modales / Conectores" },
                    { key: "2026-08", obj: "B1 - Fluidez bÃ¡sica y confianza", notes: "ðŸ“š GRAMÃTICA: Presente perfecto, Condicional 0 y 1, Voz pasiva\n\nðŸ—£ï¸ VOCABULARIO: Experiencias, Situaciones hipotÃ©ticas, Noticias\n\nðŸŽ¯ HABILIDADES: Expresar opiniones, Explicar razones, Videos normales\n\nâœ”ï¸ META: Fluidez bÃ¡sica y confianza", gram: "Presente perfecto" },
                    { key: "2026-09", obj: "B1 (cont.)", notes: "ðŸ“š GRAMÃTICA: Condicionales 0 y 1, Voz pasiva, Phrasal verbs\n\nðŸ—£ï¸ VOCABULARIO: Experiencias, HipotÃ©ticos, Noticias\n\nðŸŽ¯ HABILIDADES: Opiniones, Explicar razones, Videos normales\n\nâœ”ï¸ RESULTADO: B1 sÃ³lido", gram: "Condicionales / Voz pasiva" },
                    { key: "2026-10", obj: "B1 alto - Sonar mÃ¡s natural", notes: "ðŸ“š GRAMÃTICA: Segundo condicional, Reported speech, Verb patterns\n\nðŸ—£ï¸ VOCABULARIO: Emociones complejas, ArgumentaciÃ³n, Cultura\n\nðŸŽ¯ HABILIDADES: Debates sencillos, Narraciones largas, Writing\n\nâœ”ï¸ META: Sonar mÃ¡s natural", gram: "Segundo condicional" },
                    { key: "2026-11", obj: "B1 alto (cont.)", notes: "ðŸ“š GRAMÃTICA: Reported speech, Verb patterns, Phrasal verbs avanzados\n\nðŸ—£ï¸ VOCABULARIO: Emociones complejas, ArgumentaciÃ³n, Cultura\n\nðŸŽ¯ HABILIDADES: Debates, Narraciones largas, Writing estructurado\n\nâœ”ï¸ RESULTADO: Listo para B2", gram: "Reported speech / Verb patterns" },
                    { key: "2026-12", obj: "B2 - Independencia real (parte 1)", notes: "ðŸ“š ENFOQUE: Fluidez, Naturalidad, PrecisiÃ³n\n\nðŸ—£ï¸ VOCABULARIO: Matices, Expresiones idiomÃ¡ticas, Temas abstractos\n\nðŸŽ¯ HABILIDADES: Argumentar, Distintos acentos, Expresar emociones\n\nâœ”ï¸ META: Independencia real en inglÃ©s", gram: "Refinamiento y prÃ¡ctica" },
                    { key: "2027-01", obj: "B2 - Independencia real (parte 2)", notes: "ðŸ“š ENFOQUE: Fluidez, Naturalidad, PrecisiÃ³n\n\nðŸ—£ï¸ VOCABULARIO: Matices, Expresiones idiomÃ¡ticas, Temas abstractos\n\nðŸŽ¯ HABILIDADES: Argumentar, Distintos acentos, Expresar emociones\n\nâœ”ï¸ RESULTADO: Nivel B2 funcional ðŸŽ‰", gram: "ConsolidaciÃ³n B2" }
                ];

                // Crear fases
                months.forEach(m => {
                    const wd = weekday(m.gram);
                    const we = weekend();

                    englishGoal.phases[m.key] = {
                        objective: m.obj,
                        notes: m.notes,
                        routine: {
                            1: wd, 2: wd, 3: wd, 4: wd, 5: wd,
                            6: we, 0: we
                        },
                        dayObjectives: objectives
                    };
                });

                // Agregar al nivel Mental
                mentalLevel.goals.push(englishGoal);

                // Guardar
                Store.save();

                console.log('\nâœ… Â¡Rutina de inglÃ©s agregada exitosamente!');
                console.log('ðŸ“Š Resumen:');
                console.log('   - Meta: InglÃ©s A1â†’B2');
                console.log('   - Fases: 12 meses (Feb 2026 - Ene 2027)');
                console.log('   - Actividades: 5 dÃ­as activos + 2 descanso');
                console.log('\nâœ… Rutina agregada exitosamente!');


                rutinasAgregadas = true;
            }

            if (rutinasAgregadas) {
                console.log('âœ… Rutinas agregadas exitosamente');
                Store.save();
            } else {
                console.log('â„¹ï¸ Todas las rutinas ya estÃ¡n cargadas');
            }
        })();
    </script>

</body>

</html>