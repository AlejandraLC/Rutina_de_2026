<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Rutina de Ingl√©s</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #0f172a;
            color: #f8fafc;
        }

        .container {
            background: #1e293b;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #3b82f6;
            margin-top: 0;
        }

        .step {
            background: #334155;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }

        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }

        button:hover {
            background: #2563eb;
        }

        button.success {
            background: #22c55e;
        }

        button.danger {
            background: #ef4444;
        }

        #output {
            background: #0f172a;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }

        .success-msg {
            color: #22c55e;
        }

        .error-msg {
            color: #ef4444;
        }

        .info-msg {
            color: #3b82f6;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üéì Agregar Rutina de Ingl√©s A1‚ÜíB2</h1>

        <div class="step">
            <h3>Paso 1: Verificar Estado Actual</h3>
            <p>Primero verifica si tienes el nivel Mental creado y si ya existe la rutina de ingl√©s.</p>
            <button onclick="checkStatus()">üîç Verificar Estado</button>
        </div>

        <div class="step">
            <h3>Paso 2: Agregar Rutina de Ingl√©s</h3>
            <p>Esto agregar√° la rutina completa de 12 meses al nivel Mental.</p>
            <button onclick="addEnglishRoutine()">‚ûï Agregar Rutina</button>
        </div>

        <div class="step">
            <h3>Paso 3: Abrir la App</h3>
            <p>Una vez agregada la rutina, abre tu app para verla.</p>
            <button class="success" onclick="openApp()">üöÄ Abrir App</button>
        </div>

        <div id="output"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const className = type === 'success' ? 'success-msg' : type === 'error' ? 'error-msg' : 'info-msg';
            output.innerHTML += `<span class="${className}">${message}</span>\n`;
            output.scrollTop = output.scrollHeight;
        }

        function checkStatus() {
            log('üîç Verificando estado actual...', 'info');

            const data = JSON.parse(localStorage.getItem('rutina2026') || '{}');

            if (!data.levels || data.levels.length === 0) {
                log('‚ùå No hay niveles creados. Por favor crea el nivel Mental primero en la app.', 'error');
                return;
            }

            log(`‚úÖ Encontrados ${data.levels.length} niveles`, 'success');

            // Show all levels
            log('üìã Niveles disponibles:', 'info');
            data.levels.forEach(l => {
                log(`   - "${l.name}" (${l.goals?.length || 0} metas)`, 'info');
            });

            // Find Mental level (case-insensitive)
            const mentalLevel = data.levels.find(l => l.name.toLowerCase() === 'mental');
            if (!mentalLevel) {
                log('‚ùå Nivel Mental no encontrado. Por favor cr√©alo primero.', 'error');
                return;
            }

            log(`‚úÖ Nivel Mental encontrado: "${mentalLevel.name}"`, 'success');
            log(`   Metas actuales: ${mentalLevel.goals?.length || 0}`, 'info');

            if (mentalLevel.goals) {
                mentalLevel.goals.forEach(g => {
                    log(`   - ${g.name} (${Object.keys(g.phases || {}).length} fases)`, 'info');
                });
            }

            const englishGoal = mentalLevel.goals?.find(g => g.id === 'goal_english_2026');
            if (englishGoal) {
                log('‚ö†Ô∏è La rutina de ingl√©s ya existe', 'error');
                log(`   Fases: ${Object.keys(englishGoal.phases || {}).length}`, 'info');
            } else {
                log('‚úÖ Listo para agregar la rutina de ingl√©s', 'success');
            }
        }

        function addEnglishRoutine() {
            log('üöÄ Agregando rutina de ingl√©s...', 'info');

            const data = JSON.parse(localStorage.getItem('rutina2026') || '{}');

            if (!data.levels) {
                log('‚ùå No hay datos en localStorage. Abre la app primero.', 'error');
                return;
            }

            // Find Mental level (case-insensitive)
            const mentalLevel = data.levels.find(l => l.name.toLowerCase() === 'mental');
            if (!mentalLevel) {
                log('‚ùå Nivel Mental no encontrado. Cr√©alo primero.', 'error');
                log('   Niveles disponibles: ' + data.levels.map(l => l.name).join(', '), 'info');
                return;
            }

            log(`‚úÖ Nivel Mental encontrado: "${mentalLevel.name}"`, 'success');

            // Remove existing English goal if present
            if (mentalLevel.goals) {
                mentalLevel.goals = mentalLevel.goals.filter(g => g.id !== 'goal_english_2026');
            } else {
                mentalLevel.goals = [];
            }

            // Create English goal
            const englishGoal = {
                id: "goal_english_2026",
                name: "Ingl√©s A1‚ÜíB2",
                color: mentalLevel.color || "blue",
                phaseType: "monthly",
                phases: {}
            };

            // Helper functions
            const createWeekdayActivities = (grammar) => [
                { name: "Warm-up (5min): Pregunta simple oral" },
                { name: `Gram√°tica (15min): ${grammar}` },
                { name: "Listening (10min): Video/audio sin subt√≠tulos" },
                { name: "Speaking (10min): Responder + mini mon√≥logo" },
                { name: "Writing (5min): 3-5 frases del tema" }
            ];

            const createWeekendActivities = () => [
                { name: "Descanso activo: Serie/pel√≠cula en ingl√©s" },
                { name: "M√∫sica con letra" },
                { name: "Videos de YouTube" }
            ];

            const dailyObjectives = {
                1: "Hablar en voz alta siempre",
                2: "Pensar en ingl√©s cosas simples",
                3: "No traducir palabra por palabra",
                4: "Aceptar errores sin castigarte",
                5: "Enf√≥cate en comunicar, no en perfecci√≥n"
            };

            // Month definitions
            const months = [
                { key: "2026-02", objective: "Consolidar A1 - Base s√≥lida", notes: "üìö GRAM√ÅTICA: Presente simple, Verb to be, There is/are, Preguntas y negaciones\\n\\nüó£Ô∏è VOCABULARIO: Rutina diaria, Familia, Comida, Lugares, Emociones\\n\\nüéØ HABILIDADES: Entender frases lentas, Responder preguntas cortas, Presentarte\\n\\n‚úîÔ∏è META: Sentirte segura, sin traducir todo", grammar: "Presente simple / Verb to be" },
                { key: "2026-03", objective: "Consolidar A1 (cont.)", notes: "üìö GRAM√ÅTICA: There is/are, Preguntas y negaciones, Preposiciones b√°sicas\\n\\nüó£Ô∏è VOCABULARIO: Rutina diaria, Familia, Comida, Lugares\\n\\nüéØ HABILIDADES: Entender frases lentas, Responder preguntas cortas\\n\\n‚úîÔ∏è RESULTADO: A1 fuerte, listo para subir", grammar: "There is/are / Preguntas" },
                { key: "2026-04", objective: "A2 inicial - Pasado y futuro", notes: "üìö GRAM√ÅTICA: Pasado simple, Futuro con going to, Comparativos\\n\\nüó£Ô∏è VOCABULARIO: Viajes, Trabajo, Salud, Tiempo libre\\n\\nüéØ HABILIDADES: Contar experiencias pasadas, Mini conversaciones (2-3 min)\\n\\n‚úîÔ∏è META: Comunicar ideas del pasado y futuro", grammar: "Pasado simple" },
                { key: "2026-05", objective: "A2 inicial (cont.)", notes: "üìö GRAM√ÅTICA: Going to, Comparativos y superlativos, Countable/uncountable\\n\\nüó£Ô∏è VOCABULARIO: Viajes, Trabajo, Salud, Tiempo libre\\n\\nüéØ HABILIDADES: Experiencias pasadas, Conversaciones 2-3 min\\n\\n‚úîÔ∏è RESULTADO: A2 funcional", grammar: "Going to / Comparativos" },
                { key: "2026-06", objective: "A2 alto - Hablar sin bloquearte", notes: "üìö GRAM√ÅTICA: Presente continuo vs simple, Pasado continuo, Modales\\n\\nüó£Ô∏è VOCABULARIO: Opiniones, Problemas cotidianos, Relaciones, Educaci√≥n\\n\\nüéØ HABILIDADES: Expresar opiniones, Describir situaciones\\n\\n‚úîÔ∏è META: Hablar sin bloquearte", grammar: "Presente continuo vs simple" },
                { key: "2026-07", objective: "A2 alto (cont.)", notes: "üìö GRAM√ÅTICA: Pasado continuo, Modales, Conectores (because, but, so)\\n\\nüó£Ô∏è VOCABULARIO: Opiniones, Problemas, Relaciones, Educaci√≥n\\n\\nüéØ HABILIDADES: Expresar opiniones, Conectar ideas\\n\\n‚úîÔ∏è RESULTADO: Transici√≥n clara hacia B1", grammar: "Modales / Conectores" },
                { key: "2026-08", objective: "B1 - Fluidez b√°sica y confianza", notes: "üìö GRAM√ÅTICA: Presente perfecto, Condicional 0 y 1, Voz pasiva b√°sica\\n\\nüó£Ô∏è VOCABULARIO: Experiencias, Situaciones hipot√©ticas, Noticias\\n\\nüéØ HABILIDADES: Expresar opiniones, Explicar razones, Videos normales\\n\\n‚úîÔ∏è META: Fluidez b√°sica y confianza", grammar: "Presente perfecto" },
                { key: "2026-09", objective: "B1 (cont.)", notes: "üìö GRAM√ÅTICA: Condicionales 0 y 1, Voz pasiva, Phrasal verbs b√°sicos\\n\\nüó£Ô∏è VOCABULARIO: Experiencias, Hipot√©ticos, Noticias\\n\\nüéØ HABILIDADES: Opiniones, Explicar razones, Videos normales\\n\\n‚úîÔ∏è RESULTADO: B1 s√≥lido", grammar: "Condicionales / Voz pasiva" },
                { key: "2026-10", objective: "B1 alto - Sonar m√°s natural", notes: "üìö GRAM√ÅTICA: Segundo condicional, Reported speech b√°sico, Verb patterns\\n\\nüó£Ô∏è VOCABULARIO: Emociones complejas, Argumentaci√≥n, Cultura\\n\\nüéØ HABILIDADES: Debates sencillos, Narraciones largas, Writing estructurado\\n\\n‚úîÔ∏è META: Sonar m√°s natural", grammar: "Segundo condicional" },
                { key: "2026-11", objective: "B1 alto (cont.)", notes: "üìö GRAM√ÅTICA: Reported speech, Verb patterns, Phrasal verbs avanzados\\n\\nüó£Ô∏è VOCABULARIO: Emociones complejas, Argumentaci√≥n, Cultura\\n\\nüéØ HABILIDADES: Debates, Narraciones largas, Writing estructurado\\n\\n‚úîÔ∏è RESULTADO: Listo para B2", grammar: "Reported speech / Verb patterns" },
                { key: "2026-12", objective: "B2 - Independencia real (parte 1)", notes: "üìö ENFOQUE: Fluidez, Naturalidad, Precisi√≥n\\n\\nüó£Ô∏è VOCABULARIO: Matices, Expresiones idiom√°ticas, Temas abstractos\\n\\nüéØ HABILIDADES: Argumentar, Distintos acentos, Expresar emociones\\n\\n‚úîÔ∏è META: Independencia real en ingl√©s", grammar: "Refinamiento y pr√°ctica" },
                { key: "2027-01", objective: "B2 - Independencia real (parte 2)", notes: "üìö ENFOQUE: Fluidez, Naturalidad, Precisi√≥n\\n\\nüó£Ô∏è VOCABULARIO: Matices, Expresiones idiom√°ticas, Temas abstractos\\n\\nüéØ HABILIDADES: Argumentar, Distintos acentos, Expresar emociones\\n\\n‚úîÔ∏è RESULTADO: Nivel B2 funcional üéâ", grammar: "Consolidaci√≥n B2" }
            ];

            // Build phases
            months.forEach(month => {
                const weekday = createWeekdayActivities(month.grammar);
                const weekend = createWeekendActivities();

                englishGoal.phases[month.key] = {
                    objective: month.objective,
                    notes: month.notes,
                    routine: {
                        1: weekday, 2: weekday, 3: weekday, 4: weekday, 5: weekday,
                        6: weekend, 0: weekend
                    },
                    dayObjectives: dailyObjectives
                };
            });

            // Add to Mental level
            mentalLevel.goals.push(englishGoal);

            // Save back to localStorage
            localStorage.setItem('rutina2026', JSON.stringify(data));

            log('‚úÖ Rutina de ingl√©s agregada exitosamente!', 'success');
            log(`üìä Resumen:`, 'info');
            log(`   - Meta: Ingl√©s A1‚ÜíB2`, 'info');
            log(`   - Fases: 12 meses (Feb 2026 - Ene 2027)`, 'info');
            log(`   - Actividades: 5 d√≠as activos + 2 descanso`, 'info');
            log('', 'info');
            log('üîÑ Haz clic en "Abrir App" para ver los cambios', 'success');
        }

        function openApp() {
            window.location.href = 'index.html';
        }
    </script>
</body>

</html>